<!DOCTYPE html>
<html lang="zh-CN">
    <head>
        <meta charset="utf-8">
        <meta name="viewport" content="width=device-width, initial-scale=1">
        <meta name="robots" content="noodp" />
        <meta http-equiv="X-UA-Compatible" content="IE=edge, chrome=1">
        <title>Linux ç³»ç»Ÿç¼–ç¨‹ - hongwei7 çš„åšå®¢</title><meta name="Description" content="è¿™æ˜¯hongwei7çš„ä¸ªäººç½‘ç«™"><meta property="og:title" content="Linux ç³»ç»Ÿç¼–ç¨‹" />
<meta property="og:description" content="ğŸ®Linuxç³»ç»Ÿçº§ç¼–ç¨‹ç¬”è®°ã€‚" />
<meta property="og:type" content="article" />
<meta property="og:url" content="https://hongwei7.github.io/linuxsystem/" /><meta property="og:image" content="https://hongwei7.github.io/logo.png"/><meta property="article:section" content="posts" />
<meta property="article:published_time" content="2021-02-08T00:00:00&#43;00:00" />
<meta property="article:modified_time" content="2021-02-08T00:00:00&#43;00:00" />

<meta name="twitter:card" content="summary_large_image"/>
<meta name="twitter:image" content="https://hongwei7.github.io/logo.png"/>

<meta name="twitter:title" content="Linux ç³»ç»Ÿç¼–ç¨‹"/>
<meta name="twitter:description" content="ğŸ®Linuxç³»ç»Ÿçº§ç¼–ç¨‹ç¬”è®°ã€‚"/>
<meta name="application-name" content="hongwei&#39;s Blog">
<meta name="apple-mobile-web-app-title" content="hongwei&#39;s Blog"><meta name="theme-color" content="#ffffff"><meta name="msapplication-TileColor" content="#da532c"><link rel="shortcut icon" type="image/x-icon" href="/favicon.ico" />
        <link rel="icon" type="image/png" sizes="32x32" href="/favicon-32x32.png">
        <link rel="icon" type="image/png" sizes="16x16" href="/favicon-16x16.png"><link rel="apple-touch-icon" sizes="180x180" href="/apple-touch-icon.png"><link rel="mask-icon" href="/safari-pinned-tab.svg" color="#5bbad5"><link rel="manifest" href="/site.webmanifest"><link rel="canonical" href="https://hongwei7.github.io/linuxsystem/" /><link rel="prev" href="https://hongwei7.github.io/%E4%B8%80%E4%BA%9B%E7%AE%80%E5%8D%95%E7%9A%84%E8%AE%BE%E8%AE%A1%E6%A8%A1%E5%BC%8F/" /><link rel="next" href="https://hongwei7.github.io/mysql%E5%8E%9F%E7%90%86/" /><link rel="stylesheet" href="/lib/normalize/normalize.min.css"><link rel="stylesheet" href="/css/style.min.css"><link rel="stylesheet" href="/lib/fontawesome-free/all.min.css"><link rel="stylesheet" href="/lib/animate/animate.min.css"><script type="application/ld+json">
    {
        "@context": "http://schema.org",
        "@type": "BlogPosting",
        "headline": "Linux ç³»ç»Ÿç¼–ç¨‹",
        "inLanguage": "zh-CN",
        "mainEntityOfPage": {
            "@type": "WebPage",
            "@id": "https:\/\/hongwei7.github.io\/linuxsystem\/"
        },"genre": "posts","keywords": "Coding, Linux","wordcount":  8067 ,
        "url": "https:\/\/hongwei7.github.io\/linuxsystem\/","datePublished": "2021-02-08T00:00:00+00:00","dateModified": "2021-02-08T00:00:00+00:00","license": "This work is licensed under a Creative Commons Attribution-NonCommercial 4.0 International License.","publisher": {
            "@type": "Organization",
            "name": ""},"author": {
                "@type": "Person",
                "name": "hongwei"
            },"description": ""
    }
    </script></head>
    <body header-desktop="fixed" header-mobile="auto"><script type="text/javascript">(window.localStorage && localStorage.getItem('theme') ? localStorage.getItem('theme') === 'dark' : ('auto' === 'auto' ? window.matchMedia('(prefers-color-scheme: dark)').matches : 'auto' === 'dark')) && document.body.setAttribute('theme', 'dark');</script>

        <div id="mask"></div><div class="wrapper"><header class="desktop" id="header-desktop">
    <div class="header-wrapper">
        <div class="header-title">
            <a href="/" title="hongwei7 çš„åšå®¢">hongwei&#39;s Blog</a>
        </div>
        <div class="menu">
            <div class="menu-inner"><a class="menu-item" href="/posts/"> æ‰€æœ‰æ–‡ç«  </a><a class="menu-item" href="/tags/"> æ ‡ç­¾ </a><a class="menu-item" href="/categories/"> åˆ†ç±» </a><a class="menu-item" href="/categories/documentation/"> æ–‡æ¡£ </a><a class="menu-item" href="/about/"> å…³äº </a><a class="menu-item" href="https://github.com/dillonzq/LoveIt" title="GitHub" rel="noopener noreffer" target="_blank"><i class='fab fa-github fa-fw'></i>  </a><span class="menu-item delimiter"></span><a href="javascript:void(0);" class="menu-item language" title="é€‰æ‹©è¯­è¨€">ç®€ä½“ä¸­æ–‡<i class="fas fa-chevron-right fa-fw"></i>
                        <select class="language-select" id="language-select-desktop" onchange="location = this.value;"><option value="/linuxsystem/" selected>ç®€ä½“ä¸­æ–‡</option></select>
                    </a><span class="menu-item search" id="search-desktop">
                        <input type="text" placeholder="æœç´¢æ–‡ç« æ ‡é¢˜æˆ–å†…å®¹..." id="search-input-desktop">
                        <a href="javascript:void(0);" class="search-button search-toggle" id="search-toggle-desktop" title="æœç´¢">
                            <i class="fas fa-search fa-fw"></i>
                        </a>
                        <a href="javascript:void(0);" class="search-button search-clear" id="search-clear-desktop" title="æ¸…ç©º">
                            <i class="fas fa-times-circle fa-fw"></i>
                        </a>
                        <span class="search-button search-loading" id="search-loading-desktop">
                            <i class="fas fa-spinner fa-fw fa-spin"></i>
                        </span>
                    </span><a href="javascript:void(0);" class="menu-item theme-switch" title="åˆ‡æ¢ä¸»é¢˜">
                    <i class="fas fa-adjust fa-fw"></i>
                </a>
            </div>
        </div>
    </div>
</header><header class="mobile" id="header-mobile">
    <div class="header-container">
        <div class="header-wrapper">
            <div class="header-title">
                <a href="/" title="hongwei7 çš„åšå®¢">hongwei&#39;s Blog</a>
            </div>
            <div class="menu-toggle" id="menu-toggle-mobile">
                <span></span><span></span><span></span>
            </div>
        </div>
        <div class="menu" id="menu-mobile"><div class="search-wrapper">
                    <div class="search mobile" id="search-mobile">
                        <input type="text" placeholder="æœç´¢æ–‡ç« æ ‡é¢˜æˆ–å†…å®¹..." id="search-input-mobile">
                        <a href="javascript:void(0);" class="search-button search-toggle" id="search-toggle-mobile" title="æœç´¢">
                            <i class="fas fa-search fa-fw"></i>
                        </a>
                        <a href="javascript:void(0);" class="search-button search-clear" id="search-clear-mobile" title="æ¸…ç©º">
                            <i class="fas fa-times-circle fa-fw"></i>
                        </a>
                        <span class="search-button search-loading" id="search-loading-mobile">
                            <i class="fas fa-spinner fa-fw fa-spin"></i>
                        </span>
                    </div>
                    <a href="javascript:void(0);" class="search-cancel" id="search-cancel-mobile">
                        å–æ¶ˆ
                    </a>
                </div><a class="menu-item" href="/posts/" title="">æ‰€æœ‰æ–‡ç« </a><a class="menu-item" href="/tags/" title="">æ ‡ç­¾</a><a class="menu-item" href="/categories/" title="">åˆ†ç±»</a><a class="menu-item" href="/categories/documentation/" title="">æ–‡æ¡£</a><a class="menu-item" href="/about/" title="">å…³äº</a><a class="menu-item" href="https://github.com/dillonzq/LoveIt" title="GitHub" rel="noopener noreffer" target="_blank"><i class='fab fa-github fa-fw'></i></a><a href="javascript:void(0);" class="menu-item theme-switch" title="åˆ‡æ¢ä¸»é¢˜">
                <i class="fas fa-adjust fa-fw"></i>
            </a><a href="javascript:void(0);" class="menu-item" title="é€‰æ‹©è¯­è¨€">ç®€ä½“ä¸­æ–‡<i class="fas fa-chevron-right fa-fw"></i>
                    <select class="language-select" onchange="location = this.value;"><option value="/linuxsystem/" selected>ç®€ä½“ä¸­æ–‡</option></select>
                </a></div>
    </div>
</header>
<div class="search-dropdown desktop">
    <div id="search-dropdown-desktop"></div>
</div>
<div class="search-dropdown mobile">
    <div id="search-dropdown-mobile"></div>
</div>
<main class="main">
                <div class="container"><div class="toc" id="toc-auto">
            <h2 class="toc-title">ç›®å½•</h2>
            <div class="toc-content" id="toc-content-auto"></div>
        </div><article class="page single"><h1 class="single-title animated flipInX">Linux ç³»ç»Ÿç¼–ç¨‹</h1><div class="post-meta">
            <div class="post-meta-line"><span class="post-author"><a href="https://github.com/hongwei7" title="Author" target="_blank" rel="noopener noreffer author" class="author"><i class="fas fa-user-circle fa-fw"></i>hongwei</a></span></div>
            <div class="post-meta-line"><i class="far fa-calendar-alt fa-fw"></i>&nbsp;<time datetime="2021-02-08">2021-02-08</time>&nbsp;<i class="fas fa-pencil-alt fa-fw"></i>&nbsp;çº¦ 8067 å­—&nbsp;
                <i class="far fa-clock fa-fw"></i>&nbsp;é¢„è®¡é˜…è¯» 17 åˆ†é’Ÿ&nbsp;</div>
        </div><div class="details toc" id="toc-static"  kept="true">
                <div class="details-summary toc-title">
                    <span>ç›®å½•</span>
                    <span><i class="details-icon fas fa-angle-right"></i></span>
                </div>
                <div class="details-content toc-content" id="toc-content-static"><nav id="TableOfContents">
  <ul>
    <li><a href="#mmu">MMU</a></li>
    <li><a href="#è¿›ç¨‹æ§åˆ¶å—pcb">è¿›ç¨‹æ§åˆ¶å—PCB</a></li>
    <li><a href="#ç¯å¢ƒå˜é‡">ç¯å¢ƒå˜é‡</a>
      <ul>
        <li><a href="#getenv-è·å–ç¯å¢ƒå˜é‡">getenv è·å–ç¯å¢ƒå˜é‡</a></li>
        <li><a href="#setenvè®¾ç½®ç¯å¢ƒå˜é‡">setenvè®¾ç½®ç¯å¢ƒå˜é‡</a></li>
        <li><a href="#unsetenvå–æ¶ˆç¯å¢ƒå˜é‡">unsetenvå–æ¶ˆç¯å¢ƒå˜é‡</a></li>
      </ul>
    </li>
    <li><a href="#è¿›ç¨‹æ§åˆ¶">è¿›ç¨‹æ§åˆ¶</a>
      <ul>
        <li><a href="#fork">fork()</a></li>
        <li><a href="#getpid-è·å–-pid">getpid è·å– pid</a></li>
        <li><a href="#getppid-è·å–çˆ¶äº²-pid">getppid è·å–çˆ¶äº² pid</a></li>
        <li><a href="#åˆ›å»ºnä¸ªè¿›ç¨‹">åˆ›å»ºNä¸ªè¿›ç¨‹</a></li>
      </ul>
    </li>
    <li><a href="#è¿›ç¨‹å…±äº«">è¿›ç¨‹å…±äº«</a></li>
    <li><a href="#gdbè°ƒè¯•å¤šè¿›ç¨‹ç¨‹åº">gdbè°ƒè¯•å¤šè¿›ç¨‹ç¨‹åº</a></li>
    <li><a href="#execç±»å‡½æ•°">execç±»å‡½æ•°</a></li>
    <li><a href="#ä¿å­˜-ps-ç»“æœåˆ°-out">ä¿å­˜ ps ç»“æœåˆ° out</a></li>
    <li><a href="#å›æ”¶å­è¿›ç¨‹">å›æ”¶å­è¿›ç¨‹</a>
      <ul>
        <li><a href="#å­¤å„¿è¿›ç¨‹">å­¤å„¿è¿›ç¨‹</a></li>
        <li><a href="#åƒµå°¸è¿›ç¨‹">åƒµå°¸è¿›ç¨‹</a></li>
        <li><a href="#wait-waitpid-è§£å†³åƒµå°¸å‡½æ•°">wait waitpid è§£å†³åƒµå°¸å‡½æ•°</a></li>
      </ul>
    </li>
  </ul>

  <ul>
    <li><a href="#ç®¡é“-pipe">ç®¡é“ pipe</a>
      <ul>
        <li><a href="#ç®€å•çš„ç®¡é“ç¤ºä¾‹">ç®€å•çš„ç®¡é“ç¤ºä¾‹ï¼š</a></li>
      </ul>
    </li>
    <li><a href="#mmap-å…±äº«å†…å­˜">mmap å…±äº«å†…å­˜</a>
      <ul>
        <li><a href="#mmap-çˆ¶å­ä¹‹é—´é€šä¿¡">mmap çˆ¶å­ä¹‹é—´é€šä¿¡</a></li>
        <li><a href="#mmapåŒ¿åæ˜ å°„">mmapåŒ¿åæ˜ å°„</a></li>
        <li><a href="#straceå‘½ä»¤">straceå‘½ä»¤</a></li>
      </ul>
    </li>
    <li><a href="#é˜¶æ®µæ€§ç»ƒä¹ ">é˜¶æ®µæ€§ç»ƒä¹ </a>
      <ul>
        <li><a href="#å¤šæ–‡ä»¶æ‹·è´">å¤šæ–‡ä»¶æ‹·è´</a></li>
        <li><a href="#ç®€å•-shell">ç®€å• shell</a></li>
        <li><a href="#æœ¬åœ°èŠå¤©å®¤åŠŸèƒ½">æœ¬åœ°èŠå¤©å®¤åŠŸèƒ½</a></li>
      </ul>
    </li>
  </ul>

  <ul>
    <li><a href="#ä¿¡å·çš„ä¼ è¾“è¿‡ç¨‹">ä¿¡å·çš„ä¼ è¾“è¿‡ç¨‹</a></li>
    <li><a href="#ä¿¡å·çš„äº§ç”Ÿ">ä¿¡å·çš„äº§ç”Ÿ</a>
      <ul>
        <li><a href="#kill-å‡½æ•°">kill å‡½æ•°</a></li>
        <li><a href="#raise-ä¸-abort-å‡½æ•°">raise ä¸ abort å‡½æ•°</a></li>
        <li><a href="#alarm-å‡½æ•°">alarm å‡½æ•°</a></li>
        <li><a href="#setitimer">setitimer</a></li>
      </ul>
    </li>
    <li><a href="#ä¿¡å·é›†æ“ä½œ">ä¿¡å·é›†æ“ä½œ</a>
      <ul>
        <li><a href="#ä¿¡å·é›†è®¾å®š">ä¿¡å·é›†è®¾å®š</a></li>
        <li><a href="#sigprocmask-å‡½æ•°">sigprocmask å‡½æ•°</a></li>
        <li><a href="#sigpending-å‡½æ•°">sigpending å‡½æ•°</a></li>
        <li><a href="#ç¤ºä¾‹æ‰“å°æœªå†³ä¿¡å·é›†">ç¤ºä¾‹ï¼šæ‰“å°æœªå†³ä¿¡å·é›†</a></li>
      </ul>
    </li>
    <li><a href="#ä¿¡å·çš„æ•æ‰">ä¿¡å·çš„æ•æ‰</a>
      <ul>
        <li><a href="#signal-å‡½æ•°">signal å‡½æ•°</a></li>
        <li><a href="#sigaction-å‡½æ•°">sigaction å‡½æ•°</a></li>
        <li><a href="#æ•æ‰åŸç†">æ•æ‰åŸç†</a></li>
      </ul>
    </li>
  </ul>

  <ul>
    <li><a href="#pauseå‡½æ•°">pauseå‡½æ•°ï¼š</a></li>
    <li><a href="#æ—¶åºç«æ€">æ—¶åºç«æ€</a>
      <ul>
        <li><a href="#ä¸€ä¸ªä¼šå‡ºé—®é¢˜çš„ä¾‹å­">ä¸€ä¸ªä¼šå‡ºé—®é¢˜çš„ä¾‹å­</a></li>
        <li><a href="#sigsuspend-å‡½æ•°">sigsuspend å‡½æ•°</a></li>
        <li><a href="#å…¨å±€å˜é‡å¼‚æ­¥ioé—®é¢˜">å…¨å±€å˜é‡å¼‚æ­¥IOé—®é¢˜</a></li>
        <li><a href="#å¯é‡å…¥å‡½æ•°">å¯é‡å…¥å‡½æ•°</a></li>
      </ul>
    </li>
    <li><a href="#sigchldå›æ”¶å­è¿›ç¨‹">SIGCHLDå›æ”¶å­è¿›ç¨‹</a></li>
    <li><a href="#ä¿¡å·ä¼ å‚">ä¿¡å·ä¼ å‚</a>
      <ul>
        <li><a href="#å‘é€å‚æ•°">å‘é€å‚æ•°</a></li>
        <li><a href="#æ¥æ”¶å‚æ•°">æ¥æ”¶å‚æ•°</a></li>
      </ul>
    </li>
    <li><a href="#ä¸­æ–­ç³»ç»Ÿè°ƒç”¨">ä¸­æ–­ç³»ç»Ÿè°ƒç”¨</a></li>
  </ul>

  <ul>
    <li><a href="#ç»ˆç«¯">ç»ˆç«¯</a>
      <ul>
        <li><a href="#å¯åŠ¨æµç¨‹">å¯åŠ¨æµç¨‹</a></li>
        <li><a href="#ttynameå‡½æ•°">ttynameå‡½æ•°</a></li>
        <li><a href="#ç½‘ç»œç»ˆç«¯">ç½‘ç»œç»ˆç«¯</a></li>
      </ul>
    </li>
    <li><a href="#è¿›ç¨‹ç»„-ps-ajx">è¿›ç¨‹ç»„ ps ajx</a>
      <ul>
        <li><a href="#getpgrp-è·å–è¿›ç¨‹ç»„id">getpgrp è·å–è¿›ç¨‹ç»„ID</a></li>
        <li><a href="#getpgid-è·å–æŒ‡å®šè¿›ç¨‹çš„è¿›ç¨‹ç»„id">getpgid è·å–æŒ‡å®šè¿›ç¨‹çš„è¿›ç¨‹ç»„id</a></li>
        <li><a href="#setpgid-è®¾å®šæŒ‡å®šè¿›ç¨‹çš„è¿›ç¨‹ç»„id">setpgid è®¾å®šæŒ‡å®šè¿›ç¨‹çš„è¿›ç¨‹ç»„id</a></li>
      </ul>
    </li>
    <li><a href="#ä¼šè¯">ä¼šè¯</a>
      <ul>
        <li><a href="#åˆ›å»ºä¼šè¯">åˆ›å»ºä¼šè¯</a></li>
        <li><a href="#getsid-æŸ¥çœ‹ä¼šè¯id">getsid æŸ¥çœ‹ä¼šè¯id</a></li>
        <li><a href="#setsid-è®¾ç½®ä¼šè¯id">setsid è®¾ç½®ä¼šè¯id</a></li>
      </ul>
    </li>
    <li><a href="#å®ˆæŠ¤è¿›ç¨‹">å®ˆæŠ¤è¿›ç¨‹</a>
      <ul>
        <li><a href="#åˆ›å»ºæ–¹å¼">åˆ›å»ºæ–¹å¼</a></li>
      </ul>
    </li>
  </ul>

  <ul>
    <li><a href="#æ¦‚å¿µ">æ¦‚å¿µ</a>
      <ul>
        <li><a href="#linuxçº¿ç¨‹å®ç°åŸç†">Linuxçº¿ç¨‹å®ç°åŸç†</a></li>
        <li><a href="#çº¿ç¨‹å…±äº«èµ„æº">çº¿ç¨‹å…±äº«èµ„æº</a></li>
        <li><a href="#éå…±äº«èµ„æº">éå…±äº«èµ„æº</a></li>
        <li><a href="#ä¼˜ç¼ºç‚¹">ä¼˜ç¼ºç‚¹</a></li>
      </ul>
    </li>
    <li><a href="#æ§åˆ¶åŸè¯­">æ§åˆ¶åŸè¯­</a>
      <ul>
        <li><a href="#pthread_self">pthread_self</a></li>
        <li><a href="#pthread_create">pthread_create</a></li>
        <li><a href="#pthread_exit">pthread_exit</a></li>
        <li><a href="#pthread_join">pthread_join</a></li>
        <li><a href="#pthread_detach">pthread_detach</a></li>
        <li><a href="#pthread_cancel">pthread_cancel</a></li>
        <li><a href="#åŸè¯­å¯¹æ¯”">åŸè¯­å¯¹æ¯”</a></li>
      </ul>
    </li>
    <li><a href="#çº¿ç¨‹å±æ€§">çº¿ç¨‹å±æ€§</a></li>
    <li><a href="#nptl-çº¿ç¨‹åº“ç‰ˆæœ¬">NPTL çº¿ç¨‹åº“ç‰ˆæœ¬</a></li>
    <li><a href="#æ³¨æ„äº‹é¡¹">æ³¨æ„äº‹é¡¹</a></li>
  </ul>

  <ul>
    <li><a href="#æ¦‚å¿µ-1">æ¦‚å¿µ</a></li>
    <li><a href="#äº’æ–¥é‡-mutex">äº’æ–¥é‡ mutex</a>
      <ul>
        <li><a href="#pthread_mutex_initdestory">pthread_mutex_initï¼ˆdestoryï¼‰</a></li>
        <li><a href="#pthread_mutex_lock">pthread_mutex_lock</a></li>
        <li><a href="#pthread_mutex_trylock">pthread_mutex_trylock</a></li>
        <li><a href="#pthread_mutex_unlock">pthread_mutex_unlock</a></li>
        <li><a href="#æ­»é”">æ­»é”</a></li>
      </ul>
    </li>
    <li><a href="#è¯»å†™é”">è¯»å†™é”</a></li>
    <li><a href="#æ¡ä»¶å˜é‡">æ¡ä»¶å˜é‡</a>
      <ul>
        <li><a href="#pthread_cond_wait">pthread_cond_wait</a></li>
        <li><a href="#pthread_cond_timedwait">pthread_cond_timedwait</a></li>
        <li><a href="#ä½¿ç”¨æ¡ä»¶å˜é‡è§£å†³ç”Ÿäº§è€…æ¶ˆè´¹è€…æ¨¡å‹">ä½¿ç”¨æ¡ä»¶å˜é‡è§£å†³ç”Ÿäº§è€…æ¶ˆè´¹è€…æ¨¡å‹</a></li>
      </ul>
    </li>
    <li><a href="#ä¿¡å·é‡ä¹Ÿå¯ä»¥åº”ç”¨äºè¿›ç¨‹é—´åŒæ­¥">ä¿¡å·é‡ï¼ˆä¹Ÿå¯ä»¥åº”ç”¨äºè¿›ç¨‹é—´åŒæ­¥ï¼‰</a>
      <ul>
        <li><a href="#sem_init">sem_init</a></li>
        <li><a href="#sem_destroy">sem_destroy</a></li>
        <li><a href="#sem_wait">sem_wait</a></li>
        <li><a href="#sem_trywait">sem_trywait</a></li>
        <li><a href="#sem_timedwait">sem_timedwait</a></li>
        <li><a href="#sem_post">sem_post</a></li>
        <li><a href="#ç”Ÿäº§è€…æ¶ˆè´¹è€…">ç”Ÿäº§è€…æ¶ˆè´¹è€…</a></li>
      </ul>
    </li>
    <li><a href="#è¿›ç¨‹é—´åŒæ­¥">è¿›ç¨‹é—´åŒæ­¥</a>
      <ul>
        <li><a href="#äº’æ–¥é‡">äº’æ–¥é‡</a></li>
      </ul>
    </li>
    <li><a href="#æ–‡ä»¶é”">æ–‡ä»¶é”</a>
      <ul>
        <li><a href="#fcntlå‡½æ•°">fcntlå‡½æ•°</a></li>
      </ul>
    </li>
  </ul>
</nav></div>
            </div><div class="content" id="content"><h1 id="è¿›ç¨‹">è¿›ç¨‹</h1>
<h2 id="mmu">MMU</h2>
<p><img
        class="lazyload"
        src="/svg/loading.min.svg"
        data-src="/images/LinuxSystem/Untitled.png"
        data-srcset="/images/LinuxSystem/Untitled.png, /images/LinuxSystem/Untitled.png 1.5x, /images/LinuxSystem/Untitled.png 2x"
        data-sizes="auto"
        alt="/images/LinuxSystem/Untitled.png"
        title="/images/LinuxSystem/Untitled.png" /></p>
<h2 id="è¿›ç¨‹æ§åˆ¶å—pcb">è¿›ç¨‹æ§åˆ¶å—PCB</h2>
<p>è¿›ç¨‹æ§åˆ¶å—PCBçš„ç»“æ„ä½“å½¢å¼ï¼štask_structã€‚</p>
<p><img
        class="lazyload"
        src="/svg/loading.min.svg"
        data-src="/images/LinuxSystem/Untitled%201.png"
        data-srcset="/images/LinuxSystem/Untitled%201.png, /images/LinuxSystem/Untitled%201.png 1.5x, /images/LinuxSystem/Untitled%201.png 2x"
        data-sizes="auto"
        alt="/images/LinuxSystem/Untitled%201.png"
        title="/images/LinuxSystem/Untitled%201.png" /></p>
<p>è™šæ‹Ÿåœ°å€ç©ºé—´çš„ä¿¡æ¯æè¿°ä¸ºè™šæ‹Ÿåœ°å€åˆ°ç‰©ç†åœ°å€çš„æ˜ å°„ã€‚MMUæ¥ç»´æŠ¤ã€‚</p>
<p>umaskæ©ç ï¼šä¿æŠ¤æ–‡ä»¶æƒé™ã€‚</p>
<p>ulimit -a èƒ½æŸ¥çœ‹linuxèµ„æºä¸Šé™</p>
<h2 id="ç¯å¢ƒå˜é‡">ç¯å¢ƒå˜é‡</h2>
<p>ä»¥ç”¨æˆ·ä¸ºå•ä½è®¾ç½®ç¯å¢ƒå˜é‡ã€‚</p>
<ul>
<li>PATH</li>
<li>SHELL å½“å‰SHELL</li>
<li>TERM å½“å‰ç»ˆç«¯ç±»å‹</li>
<li>HOME</li>
<li>LANG</li>
</ul>
<p>ç±»ä¼¼äºå‘½ä»¤è¡Œå‚æ•°ã€‚</p>
<p><img
        class="lazyload"
        src="/svg/loading.min.svg"
        data-src="/images/LinuxSystem/Untitled%202.png"
        data-srcset="/images/LinuxSystem/Untitled%202.png, /images/LinuxSystem/Untitled%202.png 1.5x, /images/LinuxSystem/Untitled%202.png 2x"
        data-sizes="auto"
        alt="/images/LinuxSystem/Untitled%202.png"
        title="/images/LinuxSystem/Untitled%202.png" /></p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-c" data-lang="c"><span class="k">extern</span> <span class="kt">char</span><span class="o">**</span> <span class="n">eniron</span>
</code></pre></td></tr></table>
</div>
</div><h3 id="getenv-è·å–ç¯å¢ƒå˜é‡">getenv è·å–ç¯å¢ƒå˜é‡</h3>
<h3 id="setenvè®¾ç½®ç¯å¢ƒå˜é‡">setenvè®¾ç½®ç¯å¢ƒå˜é‡</h3>
<h3 id="unsetenvå–æ¶ˆç¯å¢ƒå˜é‡">unsetenvå–æ¶ˆç¯å¢ƒå˜é‡</h3>
<h2 id="è¿›ç¨‹æ§åˆ¶">è¿›ç¨‹æ§åˆ¶</h2>
<h3 id="fork">fork()</h3>
<p><img
        class="lazyload"
        src="/svg/loading.min.svg"
        data-src="/images/LinuxSystem/Untitled%203.png"
        data-srcset="/images/LinuxSystem/Untitled%203.png, /images/LinuxSystem/Untitled%203.png 1.5x, /images/LinuxSystem/Untitled%203.png 2x"
        data-sizes="auto"
        alt="/images/LinuxSystem/Untitled%203.png"
        title="/images/LinuxSystem/Untitled%203.png" /></p>
<p>åˆ›å»ºçš„æ˜¯å­è¿›ç¨‹ã€‚é€šè¿‡è¿”å›çš„pidæ¥åˆ¤æ–­æ˜¯å¦åœ¨å­è¿›ç¨‹ä¸­ã€‚è¿”å›0æ—¶ä¸ºå­è¿›ç¨‹ï¼Œçˆ¶è¿›ç¨‹ä¸­è¿”å›å­è¿›ç¨‹çš„pidã€‚</p>
<h3 id="getpid-è·å–-pid">getpid è·å– pid</h3>
<h3 id="getppid-è·å–çˆ¶äº²-pid">getppid è·å–çˆ¶äº² pid</h3>
<h3 id="åˆ›å»ºnä¸ªè¿›ç¨‹">åˆ›å»ºNä¸ªè¿›ç¨‹</h3>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span><span class="lnt">18
</span><span class="lnt">19
</span><span class="lnt">20
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-c" data-lang="c"><span class="cp">#include</span> <span class="cpf">&lt;unistd.h&gt;</span><span class="cp">
</span><span class="cp">#include</span> <span class="cpf">&lt;sys/types.h&gt;</span><span class="cp">
</span><span class="cp">#include</span> <span class="cpf">&lt;stdio.h&gt;</span><span class="cp">
</span><span class="cp">#include</span> <span class="cpf">&lt;stdlib.h&gt;</span><span class="cp">
</span><span class="cp"></span>
<span class="kt">int</span> <span class="nf">forkN</span><span class="p">(</span><span class="kt">int</span> <span class="n">n</span><span class="p">){</span>
        <span class="n">printf</span><span class="p">(</span><span class="s">&#34;I am the father %d</span><span class="se">\n</span><span class="s">&#34;</span><span class="p">,</span> <span class="n">getpid</span><span class="p">());</span>
        <span class="k">for</span><span class="p">(</span><span class="kt">int</span> <span class="n">i</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span> <span class="n">i</span> <span class="o">&lt;</span> <span class="n">n</span><span class="p">;</span> <span class="n">i</span><span class="o">++</span><span class="p">){</span>
                <span class="kt">int</span> <span class="n">pid</span> <span class="o">=</span> <span class="n">fork</span><span class="p">();</span>
                <span class="k">if</span><span class="p">(</span><span class="n">pid</span> <span class="o">==</span> <span class="o">-</span><span class="mi">1</span><span class="p">){</span>
                        <span class="n">perror</span><span class="p">(</span><span class="s">&#34;fork error!&#34;</span><span class="p">);</span>
                        <span class="n">exit</span><span class="p">(</span><span class="mi">1</span><span class="p">);</span>
                <span class="p">}</span>
                <span class="k">else</span> <span class="k">if</span><span class="p">(</span><span class="n">pid</span> <span class="o">==</span> <span class="mi">0</span><span class="p">){</span>
                        <span class="n">printf</span><span class="p">(</span><span class="s">&#34;I am the %d child %u, my father is %u</span><span class="se">\n</span><span class="s">&#34;</span><span class="p">,</span> <span class="n">i</span> <span class="o">+</span> <span class="mi">1</span><span class="p">,</span> <span class="n">getpid</span><span class="p">(),</span> <span class="n">getppid</span><span class="p">());</span>
                        <span class="k">break</span><span class="p">;</span>
                <span class="p">}</span>
        <span class="p">}</span>
        <span class="k">return</span> <span class="mi">0</span><span class="p">;</span>
<span class="p">}</span>
</code></pre></td></tr></table>
</div>
</div><h2 id="è¿›ç¨‹å…±äº«">è¿›ç¨‹å…±äº«</h2>
<p>åˆšforkå®Œæ—¶ï¼Œçˆ¶å­è¿›ç¨‹ä¸­</p>
<p>å…¨å±€å˜é‡ã€dataã€.textã€æ ˆã€å †ã€ç¯å¢ƒå˜é‡ã€ç”¨æˆ·IDã€ç›®å½•ã€ä¿¡å·å¤„ç†æ–¹å¼éƒ½æ˜¯ç›¸åŒçš„ã€‚ï¼ˆ0-3Gåœ°å€ç›¸åŒï¼‰</p>
<p>ä¸åŒåœ¨äºè¿›ç¨‹idã€forkè¿”å›å€¼ã€çˆ¶è¿›ç¨‹idã€è¿›ç¨‹è¿è¡Œæ—¶é—´ã€å®šæ—¶å™¨ï¼ˆä¸€ä¸ªè¿›ç¨‹æœ‰ä¸€ä¸ªï¼‰ã€æœªå†³ä¿¡å·é›†ã€‚ï¼ˆPCBä¸ä¸€æ ·ï¼‰</p>
<p>forkå®Œä¹‹åï¼Œçˆ¶å­è¿›ç¨‹ä¹‹é—´éµå¾ª<strong>è¯»æ—¶å…±äº«ï¼Œå†™æ—¶å¤åˆ¶</strong>çš„åŸåˆ™ï¼ŒèŠ‚çœå†…å­˜å¼€é”€ã€‚</p>
<p>æ³¨æ„çˆ¶å­è¿›ç¨‹ä¹‹é—´ä¸èƒ½é€šè¿‡å…¨å±€å˜é‡å…±äº«æ•°æ®ã€‚ï¼ˆå†™æ—¶å¤åˆ¶ï¼‰</p>
<p>çˆ¶å­è¿›ç¨‹é—´å…±äº«çš„ç‚¹ï¼š</p>
<ul>
<li>æ–‡ä»¶æè¿°ç¬¦ï¼ˆå¤šä¸ªè¿›ç¨‹å¯¹åŒä¸€ä¸ªæ–‡ä»¶æ“ä½œï¼‰</li>
<li>mmapå»ºç«‹çš„æ˜ å°„åŒºï¼ˆè¿›ç¨‹é—´é€šä¿¡ï¼‰</li>
</ul>
<h2 id="gdbè°ƒè¯•å¤šè¿›ç¨‹ç¨‹åº">gdbè°ƒè¯•å¤šè¿›ç¨‹ç¨‹åº</h2>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-c" data-lang="c"><span class="n">set</span> <span class="n">follow</span><span class="o">-</span><span class="n">fork</span><span class="o">-</span><span class="n">mod</span> <span class="n">child</span>
<span class="n">set</span> <span class="n">follow</span><span class="o">-</span><span class="n">fork</span><span class="o">-</span><span class="n">mod</span> <span class="n">parent</span>
</code></pre></td></tr></table>
</div>
</div><h2 id="execç±»å‡½æ•°">execç±»å‡½æ•°</h2>
<p>è®©ç¨‹åºæ‰§è¡Œä¸€ä¸ªè¿›ç¨‹ï¼ˆåŸè¿›ç¨‹çš„ç”¨æˆ·ç©ºé—´å’Œä»£ç å®Œå…¨è¢«æ–°ç¨‹åºæ›¿æ¢ï¼‰ã€‚</p>
<p>æ³¨æ„æ­¤æ—¶å¹¶ä¸æ˜¯åˆ›å»ºä¸€ä¸ªæ–°è¿›ç¨‹ï¼Œè€Œæ˜¯åŸè¿›ç¨‹çš„ç”¨æˆ·ç©ºé—´å’Œä»£ç å…¨éƒ¨è¢«æ›¿æ¢ã€‚</p>
<p><img
        class="lazyload"
        src="/svg/loading.min.svg"
        data-src="/images/LinuxSystem/Untitled%204.png"
        data-srcset="/images/LinuxSystem/Untitled%204.png, /images/LinuxSystem/Untitled%204.png 1.5x, /images/LinuxSystem/Untitled%204.png 2x"
        data-sizes="auto"
        alt="/images/LinuxSystem/Untitled%204.png"
        title="/images/LinuxSystem/Untitled%204.png" /></p>
<p>é‡ç‚¹execlå’Œexeclpã€‚</p>
<ul>
<li>
<p>execlpï¼šï¼ˆlist pathï¼‰åŠ è½½ä¸€ä¸ªè¿›ç¨‹ï¼Œå€ŸåŠ©ç¯å¢ƒå˜é‡</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-c" data-lang="c"><span class="n">execlp</span><span class="p">(</span><span class="s">&#34;ls&#34;</span><span class="p">,</span> <span class="s">&#34;ls&#34;</span><span class="p">,</span> <span class="s">&#34;-l&#34;</span><span class="p">,</span> <span class="s">&#34;-a&#34;</span><span class="p">,</span> <span class="nb">NULL</span><span class="p">);</span>
<span class="c1">//ç¬¬äºŒä¸ªå‚æ•°ç›¸å½“äºargv[0] ä¸€èˆ¬å¯èƒ½ä¸ä½¿ç”¨
</span></code></pre></td></tr></table>
</div>
</div></li>
<li>
<p>execlï¼šé€šè¿‡è·¯å¾„+ç¨‹åºåæ¥åŠ è½½ã€‚</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-c" data-lang="c"><span class="n">execl</span><span class="p">(</span><span class="s">&#34;/bin/ls&#34;</span><span class="p">,</span> <span class="s">&#34;ls&#34;</span><span class="p">,</span> <span class="s">&#34;-l&#34;</span><span class="p">,</span> <span class="s">&#34;-a&#34;</span><span class="p">,</span> <span class="nb">NULL</span><span class="p">);</span>
</code></pre></td></tr></table>
</div>
</div></li>
<li>
<p>execle:å€ŸåŠ©ç¯å¢ƒå˜é‡è¡¨</p>
</li>
<li>
<p>execvï¼šä¸å«argv[0]ï¼Œä½†æ˜¯å‚æ•°å…ˆè¦åŒ…è£…æˆå­—ç¬¦æ•°ç»„ã€‚</p>
</li>
</ul>
<h2 id="ä¿å­˜-ps-ç»“æœåˆ°-out">ä¿å­˜ ps ç»“æœåˆ° out</h2>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span><span class="lnt">18
</span><span class="lnt">19
</span><span class="lnt">20
</span><span class="lnt">21
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-c" data-lang="c"><span class="cp">#include</span> <span class="cpf">&lt;stdio.h&gt;</span><span class="cp">
</span><span class="cp">#include</span> <span class="cpf">&lt;unistd.h&gt;</span><span class="cp">
</span><span class="cp">#include</span> <span class="cpf">&lt;stdlib.h&gt;</span><span class="cp">
</span><span class="cp">#include</span> <span class="cpf">&lt;sys/types.h&gt;</span><span class="cp">
</span><span class="cp">#include</span> <span class="cpf">&lt;fcntl.h&gt;</span><span class="cp">
</span><span class="cp">#include</span> <span class="cpf">&lt;sys/stat.h&gt;</span><span class="cp">
</span><span class="cp"></span>
<span class="kt">int</span> <span class="nf">ps</span><span class="p">()</span>
<span class="p">{</span>
        <span class="kt">int</span> <span class="n">fd</span> <span class="o">=</span> <span class="n">open</span><span class="p">(</span><span class="s">&#34;out&#34;</span><span class="p">,</span> <span class="n">O_WRONLY</span> <span class="o">|</span> <span class="n">O_CREAT</span> <span class="o">|</span> <span class="n">O_TRUNC</span><span class="p">,</span> <span class="mo">0644</span><span class="p">);</span>
        <span class="k">if</span><span class="p">(</span><span class="n">fd</span> <span class="o">==</span> <span class="o">-</span><span class="mi">1</span><span class="p">){</span>
                <span class="n">perror</span><span class="p">(</span><span class="s">&#34;open file:&#34;</span><span class="p">);</span>
                <span class="n">exit</span><span class="p">(</span><span class="mi">1</span><span class="p">);</span>
        <span class="p">}</span>
        <span class="n">dup2</span><span class="p">(</span><span class="n">fd</span><span class="p">,</span> <span class="n">STDOUT_FILENO</span><span class="p">);</span> <span class="c1">//æŠŠoutæ–‡ä»¶çš„æè¿°ç¬¦å¤åˆ¶åˆ°std::out
</span><span class="c1"></span>        <span class="kt">int</span> <span class="n">res</span> <span class="o">=</span> <span class="n">execlp</span><span class="p">(</span><span class="s">&#34;ps&#34;</span><span class="p">,</span> <span class="s">&#34;ps&#34;</span><span class="p">,</span> <span class="s">&#34;aux&#34;</span><span class="p">,</span> <span class="nb">NULL</span><span class="p">);</span>
				<span class="k">if</span><span class="p">(</span><span class="n">res</span> <span class="o">==</span> <span class="o">-</span><span class="mi">1</span><span class="p">)</span><span class="n">perror</span><span class="p">(</span><span class="s">&#34;exec error:&#34;</span><span class="p">);</span>
				<span class="n">exit</span><span class="p">(</span><span class="mi">1</span><span class="p">);</span>
        <span class="n">close</span><span class="p">(</span><span class="n">fd</span><span class="p">);</span>
        <span class="k">return</span> <span class="mi">0</span><span class="p">;</span>
<span class="p">}</span>
</code></pre></td></tr></table>
</div>
</div><p>execå‡½æ•°åªåœ¨å‡ºé”™çš„æ—¶å€™è¿”å›-1ã€‚</p>
<h2 id="å›æ”¶å­è¿›ç¨‹">å›æ”¶å­è¿›ç¨‹</h2>
<h3 id="å­¤å„¿è¿›ç¨‹">å­¤å„¿è¿›ç¨‹</h3>
<p>çˆ¶è¿›ç¨‹å…ˆäºå­è¿›ç¨‹ç»“æŸï¼Œå­è¿›ç¨‹åˆ™ä¸ºå­¤å„¿è¿›ç¨‹ï¼Œå­è¿›ç¨‹çˆ¶è¿›ç¨‹å˜ä¸ºinitè¿›ç¨‹ï¼ˆå­¤å„¿é™¢ï¼‰ï¼Œçˆ¶è¿›ç¨‹çš„pidå˜ä¸º1ã€‚</p>
<h3 id="åƒµå°¸è¿›ç¨‹">åƒµå°¸è¿›ç¨‹</h3>
<p>è¿›ç¨‹ç»ˆæ­¢äº†ï¼Œä½†æ˜¯çˆ¶è¿›ç¨‹æ²¡æœ‰å›æ”¶ã€‚å­è¿›ç¨‹PCBæ®‹ç•™åœ¨å†…æ ¸ä¸­ï¼Œæˆä¸ºåƒµå°¸è¿›ç¨‹ã€‚</p>
<p><img
        class="lazyload"
        src="/svg/loading.min.svg"
        data-src="/images/LinuxSystem/Untitled%205.png"
        data-srcset="/images/LinuxSystem/Untitled%205.png, /images/LinuxSystem/Untitled%205.png 1.5x, /images/LinuxSystem/Untitled%205.png 2x"
        data-sizes="auto"
        alt="/images/LinuxSystem/Untitled%205.png"
        title="/images/LinuxSystem/Untitled%205.png" /></p>
<p>è¿™é‡Œçš„çˆ¶è¿›ç¨‹ä¸€ç›´ä¸åœæ­¢ï¼Œä½†æ˜¯å­è¿›ç¨‹çš„PCBä¸€ç›´ä¸å›æ”¶ã€‚</p>
<p><img
        class="lazyload"
        src="/svg/loading.min.svg"
        data-src="/images/LinuxSystem/Untitled%206.png"
        data-srcset="/images/LinuxSystem/Untitled%206.png, /images/LinuxSystem/Untitled%206.png 1.5x, /images/LinuxSystem/Untitled%206.png 2x"
        data-sizes="auto"
        alt="/images/LinuxSystem/Untitled%206.png"
        title="/images/LinuxSystem/Untitled%206.png" /></p>
<h3 id="wait-waitpid-è§£å†³åƒµå°¸å‡½æ•°">wait waitpid è§£å†³åƒµå°¸å‡½æ•°</h3>
<p>waitæœ‰ä¸‰ä¸ªåŠŸèƒ½</p>
<ul>
<li>é˜»å¡ç­‰å¾…å­è¿›ç¨‹é€€å‡ºã€‚</li>
<li>å›æ”¶å­è¿›ç¨‹æ®‹ç•™èµ„æºã€‚</li>
<li>è·å–å­è¿›ç¨‹ç»“æŸçŠ¶æ€ã€‚</li>
</ul>
<p>ä¸€æ¬¡waitåªèƒ½å›æ”¶ä¸€ä¸ªè¿›ç¨‹ï¼Œå›æ”¶å…ˆç»“æŸçš„è¿›ç¨‹ã€‚</p>
<p>è¿”å›ä¸ºpidæ—¶ï¼Œå›æ”¶æˆåŠŸï¼Œ-1æ—¶ï¼Œæ²¡æœ‰å­è¿›ç¨‹ã€‚</p>
<p><img
        class="lazyload"
        src="/svg/loading.min.svg"
        data-src="/images/LinuxSystem/Untitled%207.png"
        data-srcset="/images/LinuxSystem/Untitled%207.png, /images/LinuxSystem/Untitled%207.png 1.5x, /images/LinuxSystem/Untitled%207.png 2x"
        data-sizes="auto"
        alt="/images/LinuxSystem/Untitled%207.png"
        title="/images/LinuxSystem/Untitled%207.png" /></p>
<p>wstatusä¸ºä¼ å‡ºå‚æ•°ï¼š</p>
<p><img
        class="lazyload"
        src="/svg/loading.min.svg"
        data-src="/images/LinuxSystem/Untitled%208.png"
        data-srcset="/images/LinuxSystem/Untitled%208.png, /images/LinuxSystem/Untitled%208.png 1.5x, /images/LinuxSystem/Untitled%208.png 2x"
        data-sizes="auto"
        alt="/images/LinuxSystem/Untitled%208.png"
        title="/images/LinuxSystem/Untitled%208.png" /></p>
<p>kill -lå¯ä»¥æŸ¥çœ‹ä¿¡å·ç»“æœã€‚</p>
<p>waitpidå‡½æ•°æ›´çµæ´»ä¸€äº›ï¼ŒæŒ‡å®špidå›æ”¶ï¼Œä¸”å¯ä»¥ä¸é˜»å¡ã€‚</p>
<p><img
        class="lazyload"
        src="/svg/loading.min.svg"
        data-src="/images/LinuxSystem/Untitled%209.png"
        data-srcset="/images/LinuxSystem/Untitled%209.png, /images/LinuxSystem/Untitled%209.png 1.5x, /images/LinuxSystem/Untitled%209.png 2x"
        data-sizes="auto"
        alt="/images/LinuxSystem/Untitled%209.png"
        title="/images/LinuxSystem/Untitled%209.png" /></p>
<p>pidä¸º-1æ—¶ï¼Œå›æ”¶ä»»æ„å­˜åœ¨çš„å­è¿›ç¨‹ã€‚</p>
<p><img
        class="lazyload"
        src="/svg/loading.min.svg"
        data-src="/images/LinuxSystem/Untitled%2010.png"
        data-srcset="/images/LinuxSystem/Untitled%2010.png, /images/LinuxSystem/Untitled%2010.png 1.5x, /images/LinuxSystem/Untitled%2010.png 2x"
        data-sizes="auto"
        alt="/images/LinuxSystem/Untitled%2010.png"
        title="/images/LinuxSystem/Untitled%2010.png" /></p>
<p>0 é˜»å¡ WNOHANG éé˜»å¡ï¼Œéœ€è¦è½®è¯¢ã€‚</p>
<p><img
        class="lazyload"
        src="/svg/loading.min.svg"
        data-src="/images/LinuxSystem/Untitled%2011.png"
        data-srcset="/images/LinuxSystem/Untitled%2011.png, /images/LinuxSystem/Untitled%2011.png 1.5x, /images/LinuxSystem/Untitled%2011.png 2x"
        data-sizes="auto"
        alt="/images/LinuxSystem/Untitled%2011.png"
        title="/images/LinuxSystem/Untitled%2011.png" /></p>
<p>æ€»ç»“ï¼š</p>
<p><img
        class="lazyload"
        src="/svg/loading.min.svg"
        data-src="/images/LinuxSystem/Untitled%2012.png"
        data-srcset="/images/LinuxSystem/Untitled%2012.png, /images/LinuxSystem/Untitled%2012.png 1.5x, /images/LinuxSystem/Untitled%2012.png 2x"
        data-sizes="auto"
        alt="/images/LinuxSystem/Untitled%2012.png"
        title="/images/LinuxSystem/Untitled%2012.png" /></p>
<h1 id="ipcè¿›ç¨‹é—´é€šä¿¡">IPCè¿›ç¨‹é—´é€šä¿¡</h1>
<p>å¸¸ç”¨æ–¹æ³•ï¼š</p>
<ul>
<li>ç®¡é“ï¼ˆæœ€ç®€å•ï¼‰</li>
<li>ä¿¡å·ï¼ˆå¼€é”€æœ€å°ï¼‰</li>
<li>å…±äº«æ˜ å°„åŒºï¼ˆæ— è¡€ç¼˜å…³ç³»ï¼‰ï¼ˆmmapï¼‰</li>
<li>æœ¬åœ°å¥—æ¥å­—ï¼ˆæœ€ç¨³å®šï¼‰</li>
</ul>
<h2 id="ç®¡é“-pipe">ç®¡é“ pipe</h2>
<p>fifoï¼ˆæœ‰åç®¡é“ï¼Œéè¡€ç¼˜å…³ç³»é—´ï¼‰ï¼Œpipeï¼ˆåŒ¿åç®¡é“ï¼‰</p>
<p>æœ€ç®€å•çš„æƒ³æ³•ï¼šé€šè¿‡æ–‡ä»¶å®ç°è¿›ç¨‹é—´é€šä¿¡ã€‚æŠ½è±¡æˆä¸ºç®¡é“ã€‚</p>
<p>ç®¡é“å®é™…ä¸Šä¸ºå†…æ ¸ç¼“å†²åŒºï¼Œä¸ºä¼ªæ–‡ä»¶ã€‚</p>
<p>ä¸€ä¸ªç®¡é“æœ‰ä¸¤ä¸ªæè¿°ç¬¦ï¼Œä¸€ä¸ªä¸ºè¯»ä¸€ä¸ªä¸ºå†™ï¼Œé»˜è®¤ä¸º8kçš„ç¼“å†²åŒºã€‚</p>
<p>å†…éƒ¨é‡‡ç”¨çš„æ˜¯å¾ªç¯é˜Ÿåˆ—ã€‚</p>
<p><img
        class="lazyload"
        src="/svg/loading.min.svg"
        data-src="/images/LinuxSystem/Untitled%2013.png"
        data-srcset="/images/LinuxSystem/Untitled%2013.png, /images/LinuxSystem/Untitled%2013.png 1.5x, /images/LinuxSystem/Untitled%2013.png 2x"
        data-sizes="auto"
        alt="/images/LinuxSystem/Untitled%2013.png"
        title="/images/LinuxSystem/Untitled%2013.png" /></p>
<p><img
        class="lazyload"
        src="/svg/loading.min.svg"
        data-src="/images/LinuxSystem/Untitled%2014.png"
        data-srcset="/images/LinuxSystem/Untitled%2014.png, /images/LinuxSystem/Untitled%2014.png 1.5x, /images/LinuxSystem/Untitled%2014.png 2x"
        data-sizes="auto"
        alt="/images/LinuxSystem/Untitled%2014.png"
        title="/images/LinuxSystem/Untitled%2014.png" /></p>
<p>è¿”å›ä¸¤ä¸ªæ–‡ä»¶æè¿°ç¬¦ï¼Œè¯»å’Œå†™ã€‚</p>
<h3 id="ç®€å•çš„ç®¡é“ç¤ºä¾‹">ç®€å•çš„ç®¡é“ç¤ºä¾‹ï¼š</h3>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span><span class="lnt">18
</span><span class="lnt">19
</span><span class="lnt">20
</span><span class="lnt">21
</span><span class="lnt">22
</span><span class="lnt">23
</span><span class="lnt">24
</span><span class="lnt">25
</span><span class="lnt">26
</span><span class="lnt">27
</span><span class="lnt">28
</span><span class="lnt">29
</span><span class="lnt">30
</span><span class="lnt">31
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-c" data-lang="c"><span class="cp">#include</span> <span class="cpf">&lt;stdio.h&gt;</span><span class="cp">
</span><span class="cp">#include</span> <span class="cpf">&lt;stdlib.h&gt;</span><span class="cp">
</span><span class="cp">#include</span> <span class="cpf">&lt;string.h&gt;</span><span class="cp">
</span><span class="cp">#include</span> <span class="cpf">&lt;unistd.h&gt;</span><span class="cp">
</span><span class="cp"></span>
<span class="kt">int</span> <span class="nf">pipeTest</span><span class="p">(){</span>
        <span class="kt">int</span> <span class="n">fd</span><span class="p">[</span><span class="mi">2</span><span class="p">];</span> <span class="c1">//ä¸¤ä¸ªæ–‡ä»¶æè¿°ç¬¦
</span><span class="c1"></span>        <span class="kt">int</span> <span class="n">ret</span> <span class="o">=</span> <span class="n">pipe</span><span class="p">(</span><span class="n">fd</span><span class="p">);</span>
        <span class="k">if</span><span class="p">(</span><span class="n">ret</span> <span class="o">==</span> <span class="o">-</span><span class="mi">1</span><span class="p">){</span>
                <span class="n">perror</span><span class="p">(</span><span class="s">&#34;pipe error:&#34;</span><span class="p">);</span>
                <span class="n">exit</span><span class="p">(</span><span class="mi">1</span><span class="p">);</span>
        <span class="p">}</span>
        <span class="n">pid_t</span> <span class="n">pid</span> <span class="o">=</span> <span class="n">fork</span><span class="p">();</span>
        <span class="k">if</span><span class="p">(</span><span class="n">pid</span> <span class="o">==</span> <span class="o">-</span><span class="mi">1</span><span class="p">){</span>
                <span class="n">perror</span><span class="p">(</span><span class="s">&#34;fork&#34;</span><span class="p">);</span>
                <span class="n">exit</span><span class="p">(</span><span class="mi">1</span><span class="p">);</span>
        <span class="p">}</span><span class="k">else</span> <span class="k">if</span><span class="p">(</span><span class="n">pid</span> <span class="o">==</span> <span class="mi">0</span><span class="p">){</span> <span class="c1">//child read
</span><span class="c1"></span>                <span class="n">close</span><span class="p">(</span><span class="n">fd</span><span class="p">[</span><span class="mi">1</span><span class="p">]);</span>
                <span class="kt">char</span> <span class="n">buf</span><span class="p">[</span><span class="mi">1024</span><span class="p">];</span>
                <span class="n">ret</span> <span class="o">=</span> <span class="n">read</span><span class="p">(</span><span class="n">fd</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">buf</span><span class="p">,</span> <span class="k">sizeof</span><span class="p">(</span><span class="n">buf</span><span class="p">));</span>
                <span class="k">if</span><span class="p">(</span><span class="n">ret</span> <span class="o">==</span> <span class="mi">0</span><span class="p">){</span>
                        <span class="n">printf</span><span class="p">(</span><span class="s">&#34;read done</span><span class="se">\n</span><span class="s">&#34;</span><span class="p">);</span>
                <span class="p">}</span>
                <span class="n">write</span><span class="p">(</span><span class="n">STDOUT_FILENO</span><span class="p">,</span> <span class="n">buf</span><span class="p">,</span> <span class="n">ret</span><span class="p">);</span>
        <span class="p">}</span><span class="k">else</span><span class="p">{</span> <span class="c1">//father write
</span><span class="c1"></span>                <span class="n">close</span><span class="p">(</span><span class="n">fd</span><span class="p">[</span><span class="mi">0</span><span class="p">]);</span>
                <span class="n">sleep</span><span class="p">(</span><span class="mi">1</span><span class="p">);</span>
                <span class="kt">char</span> <span class="o">*</span> <span class="n">str</span> <span class="o">=</span> <span class="s">&#34;hello pipe</span><span class="se">\n</span><span class="s">&#34;</span><span class="p">;</span>
                <span class="n">ret</span> <span class="o">=</span> <span class="n">write</span><span class="p">(</span><span class="n">fd</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="n">str</span><span class="p">,</span> <span class="n">strlen</span><span class="p">(</span><span class="n">str</span><span class="p">));</span>
        <span class="p">}</span>
<span class="p">}</span>
</code></pre></td></tr></table>
</div>
</div><h2 id="mmap-å…±äº«å†…å­˜">mmap å…±äº«å†…å­˜</h2>
<p><img
        class="lazyload"
        src="/svg/loading.min.svg"
        data-src="/images/LinuxSystem/Untitled%2015.png"
        data-srcset="/images/LinuxSystem/Untitled%2015.png, /images/LinuxSystem/Untitled%2015.png 1.5x, /images/LinuxSystem/Untitled%2015.png 2x"
        data-sizes="auto"
        alt="/images/LinuxSystem/Untitled%2015.png"
        title="/images/LinuxSystem/Untitled%2015.png" /></p>
<p>å€ŸåŠ©å…±äº«å†…å­˜å­˜æ”¾ç£ç›˜æ–‡ä»¶ã€‚è¿™æ ·å¯ä»¥é€šè¿‡æŒ‡é’ˆè®¿é—®ç£ç›˜æ–‡ä»¶ã€‚</p>
<ul>
<li>addrï¼šæ˜ å°„åŒºçš„é¦–åœ°å€ ï¼Œå†…æ ¸è‡ªåŠ¨æŒ‡å®šï¼ˆç›´æ¥ä¼ NULL)</li>
<li>lengthï¼šæ˜ å°„åŒºå¤§å°ï¼ˆæ–‡ä»¶å¤§å°ï¼‰</li>
<li>protï¼šæ˜ å°„åŒºçš„æƒé™
<ul>
<li>PROT_READ</li>
<li>PROT_WRITE</li>
<li>PROT_READ | PROTWRITE</li>
</ul>
</li>
<li>flagsï¼šæ ‡å¿—ä½å‚æ•°</li>
</ul>
<p>è¿”å›åˆ›å»ºæ˜ å°„åŒºçš„é¦–åœ°å€ã€‚å¤±è´¥æ—¶è¿”å›MAP_FIALEDã€‚</p>
<p><img
        class="lazyload"
        src="/svg/loading.min.svg"
        data-src="/images/LinuxSystem/Untitled%2016.png"
        data-srcset="/images/LinuxSystem/Untitled%2016.png, /images/LinuxSystem/Untitled%2016.png 1.5x, /images/LinuxSystem/Untitled%2016.png 2x"
        data-sizes="auto"
        alt="/images/LinuxSystem/Untitled%2016.png"
        title="/images/LinuxSystem/Untitled%2016.png" /></p>
<ul>
<li>fdï¼šæ–‡ä»¶æè¿°ç¬¦</li>
<li>offsetï¼šæ˜ å°„æ–‡ä»¶çš„åç§»ï¼ˆæˆªå–æ–‡ä»¶ä¸€éƒ¨åˆ†ï¼‰</li>
</ul>
<p><img
        class="lazyload"
        src="/svg/loading.min.svg"
        data-src="/images/LinuxSystem/Untitled%2017.png"
        data-srcset="/images/LinuxSystem/Untitled%2017.png, /images/LinuxSystem/Untitled%2017.png 1.5x, /images/LinuxSystem/Untitled%2017.png 2x"
        data-sizes="auto"
        alt="/images/LinuxSystem/Untitled%2017.png"
        title="/images/LinuxSystem/Untitled%2017.png" /></p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span><span class="lnt">18
</span><span class="lnt">19
</span><span class="lnt">20
</span><span class="lnt">21
</span><span class="lnt">22
</span><span class="lnt">23
</span><span class="lnt">24
</span><span class="lnt">25
</span><span class="lnt">26
</span><span class="lnt">27
</span><span class="lnt">28
</span><span class="lnt">29
</span><span class="lnt">30
</span><span class="lnt">31
</span><span class="lnt">32
</span><span class="lnt">33
</span><span class="lnt">34
</span><span class="lnt">35
</span><span class="lnt">36
</span><span class="lnt">37
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-c" data-lang="c"><span class="cp">#include</span><span class="cpf">&lt;stdio.h&gt;</span><span class="cp">
</span><span class="cp">#include</span><span class="cpf">&lt;sys/mman.h&gt;</span><span class="cp">
</span><span class="cp">#include</span><span class="cpf">&lt;stdlib.h&gt;</span><span class="cp">
</span><span class="cp">#include</span><span class="cpf">&lt;fcntl.h&gt;</span><span class="cp">
</span><span class="cp">#include</span><span class="cpf">&lt;string.h&gt;</span><span class="cp">
</span><span class="cp">#include</span><span class="cpf">&lt;unistd.h&gt;</span><span class="cp">
</span><span class="cp"></span>
<span class="kt">int</span> <span class="nf">mmapTest</span><span class="p">(){</span>
	<span class="kt">char</span><span class="o">*</span> <span class="n">p</span> <span class="o">=</span> <span class="nb">NULL</span><span class="p">;</span>
	<span class="kt">int</span> <span class="n">fd</span> <span class="o">=</span> <span class="n">open</span><span class="p">(</span><span class="s">&#34;text&#34;</span><span class="p">,</span> <span class="n">O_RDWR</span> <span class="o">|</span> <span class="n">O_CREAT</span><span class="p">,</span> <span class="mo">0644</span><span class="p">);</span>
	<span class="k">if</span><span class="p">(</span><span class="n">fd</span> <span class="o">&lt;</span> <span class="mi">0</span><span class="p">){</span>
		<span class="n">perror</span><span class="p">(</span><span class="s">&#34;open fail:&#34;</span><span class="p">);</span>
		<span class="n">exit</span><span class="p">(</span><span class="mi">1</span><span class="p">);</span>
	<span class="p">}</span>
	<span class="kt">int</span> <span class="n">len</span> <span class="o">=</span> <span class="mi">10</span><span class="p">;</span> <span class="c1">//size
</span><span class="c1"></span>	<span class="k">if</span><span class="p">(</span> <span class="n">ftruncate</span><span class="p">(</span><span class="n">fd</span><span class="p">,</span> <span class="n">len</span><span class="p">)</span> <span class="o">==</span> <span class="o">-</span><span class="mi">1</span><span class="p">){</span>
		<span class="n">perror</span><span class="p">(</span><span class="s">&#34;ftruncate&#34;</span><span class="p">);</span> <span class="c1">//æ‹“å±•æ–‡ä»¶
</span><span class="c1"></span>		<span class="n">exit</span><span class="p">(</span><span class="mi">1</span><span class="p">);</span>
	<span class="p">}</span>
	<span class="n">p</span> <span class="o">=</span> <span class="n">mmap</span><span class="p">(</span><span class="nb">NULL</span><span class="p">,</span> <span class="n">len</span><span class="p">,</span> <span class="n">PROT_READ</span> <span class="o">|</span> <span class="n">PROT_WRITE</span><span class="p">,</span> <span class="n">MAP_SHARED</span><span class="p">,</span> <span class="n">fd</span><span class="p">,</span> <span class="mi">0</span><span class="p">);</span>
       <span class="k">if</span><span class="p">(</span><span class="n">p</span> <span class="o">==</span> <span class="n">MAP_FAILED</span><span class="p">){</span>
	       <span class="n">perror</span><span class="p">(</span><span class="s">&#34;MAP FAILED&#34;</span><span class="p">);</span>
	       <span class="n">exit</span><span class="p">(</span><span class="mi">1</span><span class="p">);</span>
       <span class="p">}</span>       
       <span class="n">strcpy</span><span class="p">(</span><span class="n">p</span><span class="p">,</span> <span class="s">&#34;abc&#34;</span><span class="p">);</span> <span class="c1">//write to mmap
</span><span class="c1"></span>       <span class="kt">int</span> <span class="n">res</span> <span class="o">=</span> <span class="n">close</span><span class="p">(</span><span class="n">fd</span><span class="p">);</span>
	<span class="k">if</span><span class="p">(</span><span class="n">res</span> <span class="o">==</span> <span class="o">-</span><span class="mi">1</span><span class="p">){</span>
       		<span class="n">perror</span><span class="p">(</span><span class="s">&#34;close fail&#34;</span><span class="p">);</span>
		<span class="n">exit</span><span class="p">(</span><span class="mi">1</span><span class="p">);</span>
       <span class="p">}</span>
       <span class="n">res</span> <span class="o">=</span> <span class="n">munmap</span><span class="p">(</span><span class="n">p</span><span class="p">,</span> <span class="n">len</span><span class="p">);</span>
       <span class="k">if</span><span class="p">(</span><span class="n">res</span> <span class="o">==</span> <span class="o">-</span><span class="mi">1</span><span class="p">){</span>
       		<span class="n">perror</span><span class="p">(</span><span class="s">&#34;unmap fail&#34;</span><span class="p">);</span>
		<span class="n">exit</span><span class="p">(</span><span class="mi">1</span><span class="p">);</span>
       <span class="p">}</span>
       <span class="k">return</span> <span class="mi">0</span><span class="p">;</span>
<span class="p">}</span>
</code></pre></td></tr></table>
</div>
</div><p>æ³¨æ„äº‹é¡¹ï¼š</p>
<ul>
<li>ä¸èƒ½åˆ›å»ºä¸€ä¸ªå¤§å°ä¸º0çš„æ˜ å°„åŒºï¼ˆmallocå¯ä»¥ï¼‰</li>
<li>æ³¨æ„munmapé‡Šæ”¾çš„å¿…é¡»æ˜¯ä»¥å‰çš„é¦–æŒ‡é’ˆã€‚</li>
<li><strong>æ˜ å°„åŒºçš„æƒé™åº”å°äºç­‰äºå®é™…æ–‡ä»¶ã€‚</strong></li>
<li><strong>æ˜ å°„åŒºåˆ›å»ºçš„æ—¶å€™éœ€è¦è¯»å–æ–‡ä»¶æƒé™ã€‚</strong></li>
<li>offsetéœ€è¦4kçš„æ•´æ•°å€ï¼ˆä¸€ä¸ªé¡µçš„å¤§å°ï¼‰ã€‚  ****</li>
<li>æ–‡ä»¶æè¿°ç¬¦å¯ä»¥å…ˆå…³é—­ã€‚</li>
</ul>
<p><img
        class="lazyload"
        src="/svg/loading.min.svg"
        data-src="/images/LinuxSystem/Untitled%2018.png"
        data-srcset="/images/LinuxSystem/Untitled%2018.png, /images/LinuxSystem/Untitled%2018.png 1.5x, /images/LinuxSystem/Untitled%2018.png 2x"
        data-sizes="auto"
        alt="/images/LinuxSystem/Untitled%2018.png"
        title="/images/LinuxSystem/Untitled%2018.png" /></p>
<h3 id="mmap-çˆ¶å­ä¹‹é—´é€šä¿¡">mmap çˆ¶å­ä¹‹é—´é€šä¿¡</h3>
<p>å‚æ•°åº”è¯¥ä¸ºMAP_SHAREDã€‚</p>
<p><img
        class="lazyload"
        src="/svg/loading.min.svg"
        data-src="/images/LinuxSystem/Untitled%2019.png"
        data-srcset="/images/LinuxSystem/Untitled%2019.png, /images/LinuxSystem/Untitled%2019.png 1.5x, /images/LinuxSystem/Untitled%2019.png 2x"
        data-sizes="auto"
        alt="/images/LinuxSystem/Untitled%2019.png"
        title="/images/LinuxSystem/Untitled%2019.png" /></p>
<p><strong>æ— è¡€ç¼˜ä¹Ÿç›¸ä¼¼</strong>ï¼Œåªè¦å¯¹åŒä¸€ä¸ªæ–‡ä»¶è°ƒç”¨mmapå°±è¡Œã€‚</p>
<p>è¯»å†™ä¸¤è¾¹éƒ½munmap()ã€‚</p>
<p>æŠŠæ˜ å°„åŒºå½“æ•°ç»„çœ‹å¾…ã€‚</p>
<h3 id="mmapåŒ¿åæ˜ å°„">mmapåŒ¿åæ˜ å°„</h3>
<p>ç¬¬ä¸‰ä¸ªå‚æ•°ä½æˆ–<code>MAP_ANONYMOUS(MAP_ANON)</code>ã€‚æ­¤æ—¶æ–‡ä»¶æè¿°ç¬¦å¡«-1ã€‚æ³¨æ„ä»…åœ¨Linuxä¸‹æœ‰ï¼Œç±»Unixä¸‹æ— ã€‚</p>
<p>ç±»Unixä¸‹ï¼Œåº”è¯¥æ‰“å¼€/dev/zeroæ–‡ä»¶æ¥ä»£æ›¿ã€‚</p>
<p><img
        class="lazyload"
        src="/svg/loading.min.svg"
        data-src="/images/LinuxSystem/Untitled%2020.png"
        data-srcset="/images/LinuxSystem/Untitled%2020.png, /images/LinuxSystem/Untitled%2020.png 1.5x, /images/LinuxSystem/Untitled%2020.png 2x"
        data-sizes="auto"
        alt="/images/LinuxSystem/Untitled%2020.png"
        title="/images/LinuxSystem/Untitled%2020.png" /></p>
<p>fifoå’ŒåŒ¿åæ˜ å°„çš„åŒºåˆ«ï¼šfifoä¸å¯ä»¥é‡å¤è¯»ã€‚</p>
<h3 id="straceå‘½ä»¤">straceå‘½ä»¤</h3>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-c" data-lang="c"><span class="n">strace</span> <span class="n">binfile</span>
</code></pre></td></tr></table>
</div>
</div><p>å¯ä»¥æŸ¥çœ‹ç¨‹åºè°ƒç”¨çš„èµ„æºã€‚</p>
<h2 id="é˜¶æ®µæ€§ç»ƒä¹ ">é˜¶æ®µæ€§ç»ƒä¹ </h2>
<p><a href="https://www.notion.so/Linux-13d606ad446947b8a677217dc9a41b3e" target="_blank" rel="noopener noreffer">Linuxç³»ç»Ÿç¼–ç¨‹-å®è·µç»ƒä¹ </a></p>
<h3 id="å¤šæ–‡ä»¶æ‹·è´">å¤šæ–‡ä»¶æ‹·è´</h3>
<p>å®ç°æ–¹æ³•ï¼šæ–‡ä»¶åˆ†æˆå¤šä»½ï¼Œè®©å¤šä¸ªè¿›ç¨‹å»å¤åˆ¶å„ä¸ªéƒ¨åˆ†ã€‚</p>
<h3 id="ç®€å•-shell">ç®€å• shell</h3>
<p><img
        class="lazyload"
        src="/svg/loading.min.svg"
        data-src="/images/LinuxSystem/Untitled%2021.png"
        data-srcset="/images/LinuxSystem/Untitled%2021.png, /images/LinuxSystem/Untitled%2021.png 1.5x, /images/LinuxSystem/Untitled%2021.png 2x"
        data-sizes="auto"
        alt="/images/LinuxSystem/Untitled%2021.png"
        title="/images/LinuxSystem/Untitled%2021.png" /></p>
<p><img
        class="lazyload"
        src="/svg/loading.min.svg"
        data-src="/images/LinuxSystem/Untitled%2022.png"
        data-srcset="/images/LinuxSystem/Untitled%2022.png, /images/LinuxSystem/Untitled%2022.png 1.5x, /images/LinuxSystem/Untitled%2022.png 2x"
        data-sizes="auto"
        alt="/images/LinuxSystem/Untitled%2022.png"
        title="/images/LinuxSystem/Untitled%2022.png" /></p>
<h3 id="æœ¬åœ°èŠå¤©å®¤åŠŸèƒ½">æœ¬åœ°èŠå¤©å®¤åŠŸèƒ½</h3>
<p><img
        class="lazyload"
        src="/svg/loading.min.svg"
        data-src="/images/LinuxSystem/Untitled%2023.png"
        data-srcset="/images/LinuxSystem/Untitled%2023.png, /images/LinuxSystem/Untitled%2023.png 1.5x, /images/LinuxSystem/Untitled%2023.png 2x"
        data-sizes="auto"
        alt="/images/LinuxSystem/Untitled%2023.png"
        title="/images/LinuxSystem/Untitled%2023.png" /></p>
<p><img
        class="lazyload"
        src="/svg/loading.min.svg"
        data-src="/images/LinuxSystem/Untitled%2024.png"
        data-srcset="/images/LinuxSystem/Untitled%2024.png, /images/LinuxSystem/Untitled%2024.png 1.5x, /images/LinuxSystem/Untitled%2024.png 2x"
        data-sizes="auto"
        alt="/images/LinuxSystem/Untitled%2024.png"
        title="/images/LinuxSystem/Untitled%2024.png" /></p>
<p>ä½¿ç”¨fcntl()å‡½æ•°æŠŠè¾“å…¥æ”¹é€ ä¸ºéé˜»å¡çš„ã€‚</p>
<p><a href="https://www.cnblogs.com/zhangxuan/p/6306326.html" target="_blank" rel="noopener noreffer">Linux fcntlå‡½æ•°è®¾ç½®é˜»å¡ä¸éé˜»å¡</a></p>
<h1 id="ä¿¡å·">ä¿¡å·</h1>
<p><strong>åŒºåˆ«äºä¿¡å·é‡ã€‚</strong></p>
<p>ç®€å•ï¼Œä¸èƒ½æºå¸¦å¤§é‡ä¿¡æ¯ï¼Œæ»¡è¶³æŸä¸ªæ¡ä»¶æ‰ä¼šå‘é€ã€‚</p>
<p>å‘é€é€šè¿‡<strong>å†…æ ¸</strong>ã€‚ç¨‹åºæ”¶åˆ°ä¿¡å·åä¼šåœæ­¢ä¸‹æ¥å¤„ç†ä¿¡å·ï¼ˆç±»ä¼¼äºæ—¶é’Ÿä¸­æ–­ï¼‰ã€‚ä½†æ˜¯æ˜¯é€šè¿‡è½¯ä»¶æ¥å®ç°ï¼Œä¹Ÿç§°ä¸ºè½¯ä¸­æ–­ã€‚</p>
<p>è½¯ä¸­æ–­çš„å»¶æ—¶éå¸¸å¤§ï¼Œä½†æ˜¯å¯¹äºç”¨æˆ·æ¥è¯´ä¸æ˜“å¯Ÿè§‰ã€‚CPUå¯ä»¥å¯Ÿè§‰ã€‚</p>
<p>å››è¦ç´ ï¼š</p>
<ul>
<li>ç¼–å·</li>
<li>åç§°</li>
<li>äº‹ä»¶</li>
<li>é»˜è®¤å¤„ç†åŠ¨ä½œ</li>
</ul>
<h2 id="ä¿¡å·çš„ä¼ è¾“è¿‡ç¨‹">ä¿¡å·çš„ä¼ è¾“è¿‡ç¨‹</h2>
<p><img
        class="lazyload"
        src="/svg/loading.min.svg"
        data-src="/images/LinuxSystem/Untitled%2025.png"
        data-srcset="/images/LinuxSystem/Untitled%2025.png, /images/LinuxSystem/Untitled%2025.png 1.5x, /images/LinuxSystem/Untitled%2025.png 2x"
        data-sizes="auto"
        alt="/images/LinuxSystem/Untitled%2025.png"
        title="/images/LinuxSystem/Untitled%2025.png" /></p>
<p>æœªå†³ä¿¡å·é›†ä»£è¡¨äº†æœªå¤„å†³çš„ä¿¡å·ã€‚</p>
<p><img
        class="lazyload"
        src="/svg/loading.min.svg"
        data-src="/images/LinuxSystem/Untitled%2026.png"
        data-srcset="/images/LinuxSystem/Untitled%2026.png, /images/LinuxSystem/Untitled%2026.png 1.5x, /images/LinuxSystem/Untitled%2026.png 2x"
        data-sizes="auto"
        alt="/images/LinuxSystem/Untitled%2026.png"
        title="/images/LinuxSystem/Untitled%2026.png" /></p>
<p>é˜»å¡ä¿¡å·é›†ï¼ˆä¿¡å·å±è”½å­—ï¼‰ä»£è¡¨äº†å¤„äºé˜»å¡æ€çš„ä¿¡å·ã€‚</p>
<p>ä¸¤è€…éƒ½å¤„äºPCBä¸­ã€‚éƒ½æ˜¯setã€‚</p>
<p><img
        class="lazyload"
        src="/svg/loading.min.svg"
        data-src="/images/LinuxSystem/Untitled%2027.png"
        data-srcset="/images/LinuxSystem/Untitled%2027.png, /images/LinuxSystem/Untitled%2027.png 1.5x, /images/LinuxSystem/Untitled%2027.png 2x"
        data-sizes="auto"
        alt="/images/LinuxSystem/Untitled%2027.png"
        title="/images/LinuxSystem/Untitled%2027.png" /></p>
<p>å½“ä¿¡å·å±è”½å­—ä¸º1æ—¶ï¼Œè¯¥ä½çš„ä¿¡å·å°†ä¼šä¿ç•™ä¸‹æ¥ï¼Œä¸èƒ½è¢«å¤„ç†ã€‚</p>
<p><strong>ä¿¡å·çš„å¤„ç†åŠ¨ä½œï¼š</strong></p>
<ul>
<li>é»˜è®¤å¤„ç†åŠ¨ä½œ</li>
<li>å¿½ç•¥ï¼ˆä¸¢å¼ƒï¼‰</li>
<li>æ•æ‰ï¼ˆæ•æ‰åè°ƒç”¨ç”¨æˆ·å¤„ç†å‡½æ•°ï¼ˆå‘é€æ–¹ï¼‰ï¼‰</li>
</ul>
<p><img
        class="lazyload"
        src="/svg/loading.min.svg"
        data-src="/images/LinuxSystem/Untitled%2028.png"
        data-srcset="/images/LinuxSystem/Untitled%2028.png, /images/LinuxSystem/Untitled%2028.png 1.5x, /images/LinuxSystem/Untitled%2028.png 2x"
        data-sizes="auto"
        alt="/images/LinuxSystem/Untitled%2028.png"
        title="/images/LinuxSystem/Untitled%2028.png" /></p>
<p><img
        class="lazyload"
        src="/svg/loading.min.svg"
        data-src="/images/LinuxSystem/Untitled%2029.png"
        data-srcset="/images/LinuxSystem/Untitled%2029.png, /images/LinuxSystem/Untitled%2029.png 1.5x, /images/LinuxSystem/Untitled%2029.png 2x"
        data-sizes="auto"
        alt="/images/LinuxSystem/Untitled%2029.png"
        title="/images/LinuxSystem/Untitled%2029.png" /></p>
<p>ä¿¡å·ç¼–å·ï¼škill -l    man 7 signal</p>
<p><img
        class="lazyload"
        src="/svg/loading.min.svg"
        data-src="/images/LinuxSystem/Untitled%2030.png"
        data-srcset="/images/LinuxSystem/Untitled%2030.png, /images/LinuxSystem/Untitled%2030.png 1.5x, /images/LinuxSystem/Untitled%2030.png 2x"
        data-sizes="auto"
        alt="/images/LinuxSystem/Untitled%2030.png"
        title="/images/LinuxSystem/Untitled%2030.png" /></p>
<p>9å’Œ19å·ä¸å…è®¸è¢«æ•æ‰æˆ–é˜»å¡ã€‚</p>
<h2 id="ä¿¡å·çš„äº§ç”Ÿ">ä¿¡å·çš„äº§ç”Ÿ</h2>
<p>äº§ç”Ÿæ–¹æ³•ï¼š</p>
<ul>
<li>æŒ‰é”®
<ul>
<li>Ctrl + c ï¼š 2ï¼‰SIGINTï¼ˆç»ˆæ­¢ï¼‰ Interrupt</li>
<li>Ctrl + zï¼š 20ï¼‰SIGTSTOPï¼ˆç»ˆç«¯ç¨‹åºæš‚åœï¼‰ Stop</li>
<li>Ctrl + \ï¼š 3ï¼‰SIGQUITï¼ˆé€€å‡ºï¼‰ Quit</li>
</ul>
</li>
<li>ç³»ç»Ÿè°ƒç”¨</li>
<li>è½¯ä»¶</li>
<li>ç¡¬ä»¶å¼‚å¸¸
<ul>
<li>/0  (8)SIGFPEï¼ˆæµ®ç‚¹æ•°ä¾‹å¤–ï¼‰</li>
<li>éæ³•è®¿é—®å†…å­˜ (11)SIGSEGV(æ®µé”™è¯¯ï¼‰</li>
<li>æ€»çº¿é”™è¯¯ ï¼ˆ7ï¼‰SIGBUS</li>
</ul>
</li>
<li>å‘½ä»¤è°ƒç”¨
<ul>
<li>killl  <code>kill -19 pid</code> å‘é€19ä¿¡å·</li>
<li>alarm</li>
<li>setitimerï¼Œ</li>
</ul>
</li>
</ul>
<h3 id="kill-å‡½æ•°">kill å‡½æ•°</h3>
<p><img
        class="lazyload"
        src="/svg/loading.min.svg"
        data-src="/images/LinuxSystem/Untitled%2031.png"
        data-srcset="/images/LinuxSystem/Untitled%2031.png, /images/LinuxSystem/Untitled%2031.png 1.5x, /images/LinuxSystem/Untitled%2031.png 2x"
        data-sizes="auto"
        alt="/images/LinuxSystem/Untitled%2031.png"
        title="/images/LinuxSystem/Untitled%2031.png" /></p>
<h3 id="raise-ä¸-abort-å‡½æ•°">raise ä¸ abort å‡½æ•°</h3>
<p><img
        class="lazyload"
        src="/svg/loading.min.svg"
        data-src="/images/LinuxSystem/Untitled%2032.png"
        data-srcset="/images/LinuxSystem/Untitled%2032.png, /images/LinuxSystem/Untitled%2032.png 1.5x, /images/LinuxSystem/Untitled%2032.png 2x"
        data-sizes="auto"
        alt="/images/LinuxSystem/Untitled%2032.png"
        title="/images/LinuxSystem/Untitled%2032.png" /></p>
<h3 id="alarm-å‡½æ•°">alarm å‡½æ•°</h3>
<p>æ¯ä¸ªè¿›ç¨‹åªæœ‰ä¸€ä¸ªå®šæ—¶å™¨ã€‚</p>
<p>æŒ‡å®šéœ€è¦çš„secondåï¼Œå†…æ ¸ä¼šç»™å½“å‰è¿›ç¨‹å‘é€ï¼ˆ14ï¼‰SIGALRMï¼Œé»˜è®¤è¡Œä¸ºä¸ºç»ˆæ­¢è¿›ç¨‹ã€‚</p>
<p><strong>è¿”å›å€¼ä¸ºä¸Šä¸€æ¬¡alarmçš„å‰©ä½™æ—¶é—´</strong>ã€‚</p>
<p><img
        class="lazyload"
        src="/svg/loading.min.svg"
        data-src="/images/LinuxSystem/Untitled%2033.png"
        data-srcset="/images/LinuxSystem/Untitled%2033.png, /images/LinuxSystem/Untitled%2033.png 1.5x, /images/LinuxSystem/Untitled%2033.png 2x"
        data-sizes="auto"
        alt="/images/LinuxSystem/Untitled%2033.png"
        title="/images/LinuxSystem/Untitled%2033.png" /></p>
<p>å¦å¤–å¯ä»¥time ./appæŸ¥çœ‹è¿è¡Œæ—¶é—´ã€‚</p>
<h3 id="setitimer">setitimer</h3>
<p>å¯ä»¥å–ä»£alarmï¼Œç²¾ç¡®åˆ°å¾®ç§’ï¼Œä¹Ÿå¯ä»¥å‘¨æœŸæ€§å®šæ—¶ã€‚</p>
<p><img
        class="lazyload"
        src="/svg/loading.min.svg"
        data-src="/images/LinuxSystem/Untitled%2034.png"
        data-srcset="/images/LinuxSystem/Untitled%2034.png, /images/LinuxSystem/Untitled%2034.png 1.5x, /images/LinuxSystem/Untitled%2034.png 2x"
        data-sizes="auto"
        alt="/images/LinuxSystem/Untitled%2034.png"
        title="/images/LinuxSystem/Untitled%2034.png" /></p>
<p>whichå‡½æ•°ä»£è¡¨å¦‚ä½•å®šæ—¶ï¼ˆè‡ªç„¶å®šæ—¶è¿˜æ˜¯ç”¨æˆ·ç©ºé—´è¿˜æ˜¯ç”¨æˆ·åŠ å†…æ ¸ï¼‰ã€‚</p>
<p><img
        class="lazyload"
        src="/svg/loading.min.svg"
        data-src="/images/LinuxSystem/Untitled%2035.png"
        data-srcset="/images/LinuxSystem/Untitled%2035.png, /images/LinuxSystem/Untitled%2035.png 1.5x, /images/LinuxSystem/Untitled%2035.png 2x"
        data-sizes="auto"
        alt="/images/LinuxSystem/Untitled%2035.png"
        title="/images/LinuxSystem/Untitled%2035.png" /></p>
<p>ç»“æ„ä½“çœ‹man pageã€‚</p>
<h2 id="ä¿¡å·é›†æ“ä½œ">ä¿¡å·é›†æ“ä½œ</h2>
<h3 id="ä¿¡å·é›†è®¾å®š">ä¿¡å·é›†è®¾å®š</h3>
<p>sigset_t ä½¿ç”¨unsigned longæ„æˆçš„setï¼ˆ8å­—èŠ‚ï¼‰ã€‚</p>
<p><img
        class="lazyload"
        src="/svg/loading.min.svg"
        data-src="/images/LinuxSystem/Untitled%2036.png"
        data-srcset="/images/LinuxSystem/Untitled%2036.png, /images/LinuxSystem/Untitled%2036.png 1.5x, /images/LinuxSystem/Untitled%2036.png 2x"
        data-sizes="auto"
        alt="/images/LinuxSystem/Untitled%2036.png"
        title="/images/LinuxSystem/Untitled%2036.png" /></p>
<h3 id="sigprocmask-å‡½æ•°">sigprocmask å‡½æ•°</h3>
<p>æŠŠè‡ªå®šä¹‰çš„ä¿¡å·setå¯¼å…¥åˆ°é˜»å¡é›†ã€‚</p>
<p><img
        class="lazyload"
        src="/svg/loading.min.svg"
        data-src="/images/LinuxSystem/Untitled%2037.png"
        data-srcset="/images/LinuxSystem/Untitled%2037.png, /images/LinuxSystem/Untitled%2037.png 1.5x, /images/LinuxSystem/Untitled%2037.png 2x"
        data-sizes="auto"
        alt="/images/LinuxSystem/Untitled%2037.png"
        title="/images/LinuxSystem/Untitled%2037.png" /></p>
<p><img
        class="lazyload"
        src="/svg/loading.min.svg"
        data-src="/images/LinuxSystem/Untitled%2038.png"
        data-srcset="/images/LinuxSystem/Untitled%2038.png, /images/LinuxSystem/Untitled%2038.png 1.5x, /images/LinuxSystem/Untitled%2038.png 2x"
        data-sizes="auto"
        alt="/images/LinuxSystem/Untitled%2038.png"
        title="/images/LinuxSystem/Untitled%2038.png" /></p>
<h3 id="sigpending-å‡½æ•°">sigpending å‡½æ•°</h3>
<p>è¯»å–å½“å‰è¿›ç¨‹çš„æœªå†³ä¿¡å·é›†ã€‚</p>
<p><img
        class="lazyload"
        src="/svg/loading.min.svg"
        data-src="/images/LinuxSystem/Untitled%2039.png"
        data-srcset="/images/LinuxSystem/Untitled%2039.png, /images/LinuxSystem/Untitled%2039.png 1.5x, /images/LinuxSystem/Untitled%2039.png 2x"
        data-sizes="auto"
        alt="/images/LinuxSystem/Untitled%2039.png"
        title="/images/LinuxSystem/Untitled%2039.png" /></p>
<h3 id="ç¤ºä¾‹æ‰“å°æœªå†³ä¿¡å·é›†">ç¤ºä¾‹ï¼šæ‰“å°æœªå†³ä¿¡å·é›†</h3>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span><span class="lnt">18
</span><span class="lnt">19
</span><span class="lnt">20
</span><span class="lnt">21
</span><span class="lnt">22
</span><span class="lnt">23
</span><span class="lnt">24
</span><span class="lnt">25
</span><span class="lnt">26
</span><span class="lnt">27
</span><span class="lnt">28
</span><span class="lnt">29
</span><span class="lnt">30
</span><span class="lnt">31
</span><span class="lnt">32
</span><span class="lnt">33
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-c" data-lang="c"><span class="cp">#include</span> <span class="cpf">&lt;stdio.h&gt;</span><span class="cp">
</span><span class="cp">#include</span> <span class="cpf">&lt;unistd.h&gt;</span><span class="cp">
</span><span class="cp">#include</span><span class="cpf">&lt;signal.h&gt;</span><span class="cp">
</span><span class="cp">#include</span> <span class="cpf">&lt;stdlib.h&gt;</span><span class="cp">
</span><span class="cp"></span>
<span class="kt">void</span> <span class="nf">printsig</span><span class="p">(</span><span class="n">sigset_t</span> <span class="o">*</span><span class="n">set</span><span class="p">){</span>
        <span class="k">for</span><span class="p">(</span><span class="kt">int</span> <span class="n">i</span> <span class="o">=</span> <span class="mi">1</span><span class="p">;</span> <span class="n">i</span> <span class="o">&lt;</span> <span class="mi">32</span><span class="p">;</span> <span class="n">i</span><span class="o">++</span><span class="p">){</span>
                <span class="n">printf</span><span class="p">(</span><span class="s">&#34;%d&#34;</span><span class="p">,</span> <span class="n">sigismember</span><span class="p">(</span><span class="n">set</span><span class="p">,</span> <span class="n">i</span><span class="p">));</span>
        <span class="p">}</span><span class="n">printf</span><span class="p">(</span><span class="s">&#34;</span><span class="se">\n</span><span class="s">&#34;</span><span class="p">);</span>
<span class="p">}</span>

<span class="kt">int</span> <span class="nf">main</span><span class="p">()</span>
<span class="p">{</span>
        <span class="n">sigset_t</span> <span class="n">myset</span><span class="p">,</span> <span class="n">oldset</span><span class="p">,</span> <span class="n">pend</span><span class="p">;</span>

        <span class="n">sigemptyset</span><span class="p">(</span><span class="o">&amp;</span><span class="n">myset</span><span class="p">);</span>
        <span class="n">sigaddset</span><span class="p">(</span><span class="o">&amp;</span><span class="n">myset</span><span class="p">,</span> <span class="n">SIGQUIT</span><span class="p">);</span>
        <span class="kt">int</span> <span class="n">res</span> <span class="o">=</span> <span class="n">sigprocmask</span><span class="p">(</span><span class="n">SIG_BLOCK</span><span class="p">,</span> <span class="o">&amp;</span><span class="n">myset</span><span class="p">,</span> <span class="o">&amp;</span><span class="n">oldset</span><span class="p">);</span>
        <span class="k">if</span><span class="p">(</span><span class="n">res</span> <span class="o">==</span> <span class="o">-</span><span class="mi">1</span><span class="p">){</span>
                <span class="n">perror</span><span class="p">(</span><span class="s">&#34;sig error&#34;</span><span class="p">);</span>
                <span class="n">exit</span><span class="p">(</span><span class="mi">1</span><span class="p">);</span>
        <span class="p">}</span>

        <span class="n">sigpending</span><span class="p">(</span><span class="o">&amp;</span><span class="n">pend</span><span class="p">);</span>
        <span class="n">printsig</span><span class="p">(</span><span class="o">&amp;</span><span class="n">pend</span><span class="p">);</span>
        <span class="n">raise</span><span class="p">(</span><span class="n">SIGQUIT</span><span class="p">);</span>
        <span class="n">sigpending</span><span class="p">(</span><span class="o">&amp;</span><span class="n">pend</span><span class="p">);</span>
        <span class="k">while</span><span class="p">(</span><span class="mi">1</span><span class="p">){</span>
                <span class="n">sleep</span><span class="p">(</span><span class="mi">1</span><span class="p">);</span>
                <span class="n">printsig</span><span class="p">(</span><span class="o">&amp;</span><span class="n">pend</span><span class="p">);</span>
        <span class="p">}</span>
        <span class="k">return</span> <span class="mi">0</span><span class="p">;</span>
<span class="p">}</span>
</code></pre></td></tr></table>
</div>
</div><h2 id="ä¿¡å·çš„æ•æ‰">ä¿¡å·çš„æ•æ‰</h2>
<h3 id="signal-å‡½æ•°">signal å‡½æ•°</h3>
<p>ä½¿ç”¨signalå‡½æ•°å¯ä»¥æ•æ‰åˆ°ä¿¡å·ï¼Œè°ƒç”¨è‡ªå®šä¹‰çš„å¤„ç†å‡½æ•°ã€‚</p>
<p><img
        class="lazyload"
        src="/svg/loading.min.svg"
        data-src="/images/LinuxSystem/Untitled%2040.png"
        data-srcset="/images/LinuxSystem/Untitled%2040.png, /images/LinuxSystem/Untitled%2040.png 1.5x, /images/LinuxSystem/Untitled%2040.png 2x"
        data-sizes="auto"
        alt="/images/LinuxSystem/Untitled%2040.png"
        title="/images/LinuxSystem/Untitled%2040.png" /></p>
<h3 id="sigaction-å‡½æ•°">sigaction å‡½æ•°</h3>
<p><img
        class="lazyload"
        src="/svg/loading.min.svg"
        data-src="/images/LinuxSystem/Untitled%2041.png"
        data-srcset="/images/LinuxSystem/Untitled%2041.png, /images/LinuxSystem/Untitled%2041.png 1.5x, /images/LinuxSystem/Untitled%2041.png 2x"
        data-sizes="auto"
        alt="/images/LinuxSystem/Untitled%2041.png"
        title="/images/LinuxSystem/Untitled%2041.png" /></p>
<p>å…¶ä¸­sigactionç»“æ„ä¸º</p>
<p><img
        class="lazyload"
        src="/svg/loading.min.svg"
        data-src="/images/LinuxSystem/Untitled%2042.png"
        data-srcset="/images/LinuxSystem/Untitled%2042.png, /images/LinuxSystem/Untitled%2042.png 1.5x, /images/LinuxSystem/Untitled%2042.png 2x"
        data-sizes="auto"
        alt="/images/LinuxSystem/Untitled%2042.png"
        title="/images/LinuxSystem/Untitled%2042.png" /></p>
<p>ç¬¬äºŒä¸ªå‚æ•°ä¸ç®¡ã€‚</p>
<p>sigset_t å®šä¹‰handlerè¿è¡ŒæœŸé—´çš„ä¿¡å·å±è”½å­—ã€‚</p>
<p>sa_flags 0æ—¶ä¸ºé»˜è®¤ã€‚</p>
<p><img
        class="lazyload"
        src="/svg/loading.min.svg"
        data-src="/images/LinuxSystem/Untitled%2043.png"
        data-srcset="/images/LinuxSystem/Untitled%2043.png, /images/LinuxSystem/Untitled%2043.png 1.5x, /images/LinuxSystem/Untitled%2043.png 2x"
        data-sizes="auto"
        alt="/images/LinuxSystem/Untitled%2043.png"
        title="/images/LinuxSystem/Untitled%2043.png" /></p>
<p><img
        class="lazyload"
        src="/svg/loading.min.svg"
        data-src="/images/LinuxSystem/Untitled%2044.png"
        data-srcset="/images/LinuxSystem/Untitled%2044.png, /images/LinuxSystem/Untitled%2044.png 1.5x, /images/LinuxSystem/Untitled%2044.png 2x"
        data-sizes="auto"
        alt="/images/LinuxSystem/Untitled%2044.png"
        title="/images/LinuxSystem/Untitled%2044.png" /></p>
<h3 id="æ•æ‰åŸç†">æ•æ‰åŸç†</h3>
<p><img
        class="lazyload"
        src="/svg/loading.min.svg"
        data-src="/images/LinuxSystem/Untitled%2045.png"
        data-srcset="/images/LinuxSystem/Untitled%2045.png, /images/LinuxSystem/Untitled%2045.png 1.5x, /images/LinuxSystem/Untitled%2045.png 2x"
        data-sizes="auto"
        alt="/images/LinuxSystem/Untitled%2045.png"
        title="/images/LinuxSystem/Untitled%2045.png" /></p>
<h1 id="ç«æ€æ¡ä»¶">ç«æ€æ¡ä»¶</h1>
<h2 id="pauseå‡½æ•°">pauseå‡½æ•°ï¼š</h2>
<p>å¯ä»¥é€ æˆè¿›ç¨‹ä¸»åŠ¨æŒ‚èµ·ï¼Œç­‰å¾…ä¿¡å·å”¤é†’ã€‚æ³¨æ„å…ˆè¦å¯¹ä¿¡å·è¿›è¡Œæ•æ‰ã€‚</p>
<p><img
        class="lazyload"
        src="/svg/loading.min.svg"
        data-src="/images/LinuxSystem/Untitled%2046.png"
        data-srcset="/images/LinuxSystem/Untitled%2046.png, /images/LinuxSystem/Untitled%2046.png 1.5x, /images/LinuxSystem/Untitled%2046.png 2x"
        data-sizes="auto"
        alt="/images/LinuxSystem/Untitled%2046.png"
        title="/images/LinuxSystem/Untitled%2046.png" /></p>
<p>æ³¨æ„è¿™é‡Œè¿”å›çš„æ˜¯-1ã€‚</p>
<p><strong>ä½¿ç”¨sigactionå’Œpauseå®ç°sleepï¼š</strong></p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span><span class="lnt">18
</span><span class="lnt">19
</span><span class="lnt">20
</span><span class="lnt">21
</span><span class="lnt">22
</span><span class="lnt">23
</span><span class="lnt">24
</span><span class="lnt">25
</span><span class="lnt">26
</span><span class="lnt">27
</span><span class="lnt">28
</span><span class="lnt">29
</span><span class="lnt">30
</span><span class="lnt">31
</span><span class="lnt">32
</span><span class="lnt">33
</span><span class="lnt">34
</span><span class="lnt">35
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-c" data-lang="c"><span class="cp">#include</span> <span class="cpf">&lt;stdio.h&gt;</span><span class="cp">
</span><span class="cp">#include</span> <span class="cpf">&lt;errno.h&gt;</span><span class="cp">
</span><span class="cp">#include</span> <span class="cpf">&lt;stdlib.h&gt;</span><span class="cp">
</span><span class="cp">#include</span> <span class="cpf">&lt;unistd.h&gt;</span><span class="cp">
</span><span class="cp">#include</span> <span class="cpf">&lt;signal.h&gt;</span><span class="cp">
</span><span class="cp"></span>
<span class="kt">void</span> <span class="nf">catchSignal</span><span class="p">(</span><span class="kt">int</span> <span class="n">signo</span><span class="p">){</span>
	<span class="p">;</span>
<span class="p">}</span>

<span class="kt">int</span> <span class="nf">mySleep</span><span class="p">(</span><span class="kt">unsigned</span> <span class="kt">int</span> <span class="n">seconds</span><span class="p">){</span>
	<span class="k">struct</span> <span class="n">sigaction</span> <span class="n">act</span><span class="p">,</span> <span class="n">oldact</span><span class="p">;</span>
	<span class="n">act</span><span class="p">.</span><span class="n">sa_handler</span> <span class="o">=</span> <span class="n">catchSignal</span><span class="p">;</span>
	<span class="n">sigemptyset</span><span class="p">(</span><span class="o">&amp;</span><span class="n">act</span><span class="p">.</span><span class="n">sa_mask</span><span class="p">);</span>
	<span class="n">act</span><span class="p">.</span><span class="n">sa_flags</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>

	<span class="kt">int</span> <span class="n">ret</span> <span class="o">=</span> <span class="n">sigaction</span><span class="p">(</span><span class="n">SIGALRM</span><span class="p">,</span> <span class="o">&amp;</span><span class="n">act</span><span class="p">,</span> <span class="o">&amp;</span><span class="n">oldact</span><span class="p">);</span>
	<span class="k">if</span><span class="p">(</span><span class="n">ret</span> <span class="o">==</span> <span class="o">-</span><span class="mi">1</span><span class="p">){</span>
		<span class="n">perror</span><span class="p">(</span><span class="s">&#34;sigaction&#34;</span><span class="p">);</span>
		<span class="n">exit</span><span class="p">(</span><span class="mi">1</span><span class="p">);</span>
	<span class="p">}</span>
	<span class="n">alarm</span><span class="p">(</span><span class="n">seconds</span><span class="p">);</span>
	<span class="n">ret</span> <span class="o">=</span> <span class="n">pause</span><span class="p">();</span>
	<span class="k">if</span><span class="p">(</span><span class="n">ret</span> <span class="o">==</span> <span class="o">-</span><span class="mi">1</span> <span class="o">&amp;&amp;</span> <span class="n">errno</span> <span class="o">==</span> <span class="n">EINTR</span><span class="p">){</span>
		<span class="n">printf</span><span class="p">(</span><span class="s">&#34;signal caught!</span><span class="se">\n</span><span class="s">&#34;</span><span class="p">);</span>
	<span class="p">}</span>

	<span class="n">ret</span> <span class="o">=</span> <span class="n">alarm</span><span class="p">(</span><span class="mi">0</span><span class="p">);</span>
	<span class="n">sigaction</span><span class="p">(</span><span class="n">SIGALRM</span><span class="p">,</span> <span class="o">&amp;</span><span class="n">oldact</span><span class="p">,</span> <span class="nb">NULL</span><span class="p">);</span>
	<span class="k">return</span> <span class="n">ret</span><span class="p">;</span>
<span class="p">}</span>

<span class="kt">int</span> <span class="nf">main</span><span class="p">(){</span>
	<span class="k">while</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span><span class="n">mySleep</span><span class="p">(</span><span class="mi">1</span><span class="p">);</span>
<span class="p">}</span>
</code></pre></td></tr></table>
</div>
</div><h2 id="æ—¶åºç«æ€">æ—¶åºç«æ€</h2>
<h3 id="ä¸€ä¸ªä¼šå‡ºé—®é¢˜çš„ä¾‹å­">ä¸€ä¸ªä¼šå‡ºé—®é¢˜çš„ä¾‹å­</h3>
<p><img
        class="lazyload"
        src="/svg/loading.min.svg"
        data-src="/images/LinuxSystem/Untitled%2047.png"
        data-srcset="/images/LinuxSystem/Untitled%2047.png, /images/LinuxSystem/Untitled%2047.png 1.5x, /images/LinuxSystem/Untitled%2047.png 2x"
        data-sizes="auto"
        alt="/images/LinuxSystem/Untitled%2047.png"
        title="/images/LinuxSystem/Untitled%2047.png" /></p>
<p>è‹¥CPUå¤±å»æ—¶é—´å¤ªé•¿ï¼Œpauseå°†æ°¸è¿œä¸ä¼šè¢«å”¤é†’ã€‚</p>
<h3 id="sigsuspend-å‡½æ•°">sigsuspend å‡½æ•°</h3>
<p><img
        class="lazyload"
        src="/svg/loading.min.svg"
        data-src="/images/LinuxSystem/Untitled%2048.png"
        data-srcset="/images/LinuxSystem/Untitled%2048.png, /images/LinuxSystem/Untitled%2048.png 1.5x, /images/LinuxSystem/Untitled%2048.png 2x"
        data-sizes="auto"
        alt="/images/LinuxSystem/Untitled%2048.png"
        title="/images/LinuxSystem/Untitled%2048.png" /></p>
<p>ç›¸å½“äºå¸¦æœ‰ä¿¡å·å±è”½å­—çš„pauseå‡½æ•°ï¼Œå¯ä»¥è§£å†³ä»¥ä¸Šé—®é¢˜ã€‚ï¼ˆåŸå­æ“ä½œï¼‰</p>
<p><img
        class="lazyload"
        src="/svg/loading.min.svg"
        data-src="/images/LinuxSystem/Untitled%2049.png"
        data-srcset="/images/LinuxSystem/Untitled%2049.png, /images/LinuxSystem/Untitled%2049.png 1.5x, /images/LinuxSystem/Untitled%2049.png 2x"
        data-sizes="auto"
        alt="/images/LinuxSystem/Untitled%2049.png"
        title="/images/LinuxSystem/Untitled%2049.png" /></p>
<p>æµç¨‹ï¼š</p>
<ul>
<li>æ³¨å†ŒSIGALRMå¤„ç†å‡½æ•°</li>
<li>é˜»å¡SIGALRM</li>
<li>alarmâ†’sigsuspendã€è§£é™¤é˜»å¡SIGALRMâ†’pauseâ†’ç»§ç»­é˜»å¡SIGALRMã€‘</li>
<li>è§£é™¤SIGALRMå¤„ç†å‡½æ•°</li>
<li>è§£é™¤é˜»å¡SIGALRMã€‚</li>
</ul>
<p>è¿™æ ·å¯ä»¥è§£å†³pauseçš„æ—¶åºé—®é¢˜ã€‚</p>
<h3 id="å…¨å±€å˜é‡å¼‚æ­¥ioé—®é¢˜">å…¨å±€å˜é‡å¼‚æ­¥IOé—®é¢˜</h3>
<p>çˆ¶å­è¿›ç¨‹ä¹‹é—´äº¤æ›¿æ•°æ•°ç¨‹åºã€‚è¿è¡Œä¸€æ®µæ—¶é—´åä¸¤è€…éƒ½æ°¸ä¹…ç­‰å¾…ã€‚</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span><span class="lnt">18
</span><span class="lnt">19
</span><span class="lnt">20
</span><span class="lnt">21
</span><span class="lnt">22
</span><span class="lnt">23
</span><span class="lnt">24
</span><span class="lnt">25
</span><span class="lnt">26
</span><span class="lnt">27
</span><span class="lnt">28
</span><span class="lnt">29
</span><span class="lnt">30
</span><span class="lnt">31
</span><span class="lnt">32
</span><span class="lnt">33
</span><span class="lnt">34
</span><span class="lnt">35
</span><span class="lnt">36
</span><span class="lnt">37
</span><span class="lnt">38
</span><span class="lnt">39
</span><span class="lnt">40
</span><span class="lnt">41
</span><span class="lnt">42
</span><span class="lnt">43
</span><span class="lnt">44
</span><span class="lnt">45
</span><span class="lnt">46
</span><span class="lnt">47
</span><span class="lnt">48
</span><span class="lnt">49
</span><span class="lnt">50
</span><span class="lnt">51
</span><span class="lnt">52
</span><span class="lnt">53
</span><span class="lnt">54
</span><span class="lnt">55
</span><span class="lnt">56
</span><span class="lnt">57
</span><span class="lnt">58
</span><span class="lnt">59
</span><span class="lnt">60
</span><span class="lnt">61
</span><span class="lnt">62
</span><span class="lnt">63
</span><span class="lnt">64
</span><span class="lnt">65
</span><span class="lnt">66
</span><span class="lnt">67
</span><span class="lnt">68
</span><span class="lnt">69
</span><span class="lnt">70
</span><span class="lnt">71
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-c" data-lang="c"><span class="cp">#include</span> <span class="cpf">&lt;stdio.h&gt;</span><span class="cp">
</span><span class="cp">#include</span> <span class="cpf">&lt;signal.h&gt;</span><span class="cp">
</span><span class="cp">#include</span> <span class="cpf">&lt;unistd.h&gt;</span><span class="cp">
</span><span class="cp">#include</span> <span class="cpf">&lt;stdlib.h&gt;</span><span class="cp">
</span><span class="cp"></span>
<span class="kt">int</span> <span class="n">n</span> <span class="o">=</span> <span class="mi">0</span><span class="p">,</span> <span class="n">flag</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>  <span class="c1">//å®šä¹‰ä¸¤ä¸ªå…¨å±€å˜é‡ï¼ˆæ³¨æ„äº†ï¼‰
</span><span class="c1"></span> 
<span class="kt">void</span> <span class="nf">sys_err</span><span class="p">(</span><span class="kt">char</span> <span class="o">*</span><span class="n">str</span><span class="p">)</span>
<span class="p">{</span>
    <span class="n">perror</span><span class="p">(</span><span class="n">str</span><span class="p">);</span>
    <span class="n">exit</span><span class="p">(</span><span class="mi">1</span><span class="p">);</span>
<span class="p">}</span>
 
<span class="kt">void</span> <span class="nf">do_sig_child</span><span class="p">(</span><span class="kt">int</span> <span class="n">num</span><span class="p">)</span>  <span class="c1">//å­è¿›ç¨‹çš„ç”¨æˆ·å¤„ç†å‡½æ•°
</span><span class="c1"></span><span class="p">{</span>
    <span class="n">printf</span><span class="p">(</span><span class="s">&#34;I am child  %d</span><span class="se">\t</span><span class="s">%d</span><span class="se">\n</span><span class="s">&#34;</span><span class="p">,</span> <span class="n">getpid</span><span class="p">(),</span> <span class="n">n</span><span class="p">);</span>
    <span class="n">n</span> <span class="o">+=</span> <span class="mi">2</span><span class="p">;</span>
    <span class="n">flag</span> <span class="o">=</span> <span class="mi">1</span><span class="p">;</span>  <span class="c1">//å¯¹å…¨å±€å˜é‡çš„ä¿®æ”¹
</span><span class="c1"></span><span class="p">}</span>
 
<span class="kt">void</span> <span class="nf">do_sig_parent</span><span class="p">(</span><span class="kt">int</span> <span class="n">num</span><span class="p">)</span>   <span class="c1">//çˆ¶è¿›ç¨‹çš„ç”¨æˆ·å¤„ç†å‡½æ•°
</span><span class="c1"></span><span class="p">{</span>
    <span class="n">printf</span><span class="p">(</span><span class="s">&#34;I am parent %d</span><span class="se">\t</span><span class="s">%d</span><span class="se">\n</span><span class="s">&#34;</span><span class="p">,</span> <span class="n">getpid</span><span class="p">(),</span> <span class="n">n</span><span class="p">);</span>
    <span class="n">n</span> <span class="o">+=</span> <span class="mi">2</span><span class="p">;</span>
    <span class="n">flag</span> <span class="o">=</span> <span class="mi">1</span><span class="p">;</span>  <span class="c1">//å¯¹å…¨å±€å˜é‡çš„ä¿®æ”¹
</span><span class="c1"></span><span class="p">}</span>
 
<span class="kt">int</span> <span class="nf">main</span><span class="p">(</span><span class="kt">void</span><span class="p">)</span>
<span class="p">{</span>
    <span class="n">pid_t</span> <span class="n">pid</span><span class="p">;</span>
    <span class="k">struct</span> <span class="n">sigaction</span> <span class="n">act</span><span class="p">;</span>
 
    <span class="k">if</span> <span class="p">((</span><span class="n">pid</span> <span class="o">=</span> <span class="n">fork</span><span class="p">())</span> <span class="o">&lt;</span> <span class="mi">0</span><span class="p">)</span>
        <span class="n">sys_err</span><span class="p">(</span><span class="s">&#34;fork&#34;</span><span class="p">);</span>
 
    <span class="k">else</span> <span class="k">if</span> <span class="p">(</span><span class="n">pid</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">)</span> <span class="p">{</span>
        <span class="n">n</span> <span class="o">=</span> <span class="mi">1</span><span class="p">;</span>          <span class="c1">//çˆ¶è¿›ç¨‹ä»1å¼€å§‹æ•°
</span><span class="c1"></span>        <span class="n">sleep</span><span class="p">(</span><span class="mi">1</span><span class="p">);</span>       <span class="c1">//çˆ¶è¿›ç¨‹ç¡çœ 1sç¡®ä¿åœ¨çˆ¶è¿›ç¨‹å‘å­è¿›ç¨‹å‘ä¿¡å·ä¹‹å‰ï¼Œå­è¿›ç¨‹å®Œæˆäº†å¯¹ä¿¡å·çš„æ³¨å†Œ
</span><span class="c1"></span>        <span class="n">act</span><span class="p">.</span><span class="n">sa_handler</span> <span class="o">=</span> <span class="n">do_sig_parent</span><span class="p">;</span>
        <span class="n">sigemptyset</span><span class="p">(</span><span class="o">&amp;</span><span class="n">act</span><span class="p">.</span><span class="n">sa_mask</span><span class="p">);</span>
        <span class="n">act</span><span class="p">.</span><span class="n">sa_flags</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>
        <span class="n">sigaction</span><span class="p">(</span><span class="n">SIGUSR2</span><span class="p">,</span> <span class="o">&amp;</span><span class="n">act</span><span class="p">,</span> <span class="nb">NULL</span><span class="p">);</span>             <span class="c1">//æ³¨å†Œè‡ªå·±çš„ä¿¡å·æ•æ‰å‡½æ•°ï¼Œçˆ¶è¿›ç¨‹ä½¿ç”¨SIGUSR2ä¿¡å·
</span><span class="c1"></span> 
        <span class="n">do_sig_parent</span><span class="p">(</span><span class="mi">0</span><span class="p">);</span>   <span class="c1">//çˆ¶è¿›ç¨‹å…ˆè¿›è¡Œæ•°æ•°ï¼Œä»1å¼€å§‹
</span><span class="c1"></span> 
        <span class="k">while</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span> <span class="p">{</span>
            <span class="cm">/* wait for signal */</span><span class="p">;</span>
           <span class="k">if</span> <span class="p">(</span><span class="n">flag</span> <span class="o">==</span> <span class="mi">1</span><span class="p">)</span> <span class="p">{</span>                         <span class="c1">//çˆ¶è¿›ç¨‹æ•°æ•°å®Œæˆ
</span><span class="c1"></span>                <span class="n">kill</span><span class="p">(</span><span class="n">pid</span><span class="p">,</span> <span class="n">SIGUSR1</span><span class="p">);</span>
                <span class="n">flag</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>                        <span class="c1">//æ ‡å¿—å·²ç»ç»™å­è¿›ç¨‹å‘é€å®Œä¿¡å·
</span><span class="c1"></span>            <span class="p">}</span>
        <span class="p">}</span>
 
    <span class="p">}</span> <span class="k">else</span> <span class="k">if</span> <span class="p">(</span><span class="n">pid</span> <span class="o">==</span> <span class="mi">0</span><span class="p">){</span>
        <span class="n">n</span> <span class="o">=</span> <span class="mi">2</span><span class="p">;</span>      <span class="c1">//å­è¿›ç¨‹ä»2å¼€å§‹æ•°
</span><span class="c1"></span>        <span class="n">act</span><span class="p">.</span><span class="n">sa_handler</span> <span class="o">=</span> <span class="n">do_sig_child</span><span class="p">;</span>
        <span class="n">sigemptyset</span><span class="p">(</span><span class="o">&amp;</span><span class="n">act</span><span class="p">.</span><span class="n">sa_mask</span><span class="p">);</span>
        <span class="n">act</span><span class="p">.</span><span class="n">sa_flags</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>
        <span class="n">sigaction</span><span class="p">(</span><span class="n">SIGUSR1</span><span class="p">,</span> <span class="o">&amp;</span><span class="n">act</span><span class="p">,</span> <span class="nb">NULL</span><span class="p">);</span>
 
        <span class="k">while</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span> <span class="p">{</span>
            <span class="cm">/* wait for signal */</span><span class="p">;</span>
            <span class="k">if</span> <span class="p">(</span><span class="n">flag</span> <span class="o">==</span> <span class="mi">1</span><span class="p">)</span> <span class="p">{</span>
                <span class="n">kill</span><span class="p">(</span><span class="n">getppid</span><span class="p">(),</span> <span class="n">SIGUSR2</span><span class="p">);</span>
                <span class="n">flag</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>
            <span class="p">}</span>
        <span class="p">}</span>
    <span class="p">}</span>
 
    <span class="k">return</span> <span class="mi">0</span><span class="p">;</span>
<span class="p">}</span>
</code></pre></td></tr></table>
</div>
</div><p>é—®é¢˜åœ¨äºflagçš„ä¿®æ”¹ï¼Œè‹¥æŸä¸€è¿›ç¨‹ä¿®æ”¹ä¸åŠæ—¶ï¼Œå¦ä¸€è¿›ç¨‹å·²ç»å‘é€äº†ä¿¡å·ï¼Œé‚£ä¹ˆå°±ä¼šå¯¼è‡´åŸè¿›ç¨‹åœ¨æ‰§è¡Œå®Œä¿¡å·åæ‰ä¿®æ”¹flagä¸º0ï¼Œé‚£ä¹ˆä¸¤è€…å°±ä¼šæ­»é”ã€‚</p>
<p>è¿™é‡Œçš„å…¨å±€æ˜¯åŸç¨‹åºå’Œå†…æ ¸å›è°ƒå‡½æ•°çš„å¹¶è¡Œã€‚</p>
<p>æ”¹è¿›æ–¹æ³•ï¼šç›´æ¥ä¸ä½¿ç”¨flagï¼ŒæŠŠä¿¡å·å‘é€æ”¾åˆ°å›è°ƒå‡½æ•°é‡Œé¢ã€‚</p>
<h3 id="å¯é‡å…¥å‡½æ•°">å¯é‡å…¥å‡½æ•°</h3>
<p><img
        class="lazyload"
        src="/svg/loading.min.svg"
        data-src="/images/LinuxSystem/Untitled%2050.png"
        data-srcset="/images/LinuxSystem/Untitled%2050.png, /images/LinuxSystem/Untitled%2050.png 1.5x, /images/LinuxSystem/Untitled%2050.png 2x"
        data-sizes="auto"
        alt="/images/LinuxSystem/Untitled%2050.png"
        title="/images/LinuxSystem/Untitled%2050.png" /></p>
<p>æ˜¾ç„¶è¿™ä¸ªæ˜¯ä¸å¯é‡å…¥çš„å‡½æ•°ï¼Œä¸»è¦åŸå› æ˜¯ä½¿ç”¨äº†å…¨å±€å˜é‡ã€‚</p>
<p>æ³¨æ„äº‹é¡¹ï¼š</p>
<ul>
<li>å¯é‡å…¥å‡½æ•°ä¸èƒ½æœ‰å…¨å±€å˜é‡ä»¥åŠstaticå˜é‡ã€‚ä¸èƒ½æœ‰mallocå’Œfreeã€‚</li>
<li>ä¿¡å·æ•æ‰å‡½æ•°åº”è¯¥è®¾è®¡ä¸ºå¯é‡å…¥å‡½æ•°ã€‚</li>
<li>ä¿¡å·å¤„ç†ç¨‹åºå¯ä»¥è°ƒç”¨çš„å¯é‡å…¥å‡½æ•°å¯ä»¥å‚é˜…man 7 signal.</li>
<li>æ²¡æœ‰åœ¨ä»¥ä¸Šåˆ—è¡¨ä¸­çš„å‡½æ•°å¤§å¤šæ˜¯ä¸å¯é‡å…¥çš„ã€‚
<ul>
<li>é™æ€æ•°æ®ç»“æ„</li>
<li>è°ƒç”¨äº†mallocå’Œfree</li>
<li>æ˜¯æ ‡å‡†çš„IOå‡½æ•°</li>
</ul>
</li>
</ul>
<h2 id="sigchldå›æ”¶å­è¿›ç¨‹">SIGCHLDå›æ”¶å­è¿›ç¨‹</h2>
<p><img
        class="lazyload"
        src="/svg/loading.min.svg"
        data-src="/images/LinuxSystem/Untitled%2051.png"
        data-srcset="/images/LinuxSystem/Untitled%2051.png, /images/LinuxSystem/Untitled%2051.png 1.5x, /images/LinuxSystem/Untitled%2051.png 2x"
        data-sizes="auto"
        alt="/images/LinuxSystem/Untitled%2051.png"
        title="/images/LinuxSystem/Untitled%2051.png" /></p>
<p>å¯¹çˆ¶è¿›ç¨‹å‘é€ä¿¡å·ã€‚å¯ä»¥åˆ©ç”¨SIGCHLDä¿¡å·å›æ”¶å­è¿›ç¨‹ã€‚</p>
<p>ä¸ºäº†é¿å…ä¿¡å·çš„è¦†ç›–ï¼Œéœ€è¦åœ¨å›æ”¶å‡½æ•°é‡Œé¢ä½¿ç”¨whileæ¥å¤„ç†æ‰€æœ‰çš„å­è¿›ç¨‹ã€‚</p>
<p><img
        class="lazyload"
        src="/svg/loading.min.svg"
        data-src="/images/LinuxSystem/Untitled%2052.png"
        data-srcset="/images/LinuxSystem/Untitled%2052.png, /images/LinuxSystem/Untitled%2052.png 1.5x, /images/LinuxSystem/Untitled%2052.png 2x"
        data-sizes="auto"
        alt="/images/LinuxSystem/Untitled%2052.png"
        title="/images/LinuxSystem/Untitled%2052.png" /></p>
<p>è¿™é‡Œä½¿ç”¨ifæ—¶ï¼Œä¼šä½¿å¾—ä¸€äº›è¿›ç¨‹æ²¡æœ‰å›æ”¶ã€‚</p>
<h2 id="ä¿¡å·ä¼ å‚">ä¿¡å·ä¼ å‚</h2>
<h3 id="å‘é€å‚æ•°">å‘é€å‚æ•°</h3>
<p>sigqueueå‡½æ•°å¯¹åº”killå‡½æ•°ï¼Œå¯ä»¥åœ¨å‘é€ä¿¡å·çš„åŒæ—¶æºå¸¦å‚æ•°ã€‚</p>
<p><img
        class="lazyload"
        src="/svg/loading.min.svg"
        data-src="/images/LinuxSystem/Untitled%2053.png"
        data-srcset="/images/LinuxSystem/Untitled%2053.png, /images/LinuxSystem/Untitled%2053.png 1.5x, /images/LinuxSystem/Untitled%2053.png 2x"
        data-sizes="auto"
        alt="/images/LinuxSystem/Untitled%2053.png"
        title="/images/LinuxSystem/Untitled%2053.png" /></p>
<p>ä½†æ˜¯æ³¨æ„ä¼ åœ°å€æ—¶ï¼Œæ¯ä¸ªè¿›ç¨‹çš„è™šæ‹Ÿåœ°å€ç©ºé—´ç‹¬ç«‹ï¼ŒæŠŠè™šæ‹Ÿåœ°å€ä¼ åˆ°å¦ä¸€è¿›ç¨‹æ²¡æœ‰å®é™…æ„ä¹‰ã€‚</p>
<h3 id="æ¥æ”¶å‚æ•°">æ¥æ”¶å‚æ•°</h3>
<p><img
        class="lazyload"
        src="/svg/loading.min.svg"
        data-src="/images/LinuxSystem/Untitled%2054.png"
        data-srcset="/images/LinuxSystem/Untitled%2054.png, /images/LinuxSystem/Untitled%2054.png 1.5x, /images/LinuxSystem/Untitled%2054.png 2x"
        data-sizes="auto"
        alt="/images/LinuxSystem/Untitled%2054.png"
        title="/images/LinuxSystem/Untitled%2054.png" /></p>
<h2 id="ä¸­æ–­ç³»ç»Ÿè°ƒç”¨">ä¸­æ–­ç³»ç»Ÿè°ƒç”¨</h2>
<p>ç³»ç»Ÿè°ƒç”¨ï¼š</p>
<ul>
<li>æ…¢é€Ÿç³»ç»Ÿè°ƒç”¨ï¼šå¯èƒ½ä¼šä½¿å¾—æœ¬è¿›ç¨‹æ°¸ä¹…é˜»å¡ã€‚å¦‚pauseã€waitã€waitpidã€read</li>
<li>å…¶ä»–ç³»ç»Ÿè°ƒç”¨ã€‚</li>
</ul>
<p>å¯¹äºæ…¢é€Ÿç³»ç»Ÿè°ƒç”¨ï¼Œè¢«ä¿¡å·æ‰“æ–­åï¼ŒæŒ‰éœ€æ±‚å¸Œæœ›æ¢å¤æ“ä½œæˆ–è€…è·³è¿‡æ“ä½œï¼ˆreadå’Œpauseï¼‰ã€‚</p>
<p><img
        class="lazyload"
        src="/svg/loading.min.svg"
        data-src="/images/LinuxSystem/Untitled%2055.png"
        data-srcset="/images/LinuxSystem/Untitled%2055.png, /images/LinuxSystem/Untitled%2055.png 1.5x, /images/LinuxSystem/Untitled%2055.png 2x"
        data-sizes="auto"
        alt="/images/LinuxSystem/Untitled%2055.png"
        title="/images/LinuxSystem/Untitled%2055.png" /></p>
<p>å‘é€ä¿¡å·æ—¶ï¼Œsa_flagså‚æ•°å¯ä»¥è®¾ç½®æ˜¯å¦è¢«ä¿¡å·ä¸­æ–­åé‡å¯ã€‚ä¹Ÿå¯ä»¥è®¾ç½®è¯¥ä¿¡å·ä¸è‡ªåŠ¨è¢«å±è”½ã€‚</p>
<h1 id="ç»ˆç«¯è¿›ç¨‹ç»„ä¼šè¯å®ˆæŠ¤è¿›ç¨‹">ç»ˆç«¯ã€è¿›ç¨‹ç»„ã€ä¼šè¯ã€å®ˆæŠ¤è¿›ç¨‹</h1>
<h2 id="ç»ˆç«¯">ç»ˆç«¯</h2>
<p>æ˜¯æ‰€æœ‰è¾“å…¥è¾“å‡ºè®¾å¤‡çš„æ€»ç§°ã€‚æ‰€æœ‰çš„è¿›ç¨‹éƒ½æœ‰ä¸€ä¸ªçˆ¶è¿›ç¨‹initã€‚æ¯ä¸ªè¿›ç¨‹éƒ½å¯ä»¥é€šè¿‡/dev/ttyè®¿é—®å®ƒçš„æ§åˆ¶ç»ˆç«¯ã€‚</p>
<h3 id="å¯åŠ¨æµç¨‹">å¯åŠ¨æµç¨‹</h3>
<p><img
        class="lazyload"
        src="/svg/loading.min.svg"
        data-src="/images/LinuxSystem/Untitled%2056.png"
        data-srcset="/images/LinuxSystem/Untitled%2056.png, /images/LinuxSystem/Untitled%2056.png 1.5x, /images/LinuxSystem/Untitled%2056.png 2x"
        data-sizes="auto"
        alt="/images/LinuxSystem/Untitled%2056.png"
        title="/images/LinuxSystem/Untitled%2056.png" /></p>
<p>çº¿è·¯è§„ç¨‹åƒä¸€ä¸ªè¿‡æ»¤å™¨ï¼Œå¯¹æŸäº›å­—ç¬¦è¿›è¡Œç‰¹æ®Šå¤„ç†ã€‚å¦‚ctrl+cä¼šè¢«çº¿è·¯è§„ç¨‹æˆªè·ï¼Œè€Œä¸æ˜¯è¯»åˆ°readä¸­ã€‚</p>
<p><img
        class="lazyload"
        src="/svg/loading.min.svg"
        data-src="/images/LinuxSystem/Untitled%2057.png"
        data-srcset="/images/LinuxSystem/Untitled%2057.png, /images/LinuxSystem/Untitled%2057.png 1.5x, /images/LinuxSystem/Untitled%2057.png 2x"
        data-sizes="auto"
        alt="/images/LinuxSystem/Untitled%2057.png"
        title="/images/LinuxSystem/Untitled%2057.png" /></p>
<h3 id="ttynameå‡½æ•°">ttynameå‡½æ•°</h3>
<p>å€ŸåŠ©ttynameå‡½æ•°å¯ä»¥çœ‹åˆ°ä¸åŒç»ˆç«¯å¯¹åº”çš„è®¾å¤‡æ–‡ä»¶åã€‚</p>
<h3 id="ç½‘ç»œç»ˆç«¯">ç½‘ç»œç»ˆç«¯</h3>
<p><img
        class="lazyload"
        src="/svg/loading.min.svg"
        data-src="/images/LinuxSystem/Untitled%2058.png"
        data-srcset="/images/LinuxSystem/Untitled%2058.png, /images/LinuxSystem/Untitled%2058.png 1.5x, /images/LinuxSystem/Untitled%2058.png 2x"
        data-sizes="auto"
        alt="/images/LinuxSystem/Untitled%2058.png"
        title="/images/LinuxSystem/Untitled%2058.png" /></p>
<h2 id="è¿›ç¨‹ç»„-ps-ajx">è¿›ç¨‹ç»„ ps ajx</h2>
<p>ä½œä¸šå°±æ˜¯è¿›ç¨‹ç»„ï¼Œä»£è¡¨ä¸€ä¸ªæˆ–å¤šä¸ªè¿›ç¨‹çš„é›†åˆã€‚</p>
<p>å½“çˆ¶è¿›ç¨‹åˆ›å»ºå­è¿›ç¨‹ï¼Œé»˜è®¤å­è¿›ç¨‹ä¸çˆ¶è¿›ç¨‹ä¸ºåŒä¸€ä¸ªç»„ï¼Œç»„IDä¸ºçˆ¶è¿›ç¨‹çš„IDï¼ˆç»„é•¿ï¼‰ã€‚</p>
<p><img
        class="lazyload"
        src="/svg/loading.min.svg"
        data-src="/images/LinuxSystem/Untitled%2059.png"
        data-srcset="/images/LinuxSystem/Untitled%2059.png, /images/LinuxSystem/Untitled%2059.png 1.5x, /images/LinuxSystem/Untitled%2059.png 2x"
        data-sizes="auto"
        alt="/images/LinuxSystem/Untitled%2059.png"
        title="/images/LinuxSystem/Untitled%2059.png" /></p>
<h3 id="getpgrp-è·å–è¿›ç¨‹ç»„id">getpgrp è·å–è¿›ç¨‹ç»„ID</h3>
<h3 id="getpgid-è·å–æŒ‡å®šè¿›ç¨‹çš„è¿›ç¨‹ç»„id">getpgid è·å–æŒ‡å®šè¿›ç¨‹çš„è¿›ç¨‹ç»„id</h3>
<h3 id="setpgid-è®¾å®šæŒ‡å®šè¿›ç¨‹çš„è¿›ç¨‹ç»„id">setpgid è®¾å®šæŒ‡å®šè¿›ç¨‹çš„è¿›ç¨‹ç»„id</h3>
<p>æ³¨æ„érootè¿›ç¨‹åªèƒ½æ”¹å˜è‡ªå·±çš„å­è¿›ç¨‹ã€‚</p>
<h2 id="ä¼šè¯">ä¼šè¯</h2>
<p>ä¸€ç»„è¿›ç¨‹ç»„å¯ä»¥ç¼–å·æˆä¸€ä¸ªä¼šè¯ã€‚</p>
<h3 id="åˆ›å»ºä¼šè¯">åˆ›å»ºä¼šè¯</h3>
<p><img
        class="lazyload"
        src="/svg/loading.min.svg"
        data-src="/images/LinuxSystem/Untitled%2060.png"
        data-srcset="/images/LinuxSystem/Untitled%2060.png, /images/LinuxSystem/Untitled%2060.png 1.5x, /images/LinuxSystem/Untitled%2060.png 2x"
        data-sizes="auto"
        alt="/images/LinuxSystem/Untitled%2060.png"
        title="/images/LinuxSystem/Untitled%2060.png" /></p>
<h3 id="getsid-æŸ¥çœ‹ä¼šè¯id">getsid æŸ¥çœ‹ä¼šè¯id</h3>
<h3 id="setsid-è®¾ç½®ä¼šè¯id">setsid è®¾ç½®ä¼šè¯id</h3>
<p>ä¼šè¯å¯ä»¥åšå®ˆæŠ¤è¿›ç¨‹ã€‚</p>
<h2 id="å®ˆæŠ¤è¿›ç¨‹">å®ˆæŠ¤è¿›ç¨‹</h2>
<p>Daemonè¿›ç¨‹ï¼Œæ˜¯Linuxä¸­çš„åå°æœåŠ¡è¿›ç¨‹ï¼Œé€šå¸¸ç‹¬ç«‹äºæ§åˆ¶ç»ˆç«¯ä¸”å‘¨æœŸæ€§æ‰§è¡ŒæŸç§ä»»åŠ¡æˆ–ç­‰å¾…æŸä¸ªäº‹ä»¶ã€‚é€šå¸¸ä»¥dç»“å°¾ï¼ˆhttpdã€sshdï¼‰ã€‚ä¸”ä¸å—ç”¨æˆ·ç™»å½•é€€å‡ºçš„å½±å“ã€‚</p>
<p>æœ€å…³é”®çš„ä¸€æ­¥ï¼šä½¿ç”¨setsidåˆ›å»ºä¸€ä¸ªæ–°çš„sessionï¼Œå¹¶æˆä¸ºsession leaderã€‚</p>
<h3 id="åˆ›å»ºæ–¹å¼">åˆ›å»ºæ–¹å¼</h3>
<ul>
<li>
<p>åˆ›å»ºå­è¿›ç¨‹ï¼Œçˆ¶è¿›ç¨‹é€€å‡º fork</p>
</li>
<li>
<p>åœ¨å­è¿›ç¨‹ä¸­åˆ›å»ºæ–°ä¼šè¯ setsid</p>
</li>
<li>
<p>è®¾ç½®å½“å‰ç›®å½•ä¸ºæ ¹ç›®å½•ï¼ˆé˜²æ­¢è¢«å¸è½½ï¼‰ chdir</p>
</li>
<li>
<p>é‡è®¾æ–‡ä»¶æƒé™æ©ç  umaskå‡½æ•°ï¼ˆé˜²æ­¢ç»§æ‰¿çš„æ–‡ä»¶åˆ›å»ºå±è”½å­—æ‹’ç»æŸäº›æƒé™ï¼‰</p>
</li>
<li>
<p>å…³é—­æ–‡ä»¶æè¿°ç¬¦ï¼ˆä¸è¦æµªè´¹ç³»ç»Ÿèµ„æºï¼‰</p>
<p>é€šå¸¸é‡å®šå‘åˆ°/dev/null   dup2()</p>
</li>
<li>
<p>å¼€å§‹å®ˆæŠ¤æ ¸å¿ƒå·¥ä½œ</p>
</li>
<li>
<p>å®ˆæŠ¤è¿›ç¨‹é€€å‡ºæ¨¡å‹ï¼ˆå¾ˆå°‘ç”¨åˆ°ï¼‰</p>
</li>
</ul>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span><span class="lnt">18
</span><span class="lnt">19
</span><span class="lnt">20
</span><span class="lnt">21
</span><span class="lnt">22
</span><span class="lnt">23
</span><span class="lnt">24
</span><span class="lnt">25
</span><span class="lnt">26
</span><span class="lnt">27
</span><span class="lnt">28
</span><span class="lnt">29
</span><span class="lnt">30
</span><span class="lnt">31
</span><span class="lnt">32
</span><span class="lnt">33
</span><span class="lnt">34
</span><span class="lnt">35
</span><span class="lnt">36
</span><span class="lnt">37
</span><span class="lnt">38
</span><span class="lnt">39
</span><span class="lnt">40
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-c" data-lang="c"><span class="cp">#include</span><span class="cpf">&lt;stdio.h&gt;</span><span class="cp">
</span><span class="cp">#include</span> <span class="cpf">&lt;unistd.h&gt;</span><span class="cp">
</span><span class="cp">#include</span> <span class="cpf">&lt;sys/types.h&gt;</span><span class="cp">
</span><span class="cp">#include</span> <span class="cpf">&lt;sys/stat.h&gt;</span><span class="cp">
</span><span class="cp">#include</span> <span class="cpf">&lt;fcntl.h&gt;</span><span class="cp">
</span><span class="cp">#include</span> <span class="cpf">&lt;stdlib.h&gt;</span><span class="cp">
</span><span class="cp"></span>
<span class="kt">int</span> <span class="nf">main</span><span class="p">()</span>
<span class="p">{</span>
	<span class="n">pid_t</span> <span class="n">pid</span><span class="p">,</span> <span class="n">spid</span><span class="p">;</span>

	<span class="n">pid</span> <span class="o">=</span> <span class="n">fork</span><span class="p">();</span>
	<span class="k">if</span><span class="p">(</span><span class="n">pid</span> <span class="o">==</span> <span class="mi">0</span><span class="p">)</span> <span class="c1">//child
</span><span class="c1"></span>	<span class="p">{</span>
		<span class="n">spid</span> <span class="o">=</span> <span class="n">setsid</span><span class="p">();</span>
		<span class="kt">int</span> <span class="n">ret</span> <span class="o">=</span> <span class="n">chdir</span><span class="p">(</span><span class="s">&#34;/home/hongwei&#34;</span><span class="p">);</span>
		<span class="k">if</span><span class="p">(</span><span class="n">ret</span> <span class="o">==</span> <span class="o">-</span><span class="mi">1</span><span class="p">){</span>
			<span class="n">perror</span><span class="p">(</span><span class="s">&#34;chdir&#34;</span><span class="p">);</span>
			<span class="n">exit</span><span class="p">(</span><span class="mi">1</span><span class="p">);</span>
		<span class="p">}</span>
		<span class="n">umask</span><span class="p">(</span><span class="mo">0002</span><span class="p">);</span>
		
		<span class="n">close</span><span class="p">(</span><span class="n">STDIN_FILENO</span><span class="p">);</span>
		<span class="kt">int</span> <span class="n">fd</span> <span class="o">=</span> <span class="n">open</span><span class="p">(</span><span class="s">&#34;/dev/null&#34;</span><span class="p">,</span> <span class="n">O_RDWR</span><span class="p">);</span>
		<span class="k">if</span><span class="p">(</span><span class="n">fd</span> <span class="o">&lt;</span> <span class="mi">0</span><span class="p">){</span>
			<span class="n">perror</span><span class="p">(</span><span class="s">&#34;open&#34;</span><span class="p">);</span>
			<span class="n">exit</span><span class="p">(</span><span class="mi">1</span><span class="p">);</span>
		<span class="p">}</span>
		<span class="n">dup2</span><span class="p">(</span><span class="n">fd</span><span class="p">,</span> <span class="n">STDOUT_FILENO</span><span class="p">);</span>
		<span class="n">dup2</span><span class="p">(</span><span class="n">fd</span><span class="p">,</span> <span class="n">STDERR_FILENO</span><span class="p">);</span>
		<span class="k">while</span><span class="p">(</span><span class="mi">1</span><span class="p">){</span>
			<span class="n">sleep</span><span class="p">(</span><span class="mi">1</span><span class="p">);</span>	
		<span class="p">}</span>
		
	<span class="p">}</span>
	<span class="k">else</span> <span class="k">if</span><span class="p">(</span><span class="n">pid</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">){</span>
		<span class="k">return</span> <span class="mi">0</span><span class="p">;</span>
	<span class="p">}</span>
	<span class="k">return</span> <span class="mi">0</span><span class="p">;</span>
<span class="p">}</span>
</code></pre></td></tr></table>
</div>
</div><p>åœ¨bashrcæ–‡ä»¶ä¸­åŠ å…¥è¿è¡Œå‘½ä»¤ï¼Œåˆ™å¯ä»¥ä¿è¯æ¯æ¬¡å¼€æœºè‡ªåŠ¨å¯åŠ¨ã€‚</p>
<h1 id="çº¿ç¨‹">çº¿ç¨‹</h1>
<h2 id="æ¦‚å¿µ">æ¦‚å¿µ</h2>
<p>Linuxä¸‹ä»æ˜¯è½»é‡çº§çš„è¿›ç¨‹ï¼Œå·®åˆ«ä¸å¤§ã€‚</p>
<p>è¿›ç¨‹ï¼šç‹¬ç«‹çš„åœ°å€ç©ºé—´ã€PCB</p>
<p>çº¿ç¨‹ï¼šä¹Ÿæœ‰PCBï¼Œä½†æ˜¯æ²¡æœ‰ç‹¬ç«‹çš„åœ°å€ç©ºé—´ï¼ˆå…±äº«ï¼‰ã€‚</p>
<p><img
        class="lazyload"
        src="/svg/loading.min.svg"
        data-src="/images/LinuxSystem/Untitled%2061.png"
        data-srcset="/images/LinuxSystem/Untitled%2061.png, /images/LinuxSystem/Untitled%2061.png 1.5x, /images/LinuxSystem/Untitled%2061.png 2x"
        data-sizes="auto"
        alt="/images/LinuxSystem/Untitled%2061.png"
        title="/images/LinuxSystem/Untitled%2061.png" /></p>
<p>è¿›ç¨‹ï¼ˆç‹¬å±…ï¼‰ï¼Œçº¿ç¨‹ï¼ˆåˆç§Ÿï¼‰</p>
<p><strong>çº¿ç¨‹æ˜¯æœ€å°çš„æ‰§è¡Œå•ä½ï¼Œè¿›ç¨‹æ˜¯æœ€å°çš„èµ„æºåˆ†é…çš„å•ä½ã€‚</strong></p>
<h3 id="linuxçº¿ç¨‹å®ç°åŸç†">Linuxçº¿ç¨‹å®ç°åŸç†</h3>
<ul>
<li>çº¿ç¨‹æ˜¯ç”±è¿›ç¨‹å‘å±•è€Œæ¥ï¼Œåº•å±‚å®ç°ç±»ä¼¼ã€‚éƒ½æ˜¯ç”¨clone()ï¼Œä¹Ÿæœ‰PCBã€‚</li>
<li>ä»å†…æ ¸çš„è§’åº¦æ¥çœ‹ï¼Œè¿›ç¨‹å’Œçº¿ç¨‹éƒ½ä¸€æ ·ï¼Œæœ‰ä¸åŒçš„PCBã€‚ä½†æ˜¯PCBä¸­æŒ‡å‘å†…å­˜çš„ä¸‰çº§é¡µè¡¨å¯¹äºçº¿ç¨‹æ¥è¯´æ˜¯ç›¸åŒçš„ã€‚</li>
</ul>
<p><img
        class="lazyload"
        src="/svg/loading.min.svg"
        data-src="/images/LinuxSystem/Untitled%2062.png"
        data-srcset="/images/LinuxSystem/Untitled%2062.png, /images/LinuxSystem/Untitled%2062.png 1.5x, /images/LinuxSystem/Untitled%2062.png 2x"
        data-sizes="auto"
        alt="/images/LinuxSystem/Untitled%2062.png"
        title="/images/LinuxSystem/Untitled%2062.png" /></p>
<p><img
        class="lazyload"
        src="/svg/loading.min.svg"
        data-src="/images/LinuxSystem/Untitled%2063.png"
        data-srcset="/images/LinuxSystem/Untitled%2063.png, /images/LinuxSystem/Untitled%2063.png 1.5x, /images/LinuxSystem/Untitled%2063.png 2x"
        data-sizes="auto"
        alt="/images/LinuxSystem/Untitled%2063.png"
        title="/images/LinuxSystem/Untitled%2063.png" /></p>
<ul>
<li>çº¿ç¨‹å¯ä»¥çœ‹æˆæ˜¯å¯„å­˜å™¨å’Œæ ˆçš„é›†åˆã€‚</li>
</ul>
<p><img
        class="lazyload"
        src="/svg/loading.min.svg"
        data-src="/images/LinuxSystem/Untitled%2064.png"
        data-srcset="/images/LinuxSystem/Untitled%2064.png, /images/LinuxSystem/Untitled%2064.png 1.5x, /images/LinuxSystem/Untitled%2064.png 2x"
        data-sizes="auto"
        alt="/images/LinuxSystem/Untitled%2064.png"
        title="/images/LinuxSystem/Untitled%2064.png" /></p>
<p>å†…æ ¸ä¸­çš„æ ˆç”¨äºè®°å½•ä¸´æ—¶çš„å¯„å­˜å™¨å€¼ï¼Œä¾¿äºæ¢å¤ã€‚</p>
<p>LWPå·ï¼ˆçº¿ç¨‹å·ï¼ŒåŒºåˆ†äºçº¿ç¨‹idï¼‰   ps -Lf pidã€‚</p>
<p>çº¿ç¨‹å·ï¼šCPUåˆ†é…è¿è¡Œæ—¶é—´çš„ä¾æ®ã€‚</p>
<p>çº¿ç¨‹idï¼šè¿›ç¨‹å†…éƒ¨åŒºåˆ†çº¿ç¨‹çš„æ–¹æ³•ã€‚</p>
<h3 id="çº¿ç¨‹å…±äº«èµ„æº">çº¿ç¨‹å…±äº«èµ„æº</h3>
<ul>
<li>æ–‡ä»¶æè¿°ç¬¦è¡¨</li>
<li>æ¯ç§ä¿¡å·çš„å¤„ç†æ–¹å¼ï¼ˆå°½é‡ä¸è¦çº¿ç¨‹å’Œä¿¡å·ä¸€èµ·ä½¿ç”¨ï¼‰</li>
<li>å½“å‰å·¥ä½œç›®å½•</li>
<li>ç”¨æˆ·IDå’Œç»„ID</li>
<li>å†…å­˜åœ°å€ç©ºé—´ .text .data .bss heap å…±äº«åº“</li>
</ul>
<h3 id="éå…±äº«èµ„æº">éå…±äº«èµ„æº</h3>
<ul>
<li>çº¿ç¨‹id</li>
<li>å¤„ç†å™¨ç°åœºå’Œæ ˆæŒ‡é’ˆï¼ˆå†…æ ¸æ ˆï¼‰</li>
<li>ç‹¬ç«‹çš„æ ˆç©ºé—´ï¼ˆç”¨æˆ·æ ˆï¼‰</li>
<li>errnoå˜é‡</li>
<li>ä¿¡å·å±è”½å­—</li>
<li>è°ƒåº¦ä¼˜å…ˆçº§</li>
</ul>
<h3 id="ä¼˜ç¼ºç‚¹">ä¼˜ç¼ºç‚¹</h3>
<p>ä¼˜ç‚¹ï¼š</p>
<ul>
<li>æé«˜ç¨‹åºå¹¶å‘æ€§</li>
<li>å¼€é”€å°</li>
<li>æ•°æ®é€šä¿¡ã€å…±äº«æ•°æ®æ–¹ä¾¿</li>
</ul>
<p>ç¼ºç‚¹ï¼š</p>
<ul>
<li>åº“å‡½æ•°ä¸ç¨³å®šï¼ˆpthreadï¼‰</li>
<li>è°ƒè¯•å›°éš¾ï¼Œgdbä¸æ”¯æŒ</li>
<li>å¯¹ä¿¡å·æ”¯æŒä¸å¥½</li>
</ul>
<p>åœ¨Linuxä¸‹ï¼Œç”±äºå®ç°æ–¹æ³•å¯¼è‡´è¿›ç¨‹çº¿ç¨‹çš„å·®åˆ«ä¸å¤§ã€‚</p>
<h2 id="æ§åˆ¶åŸè¯­">æ§åˆ¶åŸè¯­</h2>
<h3 id="pthread_self">pthread_self</h3>
<p>å¯¹åº”getpidï¼ˆï¼‰è·å–çº¿ç¨‹idã€‚</p>
<h3 id="pthread_create">pthread_create</h3>
<p>å¯¹åº”forkï¼ˆï¼‰</p>
<p><img
        class="lazyload"
        src="/svg/loading.min.svg"
        data-src="/images/LinuxSystem/Untitled%2065.png"
        data-srcset="/images/LinuxSystem/Untitled%2065.png, /images/LinuxSystem/Untitled%2065.png 1.5x, /images/LinuxSystem/Untitled%2065.png 2x"
        data-sizes="auto"
        alt="/images/LinuxSystem/Untitled%2065.png"
        title="/images/LinuxSystem/Untitled%2065.png" /></p>
<p>ä¼ å‡ºçº¿ç¨‹idï¼Œä¼ å…¥å±æ€§ï¼ˆå¯ä»¥æ˜¯NULLï¼‰ï¼Œä¸»æ§å‡½æ•°ï¼Œå‡½æ•°å‚æ•°ã€‚</p>
<p>æ³¨æ„è¿”å›å€¼ä¸ºé”™è¯¯ç¼–å·ï¼ˆé-1ï¼‰ã€‚</p>
<p>å­˜ç–‘ï¼šæ³¨æ„ä¼ å‚æ—¶æœ€å¥½ä¸ºå€¼ä¼ é€’ï¼Œå†…å­˜åœ°å€æƒ…å†µå¯èƒ½ä¼šå‘ç”Ÿæ”¹å˜ã€‚</p>
<h3 id="pthread_exit">pthread_exit</h3>
<p>å°†å•ä¸ªçº¿ç¨‹é€€å‡ºã€‚å¦‚æœæ˜¯ä¸»æ§çº¿ç¨‹ï¼Œåˆ™å¯ä»¥ä½¿å¾—å­çº¿ç¨‹ç»§ç»­è¿è¡Œè€Œéé€€å‡ºã€‚exitå‡½æ•°ä¼šç›´æ¥æŠŠè¿›ç¨‹ç»“æŸã€‚returnä½œç”¨ä¸ºè¿”å›å€¼åˆ°è°ƒç”¨è€…å¤„ã€‚</p>
<h3 id="pthread_join">pthread_join</h3>
<p>å¯¹åº”waitpidï¼ˆï¼‰ã€‚å›æ”¶çº¿ç¨‹ã€‚</p>
<p><img
        class="lazyload"
        src="/svg/loading.min.svg"
        data-src="/images/LinuxSystem/Untitled%2066.png"
        data-srcset="/images/LinuxSystem/Untitled%2066.png, /images/LinuxSystem/Untitled%2066.png 1.5x, /images/LinuxSystem/Untitled%2066.png 2x"
        data-sizes="auto"
        alt="/images/LinuxSystem/Untitled%2066.png"
        title="/images/LinuxSystem/Untitled%2066.png" /></p>
<p>è¿”å›çš„retvalè‹¥ä¼ æŒ‡é’ˆåˆ™éœ€è¦mallocã€‚ä¹Ÿå¯ä»¥åœ¨mainä¸­mallocã€‚</p>
<p><img
        class="lazyload"
        src="/svg/loading.min.svg"
        data-src="/images/LinuxSystem/Untitled%2067.png"
        data-srcset="/images/LinuxSystem/Untitled%2067.png, /images/LinuxSystem/Untitled%2067.png 1.5x, /images/LinuxSystem/Untitled%2067.png 2x"
        data-sizes="auto"
        alt="/images/LinuxSystem/Untitled%2067.png"
        title="/images/LinuxSystem/Untitled%2067.png" /></p>
<p>çº¿ç¨‹çš„å›æ”¶ä¸éœ€è¦ä¸€å®šæ˜¯ä¸»æ§çº¿ç¨‹ã€‚</p>
<h3 id="pthread_detach">pthread_detach</h3>
<p>å®ç°çº¿ç¨‹åˆ†ç¦»ï¼Œå¯¹çº¿ç¨‹åœ¨çŠ¶æ€ä¸Šå®ç°åˆ†ç¦»ï¼Œå…¶é€€å‡ºçŠ¶æ€ä¸è¢«è·å–ï¼Œä¸”è‡ªå·±é‡Šæ”¾ï¼Œä¸ä¼šæˆä¸ºåƒµå°¸çº¿ç¨‹ã€‚</p>
<p><img
        class="lazyload"
        src="/svg/loading.min.svg"
        data-src="/images/LinuxSystem/Untitled%2068.png"
        data-srcset="/images/LinuxSystem/Untitled%2068.png, /images/LinuxSystem/Untitled%2068.png 1.5x, /images/LinuxSystem/Untitled%2068.png 2x"
        data-sizes="auto"
        alt="/images/LinuxSystem/Untitled%2068.png"
        title="/images/LinuxSystem/Untitled%2068.png" /></p>
<h3 id="pthread_cancel">pthread_cancel</h3>
<p>å¯¹åº”killï¼Œç›´æ¥æ€æ­»æŸçº¿ç¨‹ã€‚ä½†æ˜¯éœ€è¦çº¿ç¨‹åˆ°è¾¾ä¸€å®šçš„æ£€æŸ¥ç‚¹ã€‚</p>
<p>ä½¿ç”¨man 7 pthreads æŸ¥çœ‹æ‰€æœ‰å–æ¶ˆç‚¹ã€‚å¦‚read pause open creat close&hellip;</p>
<p>ä¹Ÿå¯ä»¥è‡ªå®šä¹‰å–æ¶ˆç‚¹ pthread_testcancel()ã€‚</p>
<h3 id="åŸè¯­å¯¹æ¯”">åŸè¯­å¯¹æ¯”</h3>
<p>getpid : pthread_self</p>
<p>fork:  pthread_create</p>
<p>wait:  pthread_join(tid, void**)</p>
<p>exit(): pthread_exit(void*)</p>
<dl>
<dt>kill():  pthread_cancel();  åˆ°è¾¾å–æ¶ˆç‚¹</dt>
<dd>
<p>pthread_detach è‡ªåŠ¨æ¸…ç†pcb</p>
</dd>
</dl>
<h2 id="çº¿ç¨‹å±æ€§">çº¿ç¨‹å±æ€§</h2>
<p><img
        class="lazyload"
        src="/svg/loading.min.svg"
        data-src="/images/LinuxSystem/Untitled%2069.png"
        data-srcset="/images/LinuxSystem/Untitled%2069.png, /images/LinuxSystem/Untitled%2069.png 1.5x, /images/LinuxSystem/Untitled%2069.png 2x"
        data-sizes="auto"
        alt="/images/LinuxSystem/Untitled%2069.png"
        title="/images/LinuxSystem/Untitled%2069.png" /></p>
<p>pthread_attr_init/destroy å‡½æ•°åˆå§‹åŒ–å’Œé”€æ¯è¿™ä¸ªå±æ€§ç»“æ„ä½“ã€‚</p>
<p><img
        class="lazyload"
        src="/svg/loading.min.svg"
        data-src="/images/LinuxSystem/Untitled%2070.png"
        data-srcset="/images/LinuxSystem/Untitled%2070.png, /images/LinuxSystem/Untitled%2070.png 1.5x, /images/LinuxSystem/Untitled%2070.png 2x"
        data-sizes="auto"
        alt="/images/LinuxSystem/Untitled%2070.png"
        title="/images/LinuxSystem/Untitled%2070.png" /></p>
<p><img
        class="lazyload"
        src="/svg/loading.min.svg"
        data-src="/images/LinuxSystem/Untitled%2071.png"
        data-srcset="/images/LinuxSystem/Untitled%2071.png, /images/LinuxSystem/Untitled%2071.png 1.5x, /images/LinuxSystem/Untitled%2071.png 2x"
        data-sizes="auto"
        alt="/images/LinuxSystem/Untitled%2071.png"
        title="/images/LinuxSystem/Untitled%2071.png" /></p>
<p>è°ƒæ•´æ ˆçš„å¤§å°ä½¿å¾—èƒ½å»ºç«‹æ›´å¤šçš„çº¿ç¨‹ã€‚</p>
<p><img
        class="lazyload"
        src="/svg/loading.min.svg"
        data-src="/images/LinuxSystem/Untitled%2072.png"
        data-srcset="/images/LinuxSystem/Untitled%2072.png, /images/LinuxSystem/Untitled%2072.png 1.5x, /images/LinuxSystem/Untitled%2072.png 2x"
        data-sizes="auto"
        alt="/images/LinuxSystem/Untitled%2072.png"
        title="/images/LinuxSystem/Untitled%2072.png" /></p>
<p>æ³¨æ„æ­¤æ—¶æ˜¯åœ¨å †ä¸Šåˆ›å»ºçº¿ç¨‹ã€‚</p>
<h2 id="nptl-çº¿ç¨‹åº“ç‰ˆæœ¬">NPTL çº¿ç¨‹åº“ç‰ˆæœ¬</h2>
<p>getconf GNU_LIBPTHREAD_VERSION</p>
<h2 id="æ³¨æ„äº‹é¡¹">æ³¨æ„äº‹é¡¹</h2>
<ul>
<li>é¿å…åƒµå°¸è¿›ç¨‹ join detach</li>
<li>é¿å…ä½¿ç”¨forkï¼ˆï¼‰</li>
<li>é¿å…ä½¿ç”¨ä¿¡å·</li>
</ul>
<h1 id="çº¿ç¨‹åŒæ­¥">çº¿ç¨‹åŒæ­¥</h1>
<h2 id="æ¦‚å¿µ-1">æ¦‚å¿µ</h2>
<p>çº¿ç¨‹çš„åŒæ­¥æ˜¯æŒ‡ååŒï¼Œäº’ç›¸é…åˆï¼Œçº¿ç¨‹æŒ‰ç…§ä¸€å®šçš„å…ˆåæ¬¡åºè¿è¡Œã€‚</p>
<p>ä¸€ä¸ªçº¿ç¨‹å‘å‡ºæŸä¸€åŠŸèƒ½è°ƒç”¨æ—¶ï¼Œç›´åˆ°è¿™ä¸ªåŠŸèƒ½è°ƒç”¨ç»“æŸä¸ºæ­¢ï¼Œå…¶ä»–çº¿ç¨‹ä¸è°ƒç”¨è¿™ä¸ªåŠŸèƒ½ã€‚</p>
<p>æ•°æ®å‘ç”Ÿæ—¶é—´é”™è¯¯æ¡ä»¶ï¼š</p>
<ul>
<li>æ•°æ®å…±äº«ã€‚</li>
<li>ç«äº‰ã€‚</li>
<li>å¤šä¸ªå¯¹è±¡æ²¡æœ‰åˆç†çš„åŒæ­¥æœºåˆ¶ã€‚</li>
</ul>
<h2 id="äº’æ–¥é‡-mutex">äº’æ–¥é‡ mutex</h2>
<p>ç»“æ„ä½“pthread_mutex_t(å¯ä»¥çœ‹åšä¸€ä¸ªæ•´æ•°ï¼‰ã€‚</p>
<h3 id="pthread_mutex_initdestory">pthread_mutex_initï¼ˆdestoryï¼‰</h3>
<p><img
        class="lazyload"
        src="/svg/loading.min.svg"
        data-src="/images/LinuxSystem/Untitled%2073.png"
        data-srcset="/images/LinuxSystem/Untitled%2073.png, /images/LinuxSystem/Untitled%2073.png 1.5x, /images/LinuxSystem/Untitled%2073.png 2x"
        data-sizes="auto"
        alt="/images/LinuxSystem/Untitled%2073.png"
        title="/images/LinuxSystem/Untitled%2073.png" /></p>
<p><img
        class="lazyload"
        src="/svg/loading.min.svg"
        data-src="/images/LinuxSystem/Untitled%2074.png"
        data-srcset="/images/LinuxSystem/Untitled%2074.png, /images/LinuxSystem/Untitled%2074.png 1.5x, /images/LinuxSystem/Untitled%2074.png 2x"
        data-sizes="auto"
        alt="/images/LinuxSystem/Untitled%2074.png"
        title="/images/LinuxSystem/Untitled%2074.png" /></p>
<p>restrictå…³é”®å­—ï¼š</p>
<p><a href="https://www.zhihu.com/question/41653775" target="_blank" rel="noopener noreffer">å¦‚ä½•ç†è§£Cè¯­è¨€å…³é”®å­—restrictï¼Ÿ</a></p>
<p>restrict æ˜¯ä¸ºäº†å‘Šè¯‰ç¼–è¯‘å™¨é¢å¤–ä¿¡æ¯ï¼ˆä¸¤ä¸ªæŒ‡é’ˆä¸æŒ‡å‘åŒä¸€æ•°æ®ï¼‰ï¼Œä»è€Œç”Ÿæˆæ›´ä¼˜åŒ–çš„æœºå™¨ç ã€‚</p>
<p><img
        class="lazyload"
        src="/svg/loading.min.svg"
        data-src="/images/LinuxSystem/Untitled%2075.png"
        data-srcset="/images/LinuxSystem/Untitled%2075.png, /images/LinuxSystem/Untitled%2075.png 1.5x, /images/LinuxSystem/Untitled%2075.png 2x"
        data-sizes="auto"
        alt="/images/LinuxSystem/Untitled%2075.png"
        title="/images/LinuxSystem/Untitled%2075.png" /></p>
<h3 id="pthread_mutex_lock">pthread_mutex_lock</h3>
<p>ç”¨é˜»å¡ç­‰å¾…æ–¹æ³•åŠ é”ã€‚</p>
<p><img
        class="lazyload"
        src="/svg/loading.min.svg"
        data-src="/images/LinuxSystem/Untitled%2076.png"
        data-srcset="/images/LinuxSystem/Untitled%2076.png, /images/LinuxSystem/Untitled%2076.png 1.5x, /images/LinuxSystem/Untitled%2076.png 2x"
        data-sizes="auto"
        alt="/images/LinuxSystem/Untitled%2076.png"
        title="/images/LinuxSystem/Untitled%2076.png" /></p>
<h3 id="pthread_mutex_trylock">pthread_mutex_trylock</h3>
<p>ä¸é˜»å¡æ–¹æ³•åŠ é”ã€‚ï¼ˆè½®è¯¢ï¼‰</p>
<h3 id="pthread_mutex_unlock">pthread_mutex_unlock</h3>
<p>è§£é”ã€‚</p>
<p>é”çš„ç²’åº¦åº”è¯¥è¶Šå°è¶Šå¥½ã€‚</p>
<h3 id="æ­»é”">æ­»é”</h3>
<p>1ã€çº¿ç¨‹å°è¯•å¯¹é”åŠ ä¸¤æ¬¡é”ã€‚</p>
<p>2ã€å¤šä¸ªçº¿ç¨‹äº’ç›¸ç­‰å¾…ã€‚</p>
<p><img
        class="lazyload"
        src="/svg/loading.min.svg"
        data-src="/images/LinuxSystem/Untitled%2077.png"
        data-srcset="/images/LinuxSystem/Untitled%2077.png, /images/LinuxSystem/Untitled%2077.png 1.5x, /images/LinuxSystem/Untitled%2077.png 2x"
        data-sizes="auto"
        alt="/images/LinuxSystem/Untitled%2077.png"
        title="/images/LinuxSystem/Untitled%2077.png" /></p>
<p>è§£å†³æ–¹æ³•ï¼š</p>
<ul>
<li>ä½¿ç”¨pthread_mutex_trylockï¼Œè‹¥å¤±è´¥åˆ™æ”¾å¼ƒå·²æœ‰çš„é”ï¼Œæ—¥åå†åŠ é”ã€‚</li>
</ul>
<h2 id="è¯»å†™é”">è¯»å†™é”</h2>
<p>è¯»å†™é”æ˜¯ä¸€æŠŠé”ã€‚å…·å¤‡ä¸‰ç§çŠ¶æ€</p>
<ul>
<li>è¯»é”</li>
<li>å†™é”</li>
<li>ä¸åŠ é”</li>
</ul>
<p>å†™ç‹¬å ï¼Œè¯»å…±äº«ï¼Œå†™é”ä¼˜å…ˆåº¦é«˜ã€‚ï¼ˆå†™è€…ä¼˜å…ˆï¼‰pthread_rwlock_t</p>
<p><img
        class="lazyload"
        src="/svg/loading.min.svg"
        data-src="/images/LinuxSystem/Untitled%2078.png"
        data-srcset="/images/LinuxSystem/Untitled%2078.png, /images/LinuxSystem/Untitled%2078.png 1.5x, /images/LinuxSystem/Untitled%2078.png 2x"
        data-sizes="auto"
        alt="/images/LinuxSystem/Untitled%2078.png"
        title="/images/LinuxSystem/Untitled%2078.png" /></p>
<h2 id="æ¡ä»¶å˜é‡">æ¡ä»¶å˜é‡</h2>
<p>æ¡ä»¶å˜é‡ä¸æ˜¯é”ï¼Œä½†æ˜¯å¯ä»¥é€ æˆçº¿ç¨‹é˜»å¡ï¼Œé€šå¸¸ä¸äº’æ–¥é”æ­é…ä½¿ç”¨ã€‚ pthread_cond_t</p>
<p><img
        class="lazyload"
        src="/svg/loading.min.svg"
        data-src="/images/LinuxSystem/Untitled%2079.png"
        data-srcset="/images/LinuxSystem/Untitled%2079.png, /images/LinuxSystem/Untitled%2079.png 1.5x, /images/LinuxSystem/Untitled%2079.png 2x"
        data-sizes="auto"
        alt="/images/LinuxSystem/Untitled%2079.png"
        title="/images/LinuxSystem/Untitled%2079.png" /></p>
<p><img
        class="lazyload"
        src="/svg/loading.min.svg"
        data-src="/images/LinuxSystem/Untitled%2080.png"
        data-srcset="/images/LinuxSystem/Untitled%2080.png, /images/LinuxSystem/Untitled%2080.png 1.5x, /images/LinuxSystem/Untitled%2080.png 2x"
        data-sizes="auto"
        alt="/images/LinuxSystem/Untitled%2080.png"
        title="/images/LinuxSystem/Untitled%2080.png" /></p>
<h3 id="pthread_cond_wait">pthread_cond_wait</h3>
<p>pthread_cond_waitå‡½æ•°æœ‰ä¸‰ä¸ªåŠŸèƒ½ï¼š</p>
<ul>
<li>é˜»å¡ç­‰å¾…ä¸€ä¸ªæ¡ä»¶å˜é‡æ»¡è¶³ã€‚</li>
<li>é‡Šæ”¾å·²ç»æŒæ¡çš„äº’æ–¥é”ã€‚
<ul>
<li>ä»¥ä¸Šä¸¤ä¸ªä¸ºåŸå­æ“ä½œ</li>
</ul>
</li>
<li>å½“è¢«å”¤é†’ï¼Œè§£é™¤é˜»å¡å¹¶é‡æ–°ç”³è¯·è·å–äº’æ–¥é”ã€‚</li>
</ul>
<p>ä½¿ç”¨pthread_cond_signalå”¤é†’ä¸€ä¸ªçº¿ç¨‹ã€‚pthead_cond_boardcastå”¤é†’æ‰€æœ‰çº¿ç¨‹ã€‚</p>
<h3 id="pthread_cond_timedwait">pthread_cond_timedwait</h3>
<p>åœ¨æŒ‡å®šæ—¶é—´å†…ç­‰å¾…ã€‚</p>
<p><img
        class="lazyload"
        src="/svg/loading.min.svg"
        data-src="/images/LinuxSystem/Untitled%2081.png"
        data-srcset="/images/LinuxSystem/Untitled%2081.png, /images/LinuxSystem/Untitled%2081.png 1.5x, /images/LinuxSystem/Untitled%2081.png 2x"
        data-sizes="auto"
        alt="/images/LinuxSystem/Untitled%2081.png"
        title="/images/LinuxSystem/Untitled%2081.png" /></p>
<p>è¿™é‡Œçš„abstimeä¸ºtimespecç»“æ„ä½“ï¼š</p>
<p><img
        class="lazyload"
        src="/svg/loading.min.svg"
        data-src="/images/LinuxSystem/Untitled%2082.png"
        data-srcset="/images/LinuxSystem/Untitled%2082.png, /images/LinuxSystem/Untitled%2082.png 1.5x, /images/LinuxSystem/Untitled%2082.png 2x"
        data-sizes="auto"
        alt="/images/LinuxSystem/Untitled%2082.png"
        title="/images/LinuxSystem/Untitled%2082.png" /></p>
<p>abstimeæ˜¯ç»å¯¹æ—¶é—´(ç›¸å¯¹äºunixè¯ç”Ÿæ—¶é—´):</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-c" data-lang="c"><span class="n">time_t</span> <span class="n">cur</span> <span class="o">=</span> <span class="n">time</span><span class="p">(</span><span class="nb">NULL</span><span class="p">);</span>
<span class="k">struct</span> <span class="n">timespec</span> <span class="n">t</span><span class="p">;</span>
<span class="n">t</span><span class="p">.</span><span class="n">tv_sec</span> <span class="o">=</span> <span class="n">cur</span> <span class="o">+</span> <span class="mi">1</span><span class="p">;</span>
<span class="n">pthread_cond_timedwait</span><span class="p">(</span><span class="o">&amp;</span><span class="n">cond</span><span class="p">,</span> <span class="o">&amp;</span><span class="n">mutex</span><span class="p">,</span> <span class="o">&amp;</span><span class="n">t</span><span class="p">);</span>
</code></pre></td></tr></table>
</div>
</div><h3 id="ä½¿ç”¨æ¡ä»¶å˜é‡è§£å†³ç”Ÿäº§è€…æ¶ˆè´¹è€…æ¨¡å‹">ä½¿ç”¨æ¡ä»¶å˜é‡è§£å†³ç”Ÿäº§è€…æ¶ˆè´¹è€…æ¨¡å‹</h3>
<p><img
        class="lazyload"
        src="/svg/loading.min.svg"
        data-src="/images/LinuxSystem/Untitled%2083.png"
        data-srcset="/images/LinuxSystem/Untitled%2083.png, /images/LinuxSystem/Untitled%2083.png 1.5x, /images/LinuxSystem/Untitled%2083.png 2x"
        data-sizes="auto"
        alt="/images/LinuxSystem/Untitled%2083.png"
        title="/images/LinuxSystem/Untitled%2083.png" /></p>
<p>æ¡ä»¶å˜é‡ä»£è¡¨æ˜¯å¦ç¼“å†²åŒºæœ‰äº§å“ã€‚</p>
<p>æ¡ä»¶å˜é‡çš„ä¼˜ç‚¹åœ¨äºå‡å°‘äº†ç«äº‰ï¼Œæ¶ˆè´¹è€…ä¹‹é—´åœ¨ç”Ÿäº§æ—¶ä¸å†éœ€è¦ç«äº‰äº’æ–¥é”ã€‚</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span><span class="lnt">18
</span><span class="lnt">19
</span><span class="lnt">20
</span><span class="lnt">21
</span><span class="lnt">22
</span><span class="lnt">23
</span><span class="lnt">24
</span><span class="lnt">25
</span><span class="lnt">26
</span><span class="lnt">27
</span><span class="lnt">28
</span><span class="lnt">29
</span><span class="lnt">30
</span><span class="lnt">31
</span><span class="lnt">32
</span><span class="lnt">33
</span><span class="lnt">34
</span><span class="lnt">35
</span><span class="lnt">36
</span><span class="lnt">37
</span><span class="lnt">38
</span><span class="lnt">39
</span><span class="lnt">40
</span><span class="lnt">41
</span><span class="lnt">42
</span><span class="lnt">43
</span><span class="lnt">44
</span><span class="lnt">45
</span><span class="lnt">46
</span><span class="lnt">47
</span><span class="lnt">48
</span><span class="lnt">49
</span><span class="lnt">50
</span><span class="lnt">51
</span><span class="lnt">52
</span><span class="lnt">53
</span><span class="lnt">54
</span><span class="lnt">55
</span><span class="lnt">56
</span><span class="lnt">57
</span><span class="lnt">58
</span><span class="lnt">59
</span><span class="lnt">60
</span><span class="lnt">61
</span><span class="lnt">62
</span><span class="lnt">63
</span><span class="lnt">64
</span><span class="lnt">65
</span><span class="lnt">66
</span><span class="lnt">67
</span><span class="lnt">68
</span><span class="lnt">69
</span><span class="lnt">70
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-c" data-lang="c"><span class="cp">#include</span> <span class="cpf">&lt;stdio.h&gt;</span><span class="cp">
</span><span class="cp">#include</span> <span class="cpf">&lt;unistd.h&gt;</span><span class="cp">
</span><span class="cp">#include</span> <span class="cpf">&lt;stdlib.h&gt;</span><span class="cp">
</span><span class="cp">#include</span><span class="cpf">&lt;pthread.h&gt;</span><span class="cp">
</span><span class="cp"></span>
<span class="n">pthread_mutex_t</span> <span class="n">mutex</span> <span class="o">=</span> <span class="n">PTHREAD_MUTEX_INITIALIZER</span><span class="p">;</span>
<span class="n">pthread_cond_t</span> <span class="n">has_product</span> <span class="o">=</span> <span class="n">PTHREAD_COND_INITIALIZER</span><span class="p">;</span>

<span class="k">struct</span> <span class="n">msg</span><span class="p">{</span>
	<span class="kt">int</span> <span class="n">num</span><span class="p">;</span>
	<span class="k">struct</span> <span class="n">msg</span> <span class="o">*</span><span class="n">next</span><span class="p">;</span>
<span class="p">};</span>

<span class="k">struct</span> <span class="n">msg</span> <span class="o">*</span><span class="n">head</span> <span class="o">=</span> <span class="nb">NULL</span><span class="p">,</span> <span class="o">*</span><span class="n">mp</span> <span class="o">=</span> <span class="nb">NULL</span><span class="p">,</span> <span class="o">*</span><span class="n">mc</span> <span class="o">=</span> <span class="nb">NULL</span><span class="p">;</span>

<span class="kt">void</span><span class="o">*</span> <span class="nf">producer</span><span class="p">(</span><span class="kt">void</span><span class="o">*</span> <span class="n">arg</span><span class="p">){</span>
	<span class="k">while</span><span class="p">(</span><span class="mi">1</span><span class="p">){</span>
		<span class="n">mp</span> <span class="o">=</span> <span class="n">malloc</span><span class="p">(</span><span class="k">sizeof</span><span class="p">(</span><span class="k">struct</span> <span class="n">msg</span><span class="p">));</span>
		<span class="n">mp</span> <span class="o">-&gt;</span> <span class="n">num</span> <span class="o">=</span> <span class="n">rand</span><span class="p">()</span> <span class="o">%</span> <span class="mi">400</span> <span class="o">+</span> <span class="mi">1</span><span class="p">;</span>
		<span class="n">printf</span><span class="p">(</span><span class="s">&#34;=&gt;produced %d</span><span class="se">\n</span><span class="s">&#34;</span><span class="p">,</span> <span class="n">mp</span> <span class="o">-&gt;</span> <span class="n">num</span><span class="p">);</span>
		
		<span class="n">pthread_mutex_lock</span><span class="p">(</span><span class="o">&amp;</span><span class="n">mutex</span><span class="p">);</span>
		<span class="n">mp</span> <span class="o">-&gt;</span> <span class="n">next</span> <span class="o">=</span> <span class="n">head</span><span class="p">;</span>
		<span class="n">head</span> <span class="o">=</span> <span class="n">mp</span><span class="p">;</span>
		<span class="n">pthread_mutex_unlock</span><span class="p">(</span><span class="o">&amp;</span><span class="n">mutex</span><span class="p">);</span>
		<span class="kt">int</span> <span class="n">ret</span> <span class="o">=</span> <span class="n">pthread_cond_signal</span><span class="p">(</span><span class="o">&amp;</span><span class="n">has_product</span><span class="p">);</span>
		<span class="k">if</span><span class="p">(</span><span class="n">ret</span> <span class="o">!=</span> <span class="mi">0</span><span class="p">){</span>
			<span class="n">printf</span><span class="p">(</span><span class="s">&#34;signal failed</span><span class="se">\n</span><span class="s">&#34;</span><span class="p">);</span>
			<span class="n">pthread_exit</span><span class="p">(</span><span class="nb">NULL</span><span class="p">);</span>
		<span class="p">}</span>
		<span class="n">sleep</span><span class="p">(</span><span class="n">rand</span><span class="p">()</span> <span class="o">%</span> <span class="mi">3</span><span class="p">);</span>
	<span class="p">}</span>
	<span class="k">return</span> <span class="nb">NULL</span><span class="p">;</span>
<span class="p">}</span>

<span class="kt">void</span><span class="o">*</span> <span class="nf">consumer</span><span class="p">(</span><span class="kt">void</span><span class="o">*</span> <span class="n">arg</span><span class="p">){</span>
	<span class="k">while</span><span class="p">(</span><span class="mi">1</span><span class="p">){</span>
		<span class="n">pthread_mutex_lock</span><span class="p">(</span><span class="o">&amp;</span><span class="n">mutex</span><span class="p">);</span>
		<span class="k">while</span><span class="p">(</span><span class="n">head</span> <span class="o">==</span> <span class="nb">NULL</span><span class="p">){</span>
			<span class="n">pthread_cond_wait</span><span class="p">(</span><span class="o">&amp;</span><span class="n">has_product</span><span class="p">,</span> <span class="o">&amp;</span><span class="n">mutex</span><span class="p">);</span>
		<span class="p">}</span>
		<span class="n">mc</span> <span class="o">=</span> <span class="n">head</span><span class="p">;</span>
		<span class="n">head</span> <span class="o">=</span> <span class="n">mc</span> <span class="o">-&gt;</span> <span class="n">next</span><span class="p">;</span>
		<span class="n">pthread_mutex_unlock</span><span class="p">(</span><span class="o">&amp;</span><span class="n">mutex</span><span class="p">);</span>
		<span class="n">printf</span><span class="p">(</span><span class="s">&#34;=&gt;consumed: %d</span><span class="se">\n</span><span class="s">&#34;</span><span class="p">,</span> <span class="n">mc</span><span class="o">-&gt;</span><span class="n">num</span><span class="p">);</span>
		<span class="n">free</span><span class="p">(</span><span class="n">mc</span><span class="p">);</span>
		<span class="n">mc</span> <span class="o">=</span> <span class="nb">NULL</span><span class="p">;</span>
		<span class="n">sleep</span><span class="p">(</span><span class="n">rand</span><span class="p">()</span> <span class="o">%</span> <span class="mi">2</span><span class="p">);</span>
	<span class="p">}</span>
	<span class="k">return</span> <span class="nb">NULL</span><span class="p">;</span>
<span class="p">}</span>

<span class="kt">int</span> <span class="nf">main</span><span class="p">()</span>
<span class="p">{</span>
	<span class="n">pthread_t</span> <span class="n">ptid</span><span class="p">,</span> <span class="n">ctid</span><span class="p">;</span>
	<span class="kt">int</span> <span class="n">ret</span> <span class="o">=</span> <span class="n">pthread_create</span><span class="p">(</span><span class="o">&amp;</span><span class="n">ptid</span><span class="p">,</span> <span class="nb">NULL</span><span class="p">,</span> <span class="n">producer</span><span class="p">,</span> <span class="nb">NULL</span><span class="p">);</span>
	<span class="k">if</span><span class="p">(</span><span class="n">ret</span> <span class="o">!=</span> <span class="mi">0</span><span class="p">){</span>
		<span class="n">printf</span><span class="p">(</span><span class="s">&#34;create error</span><span class="se">\n</span><span class="s">&#34;</span><span class="p">);</span>
		<span class="n">exit</span><span class="p">(</span><span class="mi">1</span><span class="p">);</span>
	<span class="p">}</span>
	<span class="n">ret</span> <span class="o">=</span> <span class="n">pthread_create</span><span class="p">(</span><span class="o">&amp;</span><span class="n">ctid</span><span class="p">,</span> <span class="nb">NULL</span><span class="p">,</span> <span class="n">consumer</span><span class="p">,</span> <span class="nb">NULL</span><span class="p">);</span>
	<span class="k">if</span><span class="p">(</span><span class="n">ret</span> <span class="o">!=</span> <span class="mi">0</span><span class="p">){</span>
		<span class="n">printf</span><span class="p">(</span><span class="s">&#34;create error</span><span class="se">\n</span><span class="s">&#34;</span><span class="p">);</span>
		<span class="n">exit</span><span class="p">(</span><span class="mi">1</span><span class="p">);</span>
	<span class="p">}</span>

	<span class="n">pthread_join</span><span class="p">(</span><span class="n">ptid</span><span class="p">,</span> <span class="nb">NULL</span><span class="p">);</span>
	<span class="n">pthread_join</span><span class="p">(</span><span class="n">ctid</span><span class="p">,</span> <span class="nb">NULL</span><span class="p">);</span>

<span class="p">}</span>
</code></pre></td></tr></table>
</div>
</div><h2 id="ä¿¡å·é‡ä¹Ÿå¯ä»¥åº”ç”¨äºè¿›ç¨‹é—´åŒæ­¥">ä¿¡å·é‡ï¼ˆä¹Ÿå¯ä»¥åº”ç”¨äºè¿›ç¨‹é—´åŒæ­¥ï¼‰</h2>
<p>è¿›åŒ–ç‰ˆçš„äº’æ–¥é”ã€‚ç•™æ„ä¿¡å·é‡çš„å‡½æ•°éƒ½æ˜¯ç”¨errnoæ¥è¿”å›é”™è¯¯ä¿¡æ¯ã€‚</p>
<p>sem_t ä¿¡å·é‡ç»“æ„ä½“ã€‚</p>
<h3 id="sem_init">sem_init</h3>
<p>åˆå§‹åŒ–ä¿¡å·é‡ã€‚</p>
<p><img
        class="lazyload"
        src="/svg/loading.min.svg"
        data-src="/images/LinuxSystem/Untitled%2084.png"
        data-srcset="/images/LinuxSystem/Untitled%2084.png, /images/LinuxSystem/Untitled%2084.png 1.5x, /images/LinuxSystem/Untitled%2084.png 2x"
        data-sizes="auto"
        alt="/images/LinuxSystem/Untitled%2084.png"
        title="/images/LinuxSystem/Untitled%2084.png" /></p>
<p>ç¬¬äºŒä¸ªå‚æ•°ä»£è¡¨æ˜¯å¦èƒ½åœ¨è¿›ç¨‹é—´å…±äº«ï¼Œå½“é0ï¼Œè¡¨ç¤ºå¯ä»¥å…±äº«ã€‚</p>
<h3 id="sem_destroy">sem_destroy</h3>
<p>é”€æ¯ä¿¡å·ã€‚</p>
<h3 id="sem_wait">sem_wait</h3>
<p>ä¿¡å·é‡å‡ä¸€</p>
<p>è‹¥ä¿¡å·é‡å°äº0ï¼Œçº¿ç¨‹é˜»å¡ã€‚</p>
<p><img
        class="lazyload"
        src="/svg/loading.min.svg"
        data-src="/images/LinuxSystem/Untitled%2085.png"
        data-srcset="/images/LinuxSystem/Untitled%2085.png, /images/LinuxSystem/Untitled%2085.png 1.5x, /images/LinuxSystem/Untitled%2085.png 2x"
        data-sizes="auto"
        alt="/images/LinuxSystem/Untitled%2085.png"
        title="/images/LinuxSystem/Untitled%2085.png" /></p>
<h3 id="sem_trywait">sem_trywait</h3>
<h3 id="sem_timedwait">sem_timedwait</h3>
<h3 id="sem_post">sem_post</h3>
<p>ä¿¡å·é‡åŠ ä¸€ï¼Œè‹¥ä¿¡å·é‡å°äºç­‰äº0ï¼ŒåŒæ—¶å”¤é†’ä¿¡å·é‡ä¸Šçš„è¿›ç¨‹ã€‚</p>
<h3 id="ç”Ÿäº§è€…æ¶ˆè´¹è€…">ç”Ÿäº§è€…æ¶ˆè´¹è€…</h3>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span><span class="lnt">18
</span><span class="lnt">19
</span><span class="lnt">20
</span><span class="lnt">21
</span><span class="lnt">22
</span><span class="lnt">23
</span><span class="lnt">24
</span><span class="lnt">25
</span><span class="lnt">26
</span><span class="lnt">27
</span><span class="lnt">28
</span><span class="lnt">29
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-c" data-lang="c"><span class="kt">void</span> <span class="o">*</span><span class="nf">producer</span><span class="p">(</span><span class="kt">void</span> <span class="o">*</span><span class="n">arg</span><span class="p">)</span>
<span class="p">{</span>
    <span class="kt">int</span> <span class="n">i</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>

    <span class="k">while</span> <span class="p">(</span><span class="mi">1</span><span class="p">)</span> <span class="p">{</span>
        <span class="n">sem_wait</span><span class="p">(</span><span class="o">&amp;</span><span class="n">blank_number</span><span class="p">);</span>                    <span class="c1">//ç”Ÿäº§è€…å°†ç©ºæ ¼å­æ•°--,ä¸º0åˆ™é˜»å¡ç­‰å¾…
</span><span class="c1"></span>        <span class="n">queue</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="n">rand</span><span class="p">()</span> <span class="o">%</span> <span class="mi">1000</span> <span class="o">+</span> <span class="mi">1</span><span class="p">;</span>               <span class="c1">//ç”Ÿäº§ä¸€ä¸ªäº§å“
</span><span class="c1"></span>        <span class="n">printf</span><span class="p">(</span><span class="s">&#34;----Produce---%d</span><span class="se">\n</span><span class="s">&#34;</span><span class="p">,</span> <span class="n">queue</span><span class="p">[</span><span class="n">i</span><span class="p">]);</span>        
        <span class="n">sem_post</span><span class="p">(</span><span class="o">&amp;</span><span class="n">product_number</span><span class="p">);</span>                  <span class="c1">//å°†äº§å“æ•°++
</span><span class="c1"></span>
        <span class="n">i</span> <span class="o">=</span> <span class="p">(</span><span class="n">i</span><span class="o">+</span><span class="mi">1</span><span class="p">)</span> <span class="o">%</span> <span class="n">NUM</span><span class="p">;</span>                            <span class="c1">//å€ŸåŠ©ä¸‹æ ‡å®ç°ç¯å½¢
</span><span class="c1"></span>        <span class="c1">//sleep(rand()%3);
</span><span class="c1"></span>    <span class="p">}</span>
<span class="p">}</span>

<span class="kt">void</span> <span class="o">*</span><span class="nf">consumer</span><span class="p">(</span><span class="kt">void</span> <span class="o">*</span><span class="n">arg</span><span class="p">)</span>
<span class="p">{</span>
    <span class="kt">int</span> <span class="n">i</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>

    <span class="k">while</span> <span class="p">(</span><span class="mi">1</span><span class="p">)</span> <span class="p">{</span>
        <span class="n">sem_wait</span><span class="p">(</span><span class="o">&amp;</span><span class="n">product_number</span><span class="p">);</span>                  <span class="c1">//æ¶ˆè´¹è€…å°†äº§å“æ•°--,ä¸º0åˆ™é˜»å¡ç­‰å¾…
</span><span class="c1"></span>        <span class="n">printf</span><span class="p">(</span><span class="s">&#34;-Consume---%d</span><span class="se">\n</span><span class="s">&#34;</span><span class="p">,</span> <span class="n">queue</span><span class="p">[</span><span class="n">i</span><span class="p">]);</span>
        <span class="n">queue</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>                               <span class="c1">//æ¶ˆè´¹ä¸€ä¸ªäº§å“ 
</span><span class="c1"></span>        <span class="n">sem_post</span><span class="p">(</span><span class="o">&amp;</span><span class="n">blank_number</span><span class="p">);</span>                    <span class="c1">//æ¶ˆè´¹æ‰ä»¥å,å°†ç©ºæ ¼å­æ•°++
</span><span class="c1"></span>
        <span class="n">i</span> <span class="o">=</span> <span class="p">(</span><span class="n">i</span><span class="o">+</span><span class="mi">1</span><span class="p">)</span> <span class="o">%</span> <span class="n">NUM</span><span class="p">;</span>
        <span class="c1">//sleep(rand()%3);
</span><span class="c1"></span>    <span class="p">}</span>
<span class="p">}</span>
</code></pre></td></tr></table>
</div>
</div><p>ä¸ºä»€ä¹ˆä¸éœ€è¦äº’æ–¥é”ï¼Ÿ</p>
<h2 id="è¿›ç¨‹é—´åŒæ­¥">è¿›ç¨‹é—´åŒæ­¥</h2>
<h3 id="äº’æ–¥é‡">äº’æ–¥é‡</h3>
<p>è¿›ç¨‹ä¸­çš„äº’æ–¥é‡éœ€è¦ä¿®æ”¹mutexçš„å±æ€§ã€‚</p>
<p><img
        class="lazyload"
        src="/svg/loading.min.svg"
        data-src="/images/LinuxSystem/Untitled%2086.png"
        data-srcset="/images/LinuxSystem/Untitled%2086.png, /images/LinuxSystem/Untitled%2086.png 1.5x, /images/LinuxSystem/Untitled%2086.png 2x"
        data-sizes="auto"
        alt="/images/LinuxSystem/Untitled%2086.png"
        title="/images/LinuxSystem/Untitled%2086.png" /></p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span><span class="lnt">18
</span><span class="lnt">19
</span><span class="lnt">20
</span><span class="lnt">21
</span><span class="lnt">22
</span><span class="lnt">23
</span><span class="lnt">24
</span><span class="lnt">25
</span><span class="lnt">26
</span><span class="lnt">27
</span><span class="lnt">28
</span><span class="lnt">29
</span><span class="lnt">30
</span><span class="lnt">31
</span><span class="lnt">32
</span><span class="lnt">33
</span><span class="lnt">34
</span><span class="lnt">35
</span><span class="lnt">36
</span><span class="lnt">37
</span><span class="lnt">38
</span><span class="lnt">39
</span><span class="lnt">40
</span><span class="lnt">41
</span><span class="lnt">42
</span><span class="lnt">43
</span><span class="lnt">44
</span><span class="lnt">45
</span><span class="lnt">46
</span><span class="lnt">47
</span><span class="lnt">48
</span><span class="lnt">49
</span><span class="lnt">50
</span><span class="lnt">51
</span><span class="lnt">52
</span><span class="lnt">53
</span><span class="lnt">54
</span><span class="lnt">55
</span><span class="lnt">56
</span><span class="lnt">57
</span><span class="lnt">58
</span><span class="lnt">59
</span><span class="lnt">60
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-c" data-lang="c"><span class="cp">#include</span> <span class="cpf">&lt;stdio.h&gt;</span><span class="cp">
</span><span class="cp">#include</span> <span class="cpf">&lt;unistd.h&gt;</span><span class="cp">
</span><span class="cp">#include</span> <span class="cpf">&lt;fcntl.h&gt;</span><span class="cp">
</span><span class="cp">#include</span> <span class="cpf">&lt;stdlib.h&gt;</span><span class="cp">
</span><span class="cp">#include</span> <span class="cpf">&lt;string.h&gt;</span><span class="cp">
</span><span class="cp">#include</span> <span class="cpf">&lt;pthread.h&gt;</span><span class="cp">
</span><span class="cp">#include</span> <span class="cpf">&lt;sys/mman.h&gt;</span><span class="cp">
</span><span class="cp">#include</span> <span class="cpf">&lt;sys/wait.h&gt;</span><span class="cp">
</span><span class="cp"></span>
<span class="k">struct</span> <span class="n">mt</span> <span class="p">{</span>
    <span class="kt">int</span> <span class="n">num</span><span class="p">;</span>
    <span class="n">pthread_mutex_t</span> <span class="n">mutex</span><span class="p">;</span>
    <span class="n">pthread_mutexattr_t</span> <span class="n">mutexattr</span><span class="p">;</span>
<span class="p">};</span>

<span class="kt">int</span> <span class="nf">main</span><span class="p">(</span><span class="kt">void</span><span class="p">)</span>
<span class="p">{</span>
    <span class="kt">int</span> <span class="n">i</span><span class="p">;</span>
    <span class="k">struct</span> <span class="n">mt</span> <span class="o">*</span><span class="n">mm</span><span class="p">;</span>
    <span class="n">pid_t</span> <span class="n">pid</span><span class="p">;</span>
<span class="cm">/*
</span><span class="cm">    int fd = open(&#34;mt_test&#34;, O_CREAT | O_RDWR, 0777);
</span><span class="cm">    ftruncate(fd, sizeof(*mm));
</span><span class="cm">    mm = mmap(NULL, sizeof(*mm), PROT_READ|PROT_WRITE, MAP_SHARED, fd, 0);
</span><span class="cm">    close(fd);
</span><span class="cm">    unlink(&#34;mt_test&#34;);
</span><span class="cm">*/</span>
    <span class="n">mm</span> <span class="o">=</span> <span class="n">mmap</span><span class="p">(</span><span class="nb">NULL</span><span class="p">,</span> <span class="k">sizeof</span><span class="p">(</span><span class="o">*</span><span class="n">mm</span><span class="p">),</span> <span class="n">PROT_READ</span><span class="o">|</span><span class="n">PROT_WRITE</span><span class="p">,</span> <span class="n">MAP_SHARED</span><span class="o">|</span><span class="n">MAP_ANON</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">);</span>
    <span class="n">memset</span><span class="p">(</span><span class="n">mm</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="k">sizeof</span><span class="p">(</span><span class="o">*</span><span class="n">mm</span><span class="p">));</span>

    <span class="n">pthread_mutexattr_init</span><span class="p">(</span><span class="o">&amp;</span><span class="n">mm</span><span class="o">-&gt;</span><span class="n">mutexattr</span><span class="p">);</span>                                  <span class="c1">//åˆå§‹åŒ–mutexå±æ€§å¯¹è±¡
</span><span class="c1"></span>    <span class="n">pthread_mutexattr_setpshared</span><span class="p">(</span><span class="o">&amp;</span><span class="n">mm</span><span class="o">-&gt;</span><span class="n">mutexattr</span><span class="p">,</span> <span class="n">PTHREAD_PROCESS_SHARED</span><span class="p">);</span>    <span class="c1">//ä¿®æ”¹å±æ€§ä¸ºè¿›ç¨‹é—´å…±äº«
</span><span class="c1"></span>
    <span class="n">pthread_mutex_init</span><span class="p">(</span><span class="o">&amp;</span><span class="n">mm</span><span class="o">-&gt;</span><span class="n">mutex</span><span class="p">,</span> <span class="o">&amp;</span><span class="n">mm</span><span class="o">-&gt;</span><span class="n">mutexattr</span><span class="p">);</span>                          <span class="c1">//åˆå§‹åŒ–ä¸€æŠŠmutexç
</span><span class="c1"></span>
    <span class="n">pid</span> <span class="o">=</span> <span class="n">fork</span><span class="p">();</span>
    <span class="k">if</span> <span class="p">(</span><span class="n">pid</span> <span class="o">==</span> <span class="mi">0</span><span class="p">)</span> <span class="p">{</span>
        <span class="k">for</span> <span class="p">(</span><span class="n">i</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span> <span class="n">i</span> <span class="o">&lt;</span> <span class="mi">10</span><span class="p">;</span> <span class="n">i</span><span class="o">++</span><span class="p">)</span> <span class="p">{</span>
            <span class="n">pthread_mutex_lock</span><span class="p">(</span><span class="o">&amp;</span><span class="n">mm</span><span class="o">-&gt;</span><span class="n">mutex</span><span class="p">);</span>
            <span class="p">(</span><span class="n">mm</span><span class="o">-&gt;</span><span class="n">num</span><span class="p">)</span><span class="o">++</span><span class="p">;</span>
            <span class="n">pthread_mutex_unlock</span><span class="p">(</span><span class="o">&amp;</span><span class="n">mm</span><span class="o">-&gt;</span><span class="n">mutex</span><span class="p">);</span>
            <span class="n">printf</span><span class="p">(</span><span class="s">&#34;-child----------num++   %d</span><span class="se">\n</span><span class="s">&#34;</span><span class="p">,</span> <span class="n">mm</span><span class="o">-&gt;</span><span class="n">num</span><span class="p">);</span>
        <span class="p">}</span>
    <span class="p">}</span> <span class="k">else</span> <span class="k">if</span> <span class="p">(</span><span class="n">pid</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">)</span> <span class="p">{</span>
        <span class="k">for</span> <span class="p">(</span> <span class="n">i</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span> <span class="n">i</span> <span class="o">&lt;</span> <span class="mi">10</span><span class="p">;</span> <span class="n">i</span><span class="o">++</span><span class="p">)</span> <span class="p">{</span>
        <span class="c1">//    sleep(1);
</span><span class="c1"></span>            <span class="n">pthread_mutex_lock</span><span class="p">(</span><span class="o">&amp;</span><span class="n">mm</span><span class="o">-&gt;</span><span class="n">mutex</span><span class="p">);</span>
            <span class="n">mm</span><span class="o">-&gt;</span><span class="n">num</span> <span class="o">+=</span> <span class="mi">2</span><span class="p">;</span>
            <span class="n">pthread_mutex_unlock</span><span class="p">(</span><span class="o">&amp;</span><span class="n">mm</span><span class="o">-&gt;</span><span class="n">mutex</span><span class="p">);</span>
            <span class="n">printf</span><span class="p">(</span><span class="s">&#34;-------parent---num+=2  %d</span><span class="se">\n</span><span class="s">&#34;</span><span class="p">,</span> <span class="n">mm</span><span class="o">-&gt;</span><span class="n">num</span><span class="p">);</span>
        <span class="p">}</span>
        <span class="n">wait</span><span class="p">(</span><span class="nb">NULL</span><span class="p">);</span>
    <span class="p">}</span>

    <span class="n">pthread_mutexattr_destroy</span><span class="p">(</span><span class="o">&amp;</span><span class="n">mm</span><span class="o">-&gt;</span><span class="n">mutexattr</span><span class="p">);</span>          <span class="c1">//é”€æ¯mutexå±æ€§å¯¹è±¡
</span><span class="c1"></span>    <span class="n">pthread_mutex_destroy</span><span class="p">(</span><span class="o">&amp;</span><span class="n">mm</span><span class="o">-&gt;</span><span class="n">mutex</span><span class="p">);</span>                  <span class="c1">//é”€æ¯mutex
</span><span class="c1"></span>    <span class="n">munmap</span><span class="p">(</span><span class="n">mm</span><span class="p">,</span><span class="k">sizeof</span><span class="p">(</span><span class="o">*</span><span class="n">mm</span><span class="p">));</span>                             <span class="c1">//é‡Šæ”¾æ˜ å°„åŒº
</span><span class="c1"></span>
    <span class="k">return</span> <span class="mi">0</span><span class="p">;</span>
<span class="p">}</span>
</code></pre></td></tr></table>
</div>
</div><h2 id="æ–‡ä»¶é”">æ–‡ä»¶é”</h2>
<h3 id="fcntlå‡½æ•°">fcntlå‡½æ•°</h3>
<p>ä¿®æ”¹å·²ç»æ‰“å¼€æ–‡ä»¶çš„å±æ€§ï¼Œä¿®æ”¹é˜»å¡å’Œéé˜»å¡ã€‚</p>
<p><img
        class="lazyload"
        src="/svg/loading.min.svg"
        data-src="/images/LinuxSystem/Untitled%2087.png"
        data-srcset="/images/LinuxSystem/Untitled%2087.png, /images/LinuxSystem/Untitled%2087.png 1.5x, /images/LinuxSystem/Untitled%2087.png 2x"
        data-sizes="auto"
        alt="/images/LinuxSystem/Untitled%2087.png"
        title="/images/LinuxSystem/Untitled%2087.png" /></p>
<p>å¯ä»¥å€ŸåŠ©å…¶æ¥è®¾ç½®æ–‡ä»¶é”ã€‚</p>
<p><img
        class="lazyload"
        src="/svg/loading.min.svg"
        data-src="/images/LinuxSystem/Untitled%2088.png"
        data-srcset="/images/LinuxSystem/Untitled%2088.png, /images/LinuxSystem/Untitled%2088.png 1.5x, /images/LinuxSystem/Untitled%2088.png 2x"
        data-sizes="auto"
        alt="/images/LinuxSystem/Untitled%2088.png"
        title="/images/LinuxSystem/Untitled%2088.png" /></p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span><span class="lnt">18
</span><span class="lnt">19
</span><span class="lnt">20
</span><span class="lnt">21
</span><span class="lnt">22
</span><span class="lnt">23
</span><span class="lnt">24
</span><span class="lnt">25
</span><span class="lnt">26
</span><span class="lnt">27
</span><span class="lnt">28
</span><span class="lnt">29
</span><span class="lnt">30
</span><span class="lnt">31
</span><span class="lnt">32
</span><span class="lnt">33
</span><span class="lnt">34
</span><span class="lnt">35
</span><span class="lnt">36
</span><span class="lnt">37
</span><span class="lnt">38
</span><span class="lnt">39
</span><span class="lnt">40
</span><span class="lnt">41
</span><span class="lnt">42
</span><span class="lnt">43
</span><span class="lnt">44
</span><span class="lnt">45
</span><span class="lnt">46
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-c" data-lang="c"><span class="cp">#include</span> <span class="cpf">&lt;stdio.h&gt;</span><span class="cp">
</span><span class="cp">#include</span> <span class="cpf">&lt;sys/types.h&gt;</span><span class="cp">
</span><span class="cp">#include</span> <span class="cpf">&lt;sys/stat.h&gt;</span><span class="cp">
</span><span class="cp">#include</span> <span class="cpf">&lt;fcntl.h&gt;</span><span class="cp">
</span><span class="cp">#include</span> <span class="cpf">&lt;unistd.h&gt;</span><span class="cp">
</span><span class="cp">#include</span> <span class="cpf">&lt;stdlib.h&gt;</span><span class="cp">
</span><span class="cp"></span>
<span class="kt">void</span> <span class="nf">sys_err</span><span class="p">(</span><span class="kt">char</span> <span class="o">*</span><span class="n">str</span><span class="p">)</span>
<span class="p">{</span>
    <span class="n">perror</span><span class="p">(</span><span class="n">str</span><span class="p">);</span>
    <span class="n">exit</span><span class="p">(</span><span class="mi">1</span><span class="p">);</span>
<span class="p">}</span>

<span class="kt">int</span> <span class="nf">main</span><span class="p">(</span><span class="kt">int</span> <span class="n">argc</span><span class="p">,</span> <span class="kt">char</span> <span class="o">*</span><span class="n">argv</span><span class="p">[])</span>
<span class="p">{</span>
    <span class="kt">int</span> <span class="n">fd</span><span class="p">;</span>
    <span class="k">struct</span> <span class="n">flock</span> <span class="n">f_lock</span><span class="p">;</span>

    <span class="k">if</span> <span class="p">(</span><span class="n">argc</span> <span class="o">&lt;</span> <span class="mi">2</span><span class="p">)</span> <span class="p">{</span>
        <span class="n">printf</span><span class="p">(</span><span class="s">&#34;./a.out filename</span><span class="se">\n</span><span class="s">&#34;</span><span class="p">);</span>
        <span class="n">exit</span><span class="p">(</span><span class="mi">1</span><span class="p">);</span>
    <span class="p">}</span>

    <span class="k">if</span> <span class="p">((</span><span class="n">fd</span> <span class="o">=</span> <span class="n">open</span><span class="p">(</span><span class="n">argv</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="n">O_RDWR</span><span class="p">))</span> <span class="o">&lt;</span> <span class="mi">0</span><span class="p">)</span>
        <span class="n">sys_err</span><span class="p">(</span><span class="s">&#34;open&#34;</span><span class="p">);</span>

    <span class="n">f_lock</span><span class="p">.</span><span class="n">l_type</span> <span class="o">=</span> <span class="n">F_WRLCK</span><span class="p">;</span>        <span class="cm">/*é€‰ç”¨å†™ç*/</span>
<span class="c1">//    f_lock.l_type = F_RDLCK;      /*é€‰ç”¨è¯»ç*/ 
</span><span class="c1"></span>
    <span class="n">f_lock</span><span class="p">.</span><span class="n">l_whence</span> <span class="o">=</span> <span class="n">SEEK_SET</span><span class="p">;</span>
    <span class="n">f_lock</span><span class="p">.</span><span class="n">l_start</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>
    <span class="n">f_lock</span><span class="p">.</span><span class="n">l_len</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>               <span class="cm">/* 0è¡¨ç¤ºæ•´ä¸ªæ–‡ä»¶åŠ é” */</span>

    <span class="n">fcntl</span><span class="p">(</span><span class="n">fd</span><span class="p">,</span> <span class="n">F_SETLKW</span><span class="p">,</span> <span class="o">&amp;</span><span class="n">f_lock</span><span class="p">);</span>
    <span class="n">printf</span><span class="p">(</span><span class="s">&#34;get flock</span><span class="se">\n</span><span class="s">&#34;</span><span class="p">);</span>

    <span class="n">sleep</span><span class="p">(</span><span class="mi">10</span><span class="p">);</span>

    <span class="n">f_lock</span><span class="p">.</span><span class="n">l_type</span> <span class="o">=</span> <span class="n">F_UNLCK</span><span class="p">;</span>
    <span class="n">fcntl</span><span class="p">(</span><span class="n">fd</span><span class="p">,</span> <span class="n">F_SETLKW</span><span class="p">,</span> <span class="o">&amp;</span><span class="n">f_lock</span><span class="p">);</span>
    <span class="n">printf</span><span class="p">(</span><span class="s">&#34;un flock</span><span class="se">\n</span><span class="s">&#34;</span><span class="p">);</span>

    <span class="n">close</span><span class="p">(</span><span class="n">fd</span><span class="p">);</span>

    <span class="k">return</span> <span class="mi">0</span><span class="p">;</span>
<span class="p">}</span>
</code></pre></td></tr></table>
</div>
</div><p>å¤šçº¿ç¨‹é—´ä¸å¯ä»¥ç”¨æ–‡ä»¶é”ï¼Œå› ä¸ºæ–‡ä»¶æè¿°ç¬¦å…±äº«ã€‚</p>
</div><div class="post-footer" id="post-footer">
    <div class="post-info">
        <div class="post-info-line">
            <div class="post-info-mod">
                <span>æ›´æ–°äº 2021-02-08</span>
            </div>
            <div class="post-info-license"></div>
        </div>
        <div class="post-info-line">
            <div class="post-info-md"><span>
                            <a class="link-to-markdown" href="/linuxsystem/index.md" target="_blank">é˜…è¯»åŸå§‹æ–‡æ¡£</a>
                        </span></div>
            <div class="post-info-share">
                <span><a href="javascript:void(0);" title="åˆ†äº«åˆ° Twitter" data-sharer="twitter" data-url="https://hongwei7.github.io/linuxsystem/" data-title="Linux ç³»ç»Ÿç¼–ç¨‹" data-hashtags="Coding,Linux"><i class="fab fa-twitter fa-fw"></i></a><a href="javascript:void(0);" title="åˆ†äº«åˆ° Facebook" data-sharer="facebook" data-url="https://hongwei7.github.io/linuxsystem/" data-hashtag="Coding"><i class="fab fa-facebook-square fa-fw"></i></a><a href="javascript:void(0);" title="åˆ†äº«åˆ° WhatsApp" data-sharer="whatsapp" data-url="https://hongwei7.github.io/linuxsystem/" data-title="Linux ç³»ç»Ÿç¼–ç¨‹" data-web><i class="fab fa-whatsapp fa-fw"></i></a><a href="javascript:void(0);" title="åˆ†äº«åˆ° Line" data-sharer="line" data-url="https://hongwei7.github.io/linuxsystem/" data-title="Linux ç³»ç»Ÿç¼–ç¨‹"><i data-svg-src="/lib/simple-icons/icons/line.min.svg"></i></a><a href="javascript:void(0);" title="åˆ†äº«åˆ° å¾®åš" data-sharer="weibo" data-url="https://hongwei7.github.io/linuxsystem/" data-title="Linux ç³»ç»Ÿç¼–ç¨‹"><i class="fab fa-weibo fa-fw"></i></a><a href="javascript:void(0);" title="åˆ†äº«åˆ° Myspace" data-sharer="myspace" data-url="https://hongwei7.github.io/linuxsystem/" data-title="Linux ç³»ç»Ÿç¼–ç¨‹" data-description=""><i data-svg-src="/lib/simple-icons/icons/myspace.min.svg"></i></a><a href="javascript:void(0);" title="åˆ†äº«åˆ° Blogger" data-sharer="blogger" data-url="https://hongwei7.github.io/linuxsystem/" data-title="Linux ç³»ç»Ÿç¼–ç¨‹" data-description=""><i class="fab fa-blogger fa-fw"></i></a><a href="javascript:void(0);" title="åˆ†äº«åˆ° Evernote" data-sharer="evernote" data-url="https://hongwei7.github.io/linuxsystem/" data-title="Linux ç³»ç»Ÿç¼–ç¨‹"><i class="fab fa-evernote fa-fw"></i></a></span>
            </div>
        </div>
    </div>

    <div class="post-info-more">
        <section class="post-tags"><i class="fas fa-tags fa-fw"></i>&nbsp;<a href="/tags/coding/">Coding</a>,&nbsp;<a href="/tags/linux/">Linux</a></section>
        <section>
            <span><a href="javascript:void(0);" onclick="window.history.back();">è¿”å›</a></span>&nbsp;|&nbsp;<span><a href="/">ä¸»é¡µ</a></span>
        </section>
    </div>

    <div class="post-nav"><a href="/%E4%B8%80%E4%BA%9B%E7%AE%80%E5%8D%95%E7%9A%84%E8%AE%BE%E8%AE%A1%E6%A8%A1%E5%BC%8F/" class="prev" rel="prev" title="ä¸€äº›ç®€å•çš„è®¾è®¡æ¨¡å¼"><i class="fas fa-angle-left fa-fw"></i>ä¸€äº›ç®€å•çš„è®¾è®¡æ¨¡å¼</a>
            <a href="/mysql%E5%8E%9F%E7%90%86/" class="next" rel="next" title="MySQL åŸç†æ€»ç»“">MySQL åŸç†æ€»ç»“<i class="fas fa-angle-right fa-fw"></i></a></div>
</div>
<div id="comments"></div></article></div>
            </main><footer class="footer">
        <div class="footer-container"><div class="footer-line">ç”± <a href="https://gohugo.io/" target="_blank" rel="noopener noreffer" title="Hugo 0.83.0">Hugo</a> å¼ºåŠ›é©±åŠ¨ | ä¸»é¢˜ - <a href="https://github.com/dillonzq/LoveIt" target="_blank" rel="noopener noreffer" title="LoveIt 0.2.10"><i class="far fa-kiss-wink-heart fa-fw"></i> LoveIt</a>
                </div><div class="footer-line"><i class="far fa-copyright fa-fw"></i><span itemprop="copyrightYear">2020 - 2022</span><span class="author" itemprop="copyrightHolder">&nbsp;<a href="https://github.com/hongwei7" target="_blank">hongwei</a></span>&nbsp;|&nbsp;<span class="license"><a rel="license external nofollow noopener noreffer" href="https://creativecommons.org/licenses/by-nc/4.0/" target="_blank">CC BY-NC 4.0</a></span></div>
        </div>
    </footer></div>

        <div id="fixed-buttons"><a href="#" id="back-to-top" class="fixed-button" title="å›åˆ°é¡¶éƒ¨">
                <i class="fas fa-arrow-up fa-fw"></i>
            </a><a href="#" id="view-comments" class="fixed-button" title="æŸ¥çœ‹è¯„è®º">
                <i class="fas fa-comment fa-fw"></i>
            </a>
        </div><link rel="stylesheet" href="/lib/lightgallery/lightgallery.min.css"><link rel="stylesheet" href="/lib/katex/katex.min.css"><link rel="stylesheet" href="/lib/katex/copy-tex.min.css"><link rel="stylesheet" href="/lib/cookieconsent/cookieconsent.min.css"><script type="text/javascript" src="/lib/smooth-scroll/smooth-scroll.min.js"></script><script type="text/javascript" src="/lib/autocomplete/autocomplete.min.js"></script><script type="text/javascript" src="/lib/lunr/lunr.min.js"></script><script type="text/javascript" src="/lib/lunr/lunr.stemmer.support.min.js"></script><script type="text/javascript" src="/lib/lunr/lunr.zh.min.js"></script><script type="text/javascript" src="/lib/lazysizes/lazysizes.min.js"></script><script type="text/javascript" src="/lib/twemoji/twemoji.min.js"></script><script type="text/javascript" src="/lib/lightgallery/lightgallery.min.js"></script><script type="text/javascript" src="/lib/lightgallery/lg-thumbnail.min.js"></script><script type="text/javascript" src="/lib/lightgallery/lg-zoom.min.js"></script><script type="text/javascript" src="/lib/clipboard/clipboard.min.js"></script><script type="text/javascript" src="/lib/sharer/sharer.min.js"></script><script type="text/javascript" src="/lib/katex/katex.min.js"></script><script type="text/javascript" src="/lib/katex/auto-render.min.js"></script><script type="text/javascript" src="/lib/katex/copy-tex.min.js"></script><script type="text/javascript" src="/lib/katex/mhchem.min.js"></script><script type="text/javascript" src="/lib/cookieconsent/cookieconsent.min.js"></script><script type="text/javascript">window.config={"code":{"copyTitle":"å¤åˆ¶åˆ°å‰ªè´´æ¿","maxShownLines":300},"comment":{},"cookieconsent":{"content":{"dismiss":"åŒæ„","link":"äº†è§£æ›´å¤š","message":"æœ¬ç½‘ç«™ä½¿ç”¨ Cookies æ¥æ”¹å–„æ‚¨çš„æµè§ˆä½“éªŒ."},"enable":true,"palette":{"button":{"background":"#f0f0f0"},"popup":{"background":"#1aa3ff"}},"theme":"edgeless"},"lightGallery":{"actualSize":false,"exThumbImage":"data-thumbnail","hideBarsDelay":2000,"selector":".lightgallery","speed":400,"thumbContHeight":80,"thumbWidth":80,"thumbnail":true},"math":{"delimiters":[{"display":true,"left":"$$","right":"$$"},{"display":true,"left":"\\[","right":"\\]"},{"display":false,"left":"$","right":"$"},{"display":false,"left":"\\(","right":"\\)"}],"strict":false},"search":{"highlightTag":"em","lunrIndexURL":"/index.json","lunrLanguageCode":"zh","lunrSegmentitURL":"/lib/lunr/lunr.segmentit.js","maxResultLength":10,"noResultsFound":"æ²¡æœ‰æ‰¾åˆ°ç»“æœ","snippetLength":50,"type":"lunr"},"twemoji":true};</script><script type="text/javascript" src="/js/theme.min.js"></script></body>
</html>
